graph TD
    subgraph STEP1["STEP 1: ANALYZER LAYER"]
        A1["tokenizer.js<br/>━━━━━━━━━━━━━━━━<br/>✅ FOUNDATION<br/>No imports<br/>━━━━━━━━━━━━━━━━<br/>EXPORTS:<br/>• Tokenizer class<br/>• tokenize()"]
        
        A2["parser.js<br/>━━━━━━━━━━━━━━━━<br/>⬇️ IMPORTS:<br/>import Tokenizer<br/>━━━━━━━━━━━━━━━━<br/>EXPORTS:<br/>• Parser class<br/>• parse()"]
        
        A3["semantic-analyzer.js<br/>━━━━━━━━━━━━━━━━<br/>⬇️ IMPORTS:<br/>import Parser<br/>━━━━━━━━━━━━━━━━<br/>EXPORTS:<br/>• SemanticAnalyzer<br/>• analyze()"]
        
        A4["metadata-extractor.js<br/>━━━━━━━━━━━━━━━━<br/>⬇️ IMPORTS:<br/>import SemanticAnalyzer<br/>━━━━━━━━━━━━━━━━<br/>EXPORTS:<br/>• MetadataExtractor<br/>• extract()"]
    end

    subgraph STEP2["STEP 2: VDOM LAYER"]
        V1["vnode.js<br/>━━━━━━━━━━━━━━━━<br/>✅ FOUNDATION<br/>No imports<br/>━━━━━━━━━━━━━━━━<br/>EXPORTS:<br/>• VNode class<br/>• createVNode()"]
        
        V2["vnode-builder.js<br/>━━━━━━━━━━━━━━━━<br/>⬇️ IMPORTS:<br/>import VNode<br/>import metadata<br/>━━━━━━━━━━━━━━━━<br/>EXPORTS:<br/>• VNodeBuilder<br/>• build()"]
        
        V3["vnode-differ.js<br/>━━━━━━━━━━━━━━━━<br/>⬇️ IMPORTS:<br/>import VNode<br/>━━━━━━━━━━━━━━━━<br/>EXPORTS:<br/>• Differ class<br/>• diff()"]
        
        V4["vnode-renderer.js<br/>━━━━━━━━━━━━━━━━<br/>⬇️ IMPORTS:<br/>import VNode<br/>import Differ<br/>━━━━━━━━━━━━━━━━<br/>EXPORTS:<br/>• BrowserRenderer<br/>• SSRRenderer"]
    end

    subgraph STEP3["STEP 3: BUILDER LAYER"]
        B1["app-builder.js<br/>━━━━━━━━━━━━━━━━<br/>⬇️ IMPORTS:<br/>import MetadataExtractor<br/>import VNodeBuilder<br/>━━━━━━━━━━━━━━━━<br/>EXPORTS:<br/>• AppBuilder<br/>• build()"]
    end

    subgraph STEP4["STEP 4: SERVICES LAYER"]
        S1["context.js<br/>━━━━━━━━━━━━━━━━<br/>✅ FOUNDATION<br/>No imports<br/>━━━━━━━━━━━━━━━━<br/>EXPORTS:<br/>• BuildContext<br/>• ContextProvider"]
        
        S2["state-manager.js<br/>━━━━━━━━━━━━━━━━<br/>⬇️ IMPORTS:<br/>import ContextProvider<br/>━━━━━━━━━━━━━━━━<br/>EXPORTS:<br/>• StateManager<br/>• setState()"]
        
        S3["event-system.js<br/>━━━━━━━━━━━━━━━━<br/>✅ STANDALONE<br/>No imports<br/>━━━━━━━━━━━━━━━━<br/>EXPORTS:<br/>• EventSystem<br/>• handleEvent()"]
        
        S4["lifecycle.js<br/>━━━━━━━━━━━━━━━━<br/>⬇️ IMPORTS:<br/>import StateManager<br/>━━━━━━━━━━━━━━━━<br/>EXPORTS:<br/>• LifecycleManager<br/>• execute()"]
    end

    subgraph STEP5["STEP 5: RUNTIME LAYER"]
        R1["flutterjs-runtime.js<br/>━━━━━━━━━━━━━━━━<br/>⬇️ IMPORTS:<br/>import VNodeBuilder<br/>import VNodeRenderer<br/>import Differ<br/>import AppBuilder<br/>import BuildContext<br/>import StateManager<br/>import EventSystem<br/>import LifecycleManager<br/>━━━━━━━━━━━━━━━━<br/>EXPORTS:<br/>• FlutterJSRuntime<br/>• runApp()<br/>• getRuntime()"]
    end

    %% STEP 1 Chain
    A1 -->|provides tokens| A2
    A2 -->|provides AST| A3
    A3 -->|provides metadata| A4

    %% STEP 2 Chain
    V1 -->|VNode structure| V2
    V1 -->|VNode structure| V3
    V3 -->|Differ class| V4
    V1 -->|VNode structure| V4

    %% STEP 3 Bridge
    A4 -.->|metadata| B1
    V2 -->|builds VNode| B1

    %% STEP 4 Chain
    S1 -->|ContextProvider| S2
    S2 -->|StateManager| S4

    %% STEP 5 Hub
    V2 -->|builds VNode| R1
    V4 -->|renders to DOM| R1
    V3 -->|reconciliation| R1
    B1 -->|orchestrates| R1
    S1 -->|provides context| R1
    S2 -->|manages state| R1
    S3 -->|handles events| R1
    S4 -->|manages lifecycle| R1

    %% Styling
    classDef foundation fill:#e8f5e9,stroke:#2e7d32,stroke-width:3px,color:#000
    classDef importer fill:#fff3e0,stroke:#e65100,stroke-width:2px,color:#000
    classDef runtime fill:#fce4ec,stroke:#c2185b,stroke-width:3px,color:#000
    classDef step1 fill:#e3f2fd,stroke:#1565c0,stroke-width:2px
    classDef step2 fill:#f3e5f5,stroke:#6a1b9a,stroke-width:2px
    classDef step3 fill:#fff8e1,stroke:#f57f17,stroke-width:2px
    classDef step4 fill:#e0f2f1,stroke:#004d40,stroke-width:2px
    classDef step5 fill:#fce4ec,stroke:#880e4f,stroke-width:2px

    class A1,V1,S1,S3 foundation
    class A2,A3,A4,V2,V3,V4,B1,S2,S4 importer
    class R1 runtime
    class STEP1 step1
    class STEP2 step2
    class STEP3 step3
    class STEP4 step4
    class STEP5 step5