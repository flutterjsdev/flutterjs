// Copyright 2025 The FlutterJS Authors. All rights reserved.
// Use of this source code is governed by a BSD-style license that can be
// found in the LICENSE file.

class h{constructor(t,s,e,i){this.type=t,this.value=s,this.line=e,this.column=i}toString(){return`Token(${this.type}, "${this.value}", ${this.line}:${this.column})`}isType(t){return Array.isArray(t)?t.includes(this.type):this.type===t}}const n={STRING:"STRING",NUMBER:"NUMBER",BOOLEAN:"BOOLEAN",NULL:"NULL",UNDEFINED:"UNDEFINED",KEYWORD:"KEYWORD",IDENTIFIER:"IDENTIFIER",OPERATOR:"OPERATOR",PUNCTUATION:"PUNCTUATION",COMMENT:"COMMENT",WHITESPACE:"WHITESPACE",NEWLINE:"NEWLINE",EOF:"EOF"};class a{constructor(t,s={}){this.source=t,this.position=0,this.line=1,this.column=0,this.tokens=[],this.errors=[],this.options={includeWhitespace:!1,includeComments:!0,...s},this.keywords=new Set(["class","extends","constructor","new","const","function","return","if","else","for","while","this","static","async","await","import","export","from","as","default","true","false","null","undefined","typeof","instanceof","void","delete"])}tokenize(){for(;this.position<this.source.length;)this.scanToken();return this.tokens.push(new h(n.EOF,"",this.line,this.column)),this.tokens}scanToken(){const t=this.peek();return this.isWhitespace(t)?this.scanWhitespace():t==="/"&&(this.peekNext()==="/"||this.peekNext()==="*")?this.scanComment():t==='"'||t==="'"||t==="`"?this.scanString():this.isDigit(t)?this.scanNumber():this.isIdentifierStart(t)?this.scanIdentifier():this.scanOperatorOrPunctuation()}scanWhitespace(){const t=this.column;let s="";for(;this.position<this.source.length&&this.isWhitespace(this.peek());){const e=this.advance();s+=e,e===`
`&&(this.options.includeWhitespace&&this.tokens.push(new h(n.NEWLINE,`
`,this.line-1,t)),this.line++,this.column=0,s="")}this.options.includeWhitespace&&s.length>0&&this.tokens.push(new h(n.WHITESPACE,s,this.line,t))}scanComment(){const t=this.line,s=this.column;let e="";if(this.peekNext()==="/"){for(this.advance(),this.advance();this.position<this.source.length&&this.peek()!==`
`;)e+=this.advance();this.options.includeComments&&this.tokens.push(new h(n.COMMENT,e,t,s))}else if(this.peekNext()==="*"){for(this.advance(),this.advance();this.position<this.source.length;){if(this.peek()==="*"&&this.peekNext()==="/"){this.advance(),this.advance();break}const i=this.advance();e+=i,i===`
`&&(this.line++,this.column=0)}this.options.includeComments&&this.tokens.push(new h(n.COMMENT,e,t,s))}}scanString(){const t=this.line,s=this.column,e=this.advance();let i="";for(;this.position<this.source.length;){const o=this.peek();if(o===e){this.advance();break}if(o==="\\"){this.advance();const r=this.advance();i+=this.getEscapeSequence(r)}else o===`
`&&(this.line++,this.column=0),i+=this.advance()}this.tokens.push(new h(n.STRING,i,t,s))}scanNumber(){const t=this.line,s=this.column;let e="";for(;this.position<this.source.length&&this.isDigit(this.peek());)e+=this.advance();if(this.peek()==="."&&this.isDigit(this.peekNext()))for(e+=this.advance();this.position<this.source.length&&this.isDigit(this.peek());)e+=this.advance();if((this.peek()==="e"||this.peek()==="E")&&this.isDigit(this.peekNext()))for(e+=this.advance(),(this.peek()==="+"||this.peek()==="-")&&(e+=this.advance());this.position<this.source.length&&this.isDigit(this.peek());)e+=this.advance();this.tokens.push(new h(n.NUMBER,e,t,s))}scanIdentifier(){const t=this.line,s=this.column;let e="";for(;this.position<this.source.length&&this.isIdentifierPart(this.peek());)e+=this.advance();let i=n.IDENTIFIER;this.keywords.has(e)&&(e==="true"||e==="false"?i=n.BOOLEAN:e==="null"?i=n.NULL:e==="undefined"?i=n.UNDEFINED:i=n.KEYWORD),this.tokens.push(new h(i,e,t,s))}scanOperatorOrPunctuation(){const t=this.line,s=this.column,e=this.advance(),i=e+(this.peek()||"");if(["=>","==","!=","===","!==","<=",">=","++","--","&&","||","+=","-=","*=","/=","%=","??","?.","..","**"].includes(i)){this.advance(),this.tokens.push(new h(n.OPERATOR,i,t,s));return}const r=i+(this.peek()||"");if(["===","!==","..."].includes(r)){this.advance(),this.tokens.push(new h(n.OPERATOR,r,t,s));return}if(["+","-","*","/","%","=","<",">","!","&","|","^","~","?",":"].includes(e)){this.tokens.push(new h(n.OPERATOR,e,t,s));return}if(["{","}","(",")","[","]",";",",",".","@","#"].includes(e)){this.tokens.push(new h(n.PUNCTUATION,e,t,s));return}this.errors.push({message:`Unexpected character: '${e}'`,line:t,column:s})}peek(t=0){const s=this.position+t;return s>=this.source.length?null:this.source[s]}peekNext(){return this.peek(1)}advance(){const t=this.source[this.position];return this.position++,this.column++,t}isWhitespace(t){return t===" "||t==="	"||t==="\r"||t===`
`}isDigit(t){return t>="0"&&t<="9"}isIdentifierStart(t){return t?t>="a"&&t<="z"||t>="A"&&t<="Z"||t==="_"||t==="$":!1}isIdentifierPart(t){return t?this.isIdentifierStart(t)||this.isDigit(t):!1}getEscapeSequence(t){return{n:`
`,t:"	",r:"\r","\\":"\\",'"':'"',"'":"'","`":"`",0:"\0"}[t]||t}getTokens(){return this.tokens}getErrors(){return this.errors}printTokens(){console.log(`
=== TOKENS ===
`),this.tokens.forEach((t,s)=>{console.log(`[${s}] ${t.toString()}`)}),console.log(`
Total: ${this.tokens.length} tokens
`)}}export{a as Lexer,h as Token,n as TokenType};
//# sourceMappingURL=lexer.js.map
