{
  "version": 3,
  "sources": ["../src/flutterjs_logger.js"],
  "sourcesContent": ["// Copyright 2025 The FlutterJS Authors. All rights reserved.\r\n// Use of this source code is governed by a BSD-style license that can be\r\n// found in the LICENSE file.\r\n\r\n/**\r\n * FlutterJS Logger - Centralized Debug Output System\r\n * \r\n * Instead of console.log() everywhere, use this logger to:\r\n * - Write debug logs to a file (.debug folder)\r\n * - Maintain clean console output\r\n * - Enable/disable debug modes per component\r\n * - Group related logs together\r\n * - Support multiple log levels\r\n */\r\n\r\nimport fs from 'fs';\r\nimport path from 'path';\r\n\r\nclass Logger {\r\n  constructor(options = {}) {\r\n    this.options = {\r\n      debugDir: '.debug',\r\n      enabled: true,\r\n      level: 'info',  // 'error', 'warn', 'info', 'debug', 'trace'\r\n      writeToFile: true,\r\n      writeToConsole: false,  // Set to true only for critical errors\r\n      includeTimestamp: true,\r\n      includeStackTrace: false,\r\n      maxFileSize: 10 * 1024 * 1024,  // 10MB\r\n      ...options,\r\n    };\r\n\r\n    this.logLevels = {\r\n      'error': 0,\r\n      'warn': 1,\r\n      'info': 2,\r\n      'debug': 3,\r\n      'trace': 4,\r\n    };\r\n\r\n    this.currentLevel = this.logLevels[this.options.level];\r\n    this.logs = [];\r\n    this.logSessions = {};\r\n    this.indentLevel = 0;\r\n\r\n    // Ensure debug directory exists\r\n    if (this.options.writeToFile) {\r\n      this.ensureDebugDir();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Ensure .debug directory exists\r\n   */\r\n  ensureDebugDir() {\r\n    if (!fs.existsSync(this.options.debugDir)) {\r\n      fs.mkdirSync(this.options.debugDir, { recursive: true });\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Get file path for a specific component\r\n   */\r\n  getLogFilePath(component = 'general') {\r\n    return path.join(this.options.debugDir, `${component}.log`);\r\n  }\r\n\r\n  /**\r\n   * Check if log level should be written\r\n   */\r\n  shouldLog(level) {\r\n    return this.logLevels[level] <= this.currentLevel;\r\n  }\r\n\r\n  /**\r\n   * Format log entry\r\n   */\r\n  formatEntry(level, component, message, data = null) {\r\n    const timestamp = this.options.includeTimestamp\r\n      ? new Date().toISOString()\r\n      : '';\r\n\r\n    const indent = '  '.repeat(this.indentLevel);\r\n    const levelStr = level.toUpperCase().padEnd(5);\r\n    const componentStr = component.padEnd(20);\r\n\r\n    let entry = `${timestamp} [${levelStr}] [${componentStr}] ${indent}${message}`;\r\n\r\n    if (data) {\r\n      entry += '\\n' + indent + JSON.stringify(data, null, 2);\r\n    }\r\n\r\n    return entry;\r\n  }\r\n\r\n  /**\r\n   * Internal write method\r\n   */\r\n  write(level, component, message, data) {\r\n    if (!this.shouldLog(level)) return;\r\n\r\n    const entry = this.formatEntry(level, component, message, data);\r\n    this.logs.push(entry);\r\n\r\n    // Write to console if enabled (only for critical messages)\r\n    if (this.options.writeToConsole && level === 'error') {\r\n      console.error(`${component}: ${message}`, data || '');\r\n    }\r\n\r\n    // Write to file\r\n    if (this.options.writeToFile) {\r\n      this.writeToFile(component, entry);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Write entry to file\r\n   */\r\n  writeToFile(component, entry) {\r\n    try {\r\n      const filePath = this.getLogFilePath(component);\r\n      fs.appendFileSync(filePath, entry + '\\n', 'utf-8');\r\n\r\n      // Check file size and rotate if needed\r\n      const stats = fs.statSync(filePath);\r\n      if (stats.size > this.options.maxFileSize) {\r\n        this.rotateLogFile(filePath);\r\n      }\r\n    } catch (error) {\r\n      console.error(`Logger failed to write to ${component}: ${error.message}`);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Rotate log file when it gets too large\r\n   */\r\n  rotateLogFile(filePath) {\r\n    const timestamp = new Date().toISOString().replace(/[:.]/g, '-');\r\n    const backupPath = filePath.replace('.log', `.${timestamp}.log`);\r\n    fs.renameSync(filePath, backupPath);\r\n  }\r\n\r\n  // =========================================================================\r\n  // PUBLIC API\r\n  // =========================================================================\r\n\r\n  /**\r\n   * Start a named session (group of related logs)\r\n   */\r\n  startSession(name, component = 'general') {\r\n    this.logSessions[name] = {\r\n      component,\r\n      startTime: Date.now(),\r\n      startIndent: this.indentLevel,\r\n    };\r\n    this.indent();\r\n    this.info(component, `\u25BA START SESSION: ${name}`);\r\n  }\r\n\r\n  /**\r\n   * End a named session\r\n   */\r\n  endSession(name, component = 'general') {\r\n    if (this.logSessions[name]) {\r\n      const duration = Date.now() - this.logSessions[name].startTime;\r\n      this.info(component, `\u25C4 END SESSION: ${name} (${duration}ms)`);\r\n      this.unindent();\r\n      delete this.logSessions[name];\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Increase indent level\r\n   */\r\n  indent() {\r\n    this.indentLevel++;\r\n  }\r\n\r\n  /**\r\n   * Decrease indent level\r\n   */\r\n  unindent() {\r\n    this.indentLevel = Math.max(0, this.indentLevel - 1);\r\n  }\r\n\r\n  /**\r\n   * Error level\r\n   */\r\n  error(component, message, data) {\r\n    this.write('error', component, message, data);\r\n  }\r\n\r\n  /**\r\n   * Warning level\r\n   */\r\n  warn(component, message, data) {\r\n    this.write('warn', component, message, data);\r\n  }\r\n\r\n  /**\r\n   * Info level\r\n   */\r\n  info(component, message, data) {\r\n    this.write('info', component, message, data);\r\n  }\r\n\r\n  /**\r\n   * Debug level\r\n   */\r\n  debug(component, message, data) {\r\n    this.write('debug', component, message, data);\r\n  }\r\n\r\n  /**\r\n   * Trace level (most verbose)\r\n   */\r\n  trace(component, message, data) {\r\n    this.write('trace', component, message, data);\r\n  }\r\n\r\n  /**\r\n   * Log a method entry/exit pair\r\n   */\r\n  methodEntry(component, methodName, params = null) {\r\n    this.indent();\r\n    this.trace(component, `\u2192 ${methodName}()`, params);\r\n  }\r\n\r\n  /**\r\n   * Log method exit\r\n   */\r\n  methodExit(component, methodName, result = null) {\r\n    this.trace(component, `\u2190 ${methodName}()`, result);\r\n    this.unindent();\r\n  }\r\n\r\n  /**\r\n   * Log a successful step\r\n   */\r\n  success(component, message, data) {\r\n    this.write('info', component, `\u2713 ${message}`, data);\r\n  }\r\n\r\n  /**\r\n   * Log a failure\r\n   */\r\n  failure(component, message, error) {\r\n    this.write('error', component, `\u2717 ${message}`, error);\r\n  }\r\n\r\n  /**\r\n   * Log a step count (e.g., \"Found 5 widgets\")\r\n   */\r\n  count(component, label, count) {\r\n    this.write('info', component, `${label}: ${count}`);\r\n  }\r\n\r\n  /**\r\n   * Create a scoped logger for a specific component\r\n   */\r\n  createComponentLogger(componentName) {\r\n    return {\r\n      error: (msg, data) => this.error(componentName, msg, data),\r\n      warn: (msg, data) => this.warn(componentName, msg, data),\r\n      info: (msg, data) => this.info(componentName, msg, data),\r\n      debug: (msg, data) => this.debug(componentName, msg, data),\r\n      trace: (msg, data) => this.trace(componentName, msg, data),\r\n      success: (msg, data) => this.success(componentName, msg, data),\r\n      failure: (msg, err) => this.failure(componentName, msg, err),\r\n      methodEntry: (method, params) => this.methodEntry(componentName, method, params),\r\n      methodExit: (method, result) => this.methodExit(componentName, method, result),\r\n      startSession: (name) => this.startSession(name, componentName),\r\n      endSession: (name) => this.endSession(name, componentName),\r\n      indent: () => this.indent(),\r\n      unindent: () => this.unindent(),\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Get all logs as a single string\r\n   */\r\n  getAllLogs() {\r\n    return this.logs.join('\\n');\r\n  }\r\n\r\n  /**\r\n   * Save all logs to files\r\n   */\r\n  saveLogs() {\r\n    try {\r\n      const allLogsPath = path.join(this.options.debugDir, '_all.log');\r\n      fs.writeFileSync(allLogsPath, this.getAllLogs(), 'utf-8');\r\n      return allLogsPath;\r\n    } catch (error) {\r\n      console.error('Failed to save logs:', error.message);\r\n      return null;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Clear debug directory\r\n   */\r\n  clearDebugDir() {\r\n    try {\r\n      if (fs.existsSync(this.options.debugDir)) {\r\n        fs.rmSync(this.options.debugDir, { recursive: true, force: true });\r\n        this.ensureDebugDir();\r\n      }\r\n    } catch (error) {\r\n      console.error('Failed to clear debug directory:', error.message);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Read all debug files and return as object\r\n   */\r\n  readDebugFiles() {\r\n    const files = {};\r\n    try {\r\n      const entries = fs.readdirSync(this.options.debugDir);\r\n      entries.forEach((file) => {\r\n        if (file.endsWith('.log')) {\r\n          const filePath = path.join(this.options.debugDir, file);\r\n          files[file] = fs.readFileSync(filePath, 'utf-8');\r\n        }\r\n      });\r\n    } catch (error) {\r\n      console.error('Failed to read debug files:', error.message);\r\n    }\r\n    return files;\r\n  }\r\n\r\n  /**\r\n   * Get analysis report of logs (counts, errors, warnings, etc.)\r\n   */\r\n  getReport() {\r\n    const report = {\r\n      totalEntries: this.logs.length,\r\n      errors: 0,\r\n      warnings: 0,\r\n      info: 0,\r\n      debug: 0,\r\n      trace: 0,\r\n      sessions: Object.keys(this.logSessions).length,\r\n      debugFiles: [],\r\n    };\r\n\r\n    this.logs.forEach((log) => {\r\n      if (log.includes('[ERROR]')) report.errors++;\r\n      else if (log.includes('[WARN]')) report.warnings++;\r\n      else if (log.includes('[INFO]')) report.info++;\r\n      else if (log.includes('[DEBUG]')) report.debug++;\r\n      else if (log.includes('[TRACE]')) report.trace++;\r\n    });\r\n\r\n    try {\r\n      report.debugFiles = fs.readdirSync(this.options.debugDir)\r\n        .filter((f) => f.endsWith('.log'));\r\n    } catch (error) {\r\n      // Ignore\r\n    }\r\n\r\n    return report;\r\n  }\r\n}\r\n\r\n/**\r\n * Global singleton logger instance\r\n */\r\nlet globalLogger = null;\r\n\r\nexport function initLogger(options = {}) {\r\n  globalLogger = new Logger(options);\r\n  return globalLogger;\r\n}\r\n\r\nexport function getLogger() {\r\n  if (!globalLogger) {\r\n    globalLogger = new Logger();\r\n  }\r\n  return globalLogger;\r\n}\r\n\r\nexport { Logger };\r\n"],
  "mappings": "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",
  "names": ["fs", "path", "Logger", "options", "component", "level", "message", "data", "timestamp", "indent", "levelStr", "componentStr", "entry", "filePath", "error", "backupPath", "name", "duration", "methodName", "params", "result", "label", "count", "componentName", "msg", "err", "method", "allLogsPath", "files", "file", "report", "log", "f", "globalLogger", "initLogger", "getLogger"]
}
