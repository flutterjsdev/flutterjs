import{Diagnosticable as m,Element as u}from"@flutterjs/runtime/element";import{VNode as x}from"@flutterjs/vdom/vnode";class n extends m{constructor(e=null){if(super(),new.target===n)throw new Error("Widget is abstract and cannot be instantiated");this.key=e}createElement(e,t){throw new Error(`${this.constructor.name}.createElement() must be implemented`)}toStringShort(){return`${this.constructor.name}${this.key?`(key: ${this.key})`:"(unkeyed)"}`}debugFillProperties(e){super.debugFillProperties(e)}}class l extends n{constructor({key:e=null,child:t=null}={}){if(super(e),new.target===l)throw new Error("ProxyWidget is abstract");this.child=t}createElement(e,t){return new o(this,e,t)}}class y extends l{constructor({key:e=null,child:t=null}={}){super({key:e,child:t})}updateShouldNotify(e){throw new Error(`${this.constructor.name}.updateShouldNotify() must be implemented`)}createElement(e,t){return new f(this,e,t)}static of(e,t){return e.dependOnInheritedWidgetOfExactType(t)}}class i{constructor(){if(new.target===i)throw new Error("Key is abstract")}}class a extends i{constructor(e){super(),this.value=e}equals(e){return e instanceof a&&this.value===e.value}toString(){return`ValueKey(${this.value})`}}class c extends i{constructor(e){super(),this.value=e}equals(e){return e instanceof c&&this.value===e.value}toString(){return`ObjectKey(${this.value})`}}class d extends i{constructor(e=null){super(),this.debugLabel=e,this._currentElement=null}get currentContext(){return this._currentElement?.context||null}get currentWidget(){return this._currentElement?.widget||null}get currentState(){return this._currentElement?.state||null}equals(e){return e instanceof d&&this===e}toString(){return`GlobalKey${this.debugLabel?`(${this.debugLabel})`:""}`}}class h{constructor(){if(new.target===h)throw new Error("Notification is abstract")}dispatch(e){e.dispatchNotification(this)}}class S extends l{constructor({key:e=null,child:t=null,onNotification:r=null}={}){super({key:e,child:t}),this.onNotification=r}createElement(e,t){return new E(this,e,t)}}class p extends n{constructor(e=null){super(e)}build(e){throw new Error(`${this.constructor.name}.build() must be implemented`)}createElement(e,t){return new b(this,e,t)}reassemble(){}}class b extends u{constructor(e,t=null,r=null){super(e,t,r)}mount(e=null){super.mount(e)}reassemble(){this.widget.reassemble?.(),super.reassemble()}performRebuild(){try{return this.widget.build(this.context)}catch(e){return console.error(`build error: ${e}`),new w({message:e.toString()})}}}class v extends n{constructor(e=null){super(e)}createState(){throw new Error(`${this.constructor.name}.createState() must be implemented`)}createElement(e,t){return new g(this,e,t)}reassemble(){}}class g extends u{constructor(e,t=null,r=null){super(e,t,r),this.state=e.createState(),this.state._element=this,this.state.widget=e}mount(e=null){super.mount(e),this.state._mount(this)}unmount(){try{this.state.dispose()}catch(e){console.error(`dispose error in ${this._debugLabel}:`,e)}this.state._unmount(),super.unmount()}activate(){this.state._reactivate(),super.activate?.()}deactivate(){try{this.state.deactivate()}catch(e){console.error(`deactivate error in ${this._debugLabel}:`,e)}this.state._deactivate(),super.deactivate()}updateWidget(e){const t=this.widget;this.widget=e,this.state._updateWidget(e);try{this.state.didUpdateWidget(t)}catch(r){console.error(`didUpdateWidget error in ${this._debugLabel}:`,r)}this.markNeedsBuild()}performRebuild(){try{return this.state.build(this.context)}catch(e){throw console.error(`build error in ${this._debugLabel}:`,e),e}}reassemble(){try{this.state.reassemble()}catch(e){console.error(`reassemble error: ${e}`)}super.reassemble()}didChangeDependencies(){try{this.state.didChangeDependencies()}catch(e){console.error(`didChangeDependencies error: ${e}`)}}debugFillProperties(e){super.debugFillProperties(e),e.push({name:"stateType",value:this.state.constructor.name}),e.push({name:"stateInitialized",value:this.state._didInitState})}}class w extends p{constructor({message:e="Error",error:t=null}={}){super(),this.message=e,this.error=t}build(e){return new x({tag:"div",props:{style:{backgroundColor:"#ff1744",color:"white",padding:"16px",borderRadius:"4px",fontFamily:"monospace",fontSize:"12px",whiteSpace:"pre-wrap",wordBreak:"break-word"}},children:[this.message]})}}class o extends u{constructor(e,t=null,r=null){super(e,t,r)}mount(e=null){super.mount(e)}performRebuild(){if(this.widget.child){const e=this.widget.child.createElement?.();return e&&e.mount&&e.mount(this),e?.performRebuild?.()||null}return null}}class f extends o{constructor(e,t=null,r=null){super(e,t,r),this._dependents=new Set}performRebuild(){if(this.widget.child){const e=this.widget.child.createElement?.();return e&&e.mount&&e.mount(this),e?.performRebuild?.()||null}return null}}class E extends o{constructor(e,t=null,r=null){super(e,t,r)}performRebuild(){if(this.widget.child){const e=this.widget.child.createElement?.();return e&&e.mount&&e.mount(this),e?.performRebuild?.()||null}return null}}export{m as Diagnosticable,u as Element,w as ErrorWidget,d as GlobalKey,f as InheritedElement,y as InheritedWidget,i as Key,h as Notification,S as NotificationListener,E as NotificationListenerElement,c as ObjectKey,o as ProxyElement,l as ProxyWidget,g as StatefulElement,v as StatefulWidget,b as StatelessElement,p as StatelessWidget,a as ValueKey,n as Widget};
//# sourceMappingURL=widget_element.js.map
