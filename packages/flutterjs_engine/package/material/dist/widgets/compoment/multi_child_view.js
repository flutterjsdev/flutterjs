import{Widget as A}from"../../core/widget_element.js";import{Element as v}from"@flutterjs/runtime";import{VNode as p}from"@flutterjs/vdom/vnode";import{Axis as d,TextDirection as w,VerticalDirection as b,Clip as m,MainAxisAlignment as z,CrossAxisAlignment as g,FlexFit as D,WrapAlignment as B,WrapCrossAlignment as k}from"../../utils/utils.js";const x={min:"min",max:"max"};class S{constructor(){this.flex=null,this.fit=D.loose}debugInfo(){return{flex:this.flex,fit:this.fit}}}class C{constructor({direction:e=d.horizontal,mainAxisAlignment:t=z.start,mainAxisSize:i=x.max,crossAxisAlignment:n=g.center,textDirection:r=w.ltr,verticalDirection:a=b.down,textBaseline:o=null,clipBehavior:h=m.none,spacing:s=0}={}){this.direction=e,this.mainAxisAlignment=t,this.mainAxisSize=i,this.crossAxisAlignment=n,this.textDirection=r,this.verticalDirection=a,this.textBaseline=o,this.clipBehavior=h,this.spacing=s,this._children=[]}addChild(e){this._children.push(e)}removeChild(e){const t=this._children.indexOf(e);t>-1&&this._children.splice(t,1)}debugInfo(){return{type:"RenderFlex",direction:this.direction,mainAxisAlignment:this.mainAxisAlignment,mainAxisSize:this.mainAxisSize,crossAxisAlignment:this.crossAxisAlignment,textDirection:this.textDirection,spacing:this.spacing,childCount:this._children.length}}}class y extends A{constructor({key:e=null,direction:t=d.horizontal,mainAxisAlignment:i=z.start,mainAxisSize:n=x.max,crossAxisAlignment:r=g.center,textDirection:a=null,verticalDirection:o=b.down,textBaseline:h=null,clipBehavior:s=m.none,spacing:c=0,children:u=[]}={}){if(super(e),r===g.baseline&&!h)throw new Error("textBaseline is required when crossAxisAlignment is CrossAxisAlignment.baseline");this.direction=t,this.mainAxisAlignment=i,this.mainAxisSize=n,this.crossAxisAlignment=r,this.textDirection=a,this.verticalDirection=o,this.textBaseline=h,this.clipBehavior=s,this.spacing=c,this.children=u||[],this._renderObject=null}_needTextDirection(){return this.direction===d.horizontal?!0:this.crossAxisAlignment===g.start||this.crossAxisAlignment===g.end}getEffectiveTextDirection(e){return this.textDirection?this.textDirection:this._needTextDirection()?e?.textDirection||w.ltr:null}createRenderObject(e){return new C({direction:this.direction,mainAxisAlignment:this.mainAxisAlignment,mainAxisSize:this.mainAxisSize,crossAxisAlignment:this.crossAxisAlignment,textDirection:this.getEffectiveTextDirection(e),verticalDirection:this.verticalDirection,textBaseline:this.textBaseline,clipBehavior:this.clipBehavior,spacing:this.spacing})}updateRenderObject(e,t){t.direction=this.direction,t.mainAxisAlignment=this.mainAxisAlignment,t.mainAxisSize=this.mainAxisSize,t.crossAxisAlignment=this.crossAxisAlignment,t.textDirection=this.getEffectiveTextDirection(e),t.verticalDirection=this.verticalDirection,t.textBaseline=this.textBaseline,t.clipBehavior=this.clipBehavior,t.spacing=this.spacing}build(e){this._renderObject?this.updateRenderObject(e,this._renderObject):this._renderObject=this.createRenderObject(e);const t=e.element.getElementId(),i=e.element.getWidgetPath(),n=this._mapMainAxisAlignment(),r=this._mapCrossAxisAlignment();var a=this.direction===d.horizontal?"row":"column";this.verticalDirection===b.up&&this.direction===d.vertical&&(a="column-reverse");const o=this.clipBehavior===m.none?"visible":"hidden",h={display:"flex",flexDirection:a,justifyContent:n,alignItems:r,gap:`${this.spacing}px`,width:this.mainAxisSize===x.max?"100%":"auto",height:this.mainAxisSize===x.max?"100%":"auto",direction:this.textDirection===w.rtl?"rtl":"ltr",overflow:o,flexWrap:"nowrap"},s=this.children.map(c=>{const u=c.createElement(e.element,e.element.runtime);u.mount(e.element);const V=u.performRebuild();let f={};return c instanceof F&&(c.fit===D.tight?f.flex=c.flex||1:(f.flex=0,f.flexShrink=0)),new p({tag:"div",props:{style:{...f,minWidth:0,minHeight:0}},children:[V]})});return new p({tag:"div",props:{style:h,"data-element-id":t,"data-widget-path":i,"data-widget":"Flex","data-direction":this.direction,"data-main-axis":this.mainAxisAlignment,"data-cross-axis":this.crossAxisAlignment,"data-spacing":this.spacing},children:s,key:this.key})}_mapMainAxisAlignment(){let e=this.mainAxisAlignment;return typeof e=="string"&&e.startsWith(".")&&(e=e.substring(1)),{start:"flex-start",end:"flex-end",center:"center",spaceBetween:"space-between",spaceAround:"space-around",spaceEvenly:"space-evenly"}[e]||"flex-start"}_mapCrossAxisAlignment(){let e=this.crossAxisAlignment;return typeof e=="string"&&e.startsWith(".")&&(e=e.substring(1)),{start:"flex-start",end:"flex-end",center:"center",stretch:"stretch",baseline:"baseline"}[e]||"center"}debugFillProperties(e){super.debugFillProperties(e),e.push({name:"direction",value:this.direction}),e.push({name:"mainAxisAlignment",value:this.mainAxisAlignment}),e.push({name:"mainAxisSize",value:this.mainAxisSize}),e.push({name:"crossAxisAlignment",value:this.crossAxisAlignment}),e.push({name:"textDirection",value:this.textDirection}),e.push({name:"spacing",value:this.spacing}),e.push({name:"childCount",value:this.children.length})}createElement(e,t){return new R(this,e,t)}}class R extends v{performRebuild(){return this.widget.build(this.context)}}class I extends y{constructor(e={}){super({...e,direction:d.horizontal})}}class N extends y{constructor(e={}){super({...e,direction:d.vertical})}}class F extends A{constructor({key:e=null,flex:t=1,fit:i=D.loose,child:n=null}={}){if(super(e),t<=0)throw new Error("flex must be > 0");this.flex=t,this.fit=i,this.child=n}applyParentData(e){e.parentData||(e.parentData=new S);const t=e.parentData;let i=!1;t.flex!==this.flex&&(t.flex=this.flex,i=!0),t.fit!==this.fit&&(t.fit=this.fit,i=!0),i&&e.parent&&e.parent.markNeedsLayout?.()}build(e){return this.child}debugFillProperties(e){super.debugFillProperties(e),e.push({name:"flex",value:this.flex}),e.push({name:"fit",value:this.fit})}createElement(e,t){return new _(this,e,t)}}class _ extends v{performRebuild(){return this.widget.build(this.context)}}class T extends F{constructor({key:e=null,flex:t=1,child:i=null}={}){super({key:e,flex:t,fit:D.tight,child:i})}}class M extends A{constructor({key:e=null,direction:t=d.horizontal,alignment:i=B.start,spacing:n=0,runAlignment:r=B.start,runSpacing:a=0,crossAxisAlignment:o=k.start,textDirection:h=null,verticalDirection:s=b.down,clipBehavior:c=m.none,children:u=[]}={}){super(e),this.direction=t,this.alignment=i,this.spacing=n,this.runAlignment=r,this.runSpacing=a,this.crossAxisAlignment=o,this.textDirection=h,this.verticalDirection=s,this.clipBehavior=c,this.children=u||[]}_mapAlignment(){let e=this.alignment;return typeof e=="string"&&e.startsWith(".")&&(e=e.substring(1)),{start:"flex-start",end:"flex-end",center:"center",spaceBetween:"space-between",spaceAround:"space-around",spaceEvenly:"space-evenly"}[e]||"flex-start"}_mapRunAlignment(){let e=this.runAlignment;return typeof e=="string"&&e.startsWith(".")&&(e=e.substring(1)),{start:"flex-start",end:"flex-end",center:"center",spaceBetween:"space-between",spaceAround:"space-around",spaceEvenly:"space-evenly"}[e]||"flex-start"}build(e){const t=e.element.getElementId(),i=e.element.getWidgetPath(),n=this.direction===d.horizontal?"row":"column",r=this.clipBehavior===m.none?"visible":"hidden",a={display:"flex",flexDirection:n,flexWrap:"wrap",justifyContent:this._mapAlignment(),alignContent:this._mapRunAlignment(),gap:`${this.spacing}px ${this.runSpacing}px`,direction:this.textDirection===w.rtl?"rtl":"ltr",overflow:r},o=this.children.map(h=>{const s=h.createElement(e.element,e.element.runtime);return s.mount(e.element),s.performRebuild()});return new p({tag:"div",props:{style:a,"data-element-id":t,"data-widget-path":i,"data-widget":"Wrap","data-direction":this.direction,"data-alignment":this.alignment,"data-spacing":this.spacing},children:o,key:this.key})}debugFillProperties(e){super.debugFillProperties(e),e.push({name:"direction",value:this.direction}),e.push({name:"alignment",value:this.alignment}),e.push({name:"spacing",value:this.spacing}),e.push({name:"runAlignment",value:this.runAlignment}),e.push({name:"runSpacing",value:this.runSpacing}),e.push({name:"childCount",value:this.children.length})}createElement(e,t){return new P(this,e,t)}}class P extends v{performRebuild(){return this.widget.build(this.context)}}class E{constructor(){if(new.target===E)throw new Error("FlowDelegate is abstract")}getSize(e){throw new Error("getSize() must be implemented")}paintChildren(e,t){throw new Error("paintChildren() must be implemented")}shouldRepaint(e){return!0}shouldReflow(e){return!0}}class $ extends A{constructor({key:e=null,delegate:t=null,clipBehavior:i=m.hardEdge,children:n=[]}={}){if(super(e),!t)throw new Error("Flow requires a delegate");if(!(t instanceof E))throw new Error("delegate must be an instance of FlowDelegate");this.delegate=t,this.clipBehavior=i,this.children=n||[]}build(e){const t=e.element.getElementId(),i=e.element.getWidgetPath(),r={position:"relative",display:"inline-block",overflow:this.clipBehavior===m.none?"visible":"hidden"},a=this.children.map((o,h)=>{const s=o.createElement(e.element,e.element.runtime);s.mount(e.element);const c=s.performRebuild();return new p({tag:"div",props:{style:{position:"absolute",left:0,top:0},"data-flow-index":h},children:[c]})});return new p({tag:"div",props:{style:r,"data-element-id":t,"data-widget-path":i,"data-widget":"Flow","data-clip-behavior":this.clipBehavior,"data-child-count":this.children.length},children:a,key:this.key})}debugFillProperties(e){super.debugFillProperties(e),e.push({name:"delegate",value:this.delegate.constructor.name}),e.push({name:"clipBehavior",value:this.clipBehavior}),e.push({name:"childCount",value:this.children.length})}createElement(e,t){return new W(this,e,t)}}class W extends v{performRebuild(){return this.widget.build(this.context)}}export{N as Column,T as Expanded,y as Flex,R as FlexElement,S as FlexParentData,F as Flexible,_ as FlexibleElement,$ as Flow,E as FlowDelegate,W as FlowElement,x as MainAxisSize,C as RenderFlex,I as Row,M as Wrap,P as WrapElement};
//# sourceMappingURL=multi_child_view.js.map
