import{Element as g}from"@flutterjs/runtime";import{Widget as p}from"../../core/widget_element.js";import{VNode as c}from"@flutterjs/vdom/vnode";const s={horizontal:"horizontal",vertical:"vertical"},t={up:"up",right:"right",down:"down",left:"left"};function a(o,e,i){const r=o?.isRTL||!1;return e===s.horizontal?i?r?t.right:t.left:r?t.left:t.right:i?t.up:t.down}class u{constructor({axisDirection:e=t.down}={}){this.axisDirection=e,this._children=[],this._containerElement=null,this._resizeObserver=null}addChild(e){this._children.push(e)}removeChild(e){const i=this._children.indexOf(e);i>-1&&this._children.splice(i,1)}get mainAxis(){return[t.left,t.right].includes(this.axisDirection)?s.horizontal:s.vertical}get isReverse(){return[t.up,t.left].includes(this.axisDirection)}debugInfo(){return{type:"RenderListBody",axisDirection:this.axisDirection,mainAxis:this.mainAxis,isReverse:this.isReverse,childCount:this._children.length}}}class m extends g{constructor(e){super(e),this._renderObject=null}mount(e=null){super.mount(e),this._renderObject=this.widget.createRenderObject(this.context)}updateWidget(e){const i=this.widget;super.updateWidget(e),(i.mainAxis!==e.mainAxis||i.reverse!==e.reverse)&&(this.widget.updateRenderObject(this.context,this._renderObject),this.markNeedsBuild())}performRebuild(){return this.widget.build(this.context)}visitChildren(e){if(this._children)for(const i of this._children)e(i)}}class b extends p{constructor({key:e=null,mainAxis:i=s.vertical,reverse:r=!1,children:n=[]}={}){if(super(e),!Object.values(s).includes(i))throw new Error(`Invalid mainAxis: ${i}`);this.mainAxis=i,this.reverse=r,this.children=n||[],this._renderObject=null,this._containerElement=null,this._childElements=[],this._resizeObserver=null}_getDirection(e){return a(e,this.mainAxis,this.reverse)}createRenderObject(e){return new u({axisDirection:this._getDirection(e)})}updateRenderObject(e,i){i.axisDirection=this._getDirection(e)}build(e){this._renderObject?this.updateRenderObject(e,this._renderObject):this._renderObject=this.createRenderObject(e);const i=e.element.getElementId(),r=e.element.getWidgetPath(),n=this.mainAxis===s.horizontal,h=this.reverse,v={display:"flex",flexDirection:n?h?"row-reverse":"row":h?"column-reverse":"column",width:n?"auto":"100%",height:"auto",alignItems:"stretch",justifyContent:"flex-start"},_=this.children.map(l=>{const d=l.createElement(e.element,e.element.runtime);d.mount(e.element);const f=d.performRebuild();return new c({tag:"div",props:{style:{flexShrink:0,width:n?"auto":"100%"}},children:[f]})});return new c({tag:"div",props:{style:v,"data-element-id":i,"data-widget-path":r,"data-widget":"ListBody","data-main-axis":this.mainAxis,"data-reverse":this.reverse,"data-axis-direction":this._getDirection(e),ref:l=>this._onContainerMount(l,e)},children:_,key:this.key})}_onContainerMount(e,i){if(!e)return;this._containerElement=e,window.ResizeObserver&&(this._resizeObserver=new ResizeObserver(()=>{this._onResize()}),this._resizeObserver.observe(e));const r=()=>this._onResize();window.addEventListener("resize",r),e._cleanupResize=()=>{window.removeEventListener("resize",r),this._resizeObserver&&this._resizeObserver.disconnect()}}_onResize(){if(this._containerElement)try{const e=this._containerElement.getBoundingClientRect()}catch(e){console.error("Error during ListBody resize:",e)}}debugFillProperties(e){super.debugFillProperties(e),e.push({name:"mainAxis",value:this.mainAxis}),e.push({name:"reverse",value:this.reverse}),e.push({name:"childCount",value:this.children.length})}createElement(e,i){return new m(this,e,i)}}export{s as Axis,t as AxisDirection,b as ListBody,m as ListBodyElement,u as RenderListBody,a as getAxisDirectionFromAxisReverseAndDirectionality};
//# sourceMappingURL=list_body.js.map
