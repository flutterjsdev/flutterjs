import{ProxyWidget as a}from"../../core/widget_element.js";import{VNode as o}from"@flutterjs/vdom/vnode";import{ImageFilter as g}from"./image_filter.js";class u extends a{constructor({key:e=null,filter:t=null,child:n=null,blendMode:s="source-over",enabled:r=!0,backdropGroupKey:i=null,grouped:l=!1}={}){if(super({key:e,child:n}),!t)throw new Error("BackdropFilter requires a filter parameter");if(!(t instanceof g))throw new Error(`BackdropFilter requires an ImageFilter instance, got: ${typeof t}`);this.filter=t,this.blendMode=s,this.enabled=r,this.backdropGroupKey=i,this._useSharedKey=l,this._renderObject=null}static grouped({key:e=null,filter:t=null,child:n=null,blendMode:s="source-over",enabled:r=!0}={}){return new u({key:e,filter:t,child:n,blendMode:s,enabled:r,grouped:!0})}_getBackdropGroupKey(e){if(this._useSharedKey)try{const{BackdropGroup:t}=require("./backdrop_group.js");return t.maybeOf(e)?.backdropKey||null}catch{return null}return this.backdropGroupKey}createRenderObject(e){return new c({filter:this.filter,blendMode:this.blendMode,enabled:this.enabled,backdropKey:this._getBackdropGroupKey(e)})}updateRenderObject(e,t){t.filter=this.filter,t.enabled=this.enabled,t.blendMode=this.blendMode,t.backdropKey=this._getBackdropGroupKey(e)}build(e){this._renderObject?this.updateRenderObject(e,this._renderObject):this._renderObject=this.createRenderObject(e);let t=null;if(this.child){const i=this.child.createElement(e.element,e.element.runtime);i.mount(e.element),t=i.performRebuild()}const n=e.element.getElementId(),s=e.element.getWidgetPath(),r=this.enabled?this.filter.toCSSFilter():"none";return new o({tag:"div",props:{style:{position:"relative",backdropFilter:r,WebkitBackdropFilter:r,mixBlendMode:this.blendMode},"data-element-id":n,"data-widget-path":s,"data-widget":"BackdropFilter","data-enabled":this.enabled,"data-blend-mode":this.blendMode,"data-filter-type":this.filter.type},children:t?[t]:[],key:this.key})}debugFillProperties(e){super.debugFillProperties(e),e.push({name:"filter",value:this.filter.toString()}),e.push({name:"blendMode",value:this.blendMode}),e.push({name:"enabled",value:this.enabled})}createElement(e,t){return new b(this,e,t)}}class c{constructor({filter:e=null,blendMode:t="source-over",enabled:n=!0,backdropKey:s=null}={}){this.filter=e,this.blendMode=t,this.enabled=n,this.backdropKey=s}debugInfo(){return{type:"RenderBackdropFilter",filter:this.filter?.toString(),blendMode:this.blendMode,enabled:this.enabled}}}class b extends a.constructor.prototype.constructor{performRebuild(){return this.widget.build(this.context)}}class m extends a{constructor({key:e=null,painter:t=null,foregroundPainter:n=null,size:s=null,isComplex:r=!1,willChange:i=!1,child:l=null}={}){if(super({key:e,child:l}),!t&&!n&&(r||i))throw new Error("CustomPaint requires a painter or foregroundPainter");this.painter=t,this.foregroundPainter=n,this.size=s||{width:0,height:0},this.isComplex=r,this.willChange=i,this._renderObject=null,this._svgElement=null}createRenderObject(e){return new p({painter:this.painter,foregroundPainter:this.foregroundPainter,preferredSize:this.size,isComplex:this.isComplex,willChange:this.willChange})}updateRenderObject(e,t){t.painter=this.painter,t.foregroundPainter=this.foregroundPainter,t.preferredSize=this.size,t.isComplex=this.isComplex,t.willChange=this.willChange}build(e){this._renderObject?this.updateRenderObject(e,this._renderObject):this._renderObject=this.createRenderObject(e);let t=null;if(this.child){const l=this.child.createElement(e.element,e.element.runtime);l.mount(e.element),t=l.performRebuild()}const n=e.element.getElementId(),s=e.element.getWidgetPath(),r={position:"relative",willChange:this.willChange?"contents":"auto"};this.size&&this.size.width>0&&this.size.height>0&&(r.width=`${this.size.width}px`,r.height=`${this.size.height}px`);const i=[];return this.painter&&i.push(new o({tag:"svg",props:{style:{position:"absolute",top:0,left:0,width:"100%",height:"100%",pointerEvents:"none"},width:this.size.width||"100%",height:this.size.height||"100%",viewBox:`0 0 ${this.size.width||100} ${this.size.height||100}`,"data-painter":"background",ref:l=>this._onBackgroundSvgMount(l)}})),t&&i.push(new o({tag:"div",props:{style:{position:"relative",zIndex:1}},children:[t]})),this.foregroundPainter&&i.push(new o({tag:"svg",props:{style:{position:"absolute",top:0,left:0,width:"100%",height:"100%",pointerEvents:"none"},width:this.size.width||"100%",height:this.size.height||"100%",viewBox:`0 0 ${this.size.width||100} ${this.size.height||100}`,"data-painter":"foreground",ref:l=>this._onForegroundSvgMount(l)}})),new o({tag:"div",props:{style:r,"data-element-id":n,"data-widget-path":s,"data-widget":"CustomPaint","data-is-complex":this.isComplex,"data-will-change":this.willChange},children:i,key:this.key})}_onBackgroundSvgMount(e){if(!(!e||!this.painter))try{const t={element:e,drawRect:(n,s,r,i,l)=>{const h=document.createElementNS("http://www.w3.org/2000/svg","rect");h.setAttribute("x",n),h.setAttribute("y",s),h.setAttribute("width",r),h.setAttribute("height",i),h.setAttribute("fill",l),e.appendChild(h)},drawCircle:(n,s,r,i)=>{const l=document.createElementNS("http://www.w3.org/2000/svg","circle");l.setAttribute("cx",n),l.setAttribute("cy",s),l.setAttribute("r",r),l.setAttribute("fill",i),e.appendChild(l)},drawPath:(n,s,r)=>{const i=document.createElementNS("http://www.w3.org/2000/svg","path");i.setAttribute("d",n),s&&i.setAttribute("stroke",s),r&&i.setAttribute("fill",r),e.appendChild(i)}};this.painter.paint(t,this.size)}catch(t){console.error("Error in CustomPaint background painter:",t)}}_onForegroundSvgMount(e){if(!(!e||!this.foregroundPainter))try{const t={element:e,drawRect:(n,s,r,i,l)=>{const h=document.createElementNS("http://www.w3.org/2000/svg","rect");h.setAttribute("x",n),h.setAttribute("y",s),h.setAttribute("width",r),h.setAttribute("height",i),h.setAttribute("fill",l),e.appendChild(h)},drawCircle:(n,s,r,i)=>{const l=document.createElementNS("http://www.w3.org/2000/svg","circle");l.setAttribute("cx",n),l.setAttribute("cy",s),l.setAttribute("r",r),l.setAttribute("fill",i),e.appendChild(l)},drawPath:(n,s,r)=>{const i=document.createElementNS("http://www.w3.org/2000/svg","path");i.setAttribute("d",n),s&&i.setAttribute("stroke",s),r&&i.setAttribute("fill",r),e.appendChild(i)}};this.foregroundPainter.paint(t,this.size)}catch(t){console.error("Error in CustomPaint foreground painter:",t)}}debugFillProperties(e){super.debugFillProperties(e),e.push({name:"hasPainter",value:!!this.painter}),e.push({name:"hasForegroundPainter",value:!!this.foregroundPainter}),e.push({name:"size",value:`${this.size.width}x${this.size.height}`}),e.push({name:"isComplex",value:this.isComplex}),e.push({name:"willChange",value:this.willChange})}createElement(e,t){return new w(this,e,t)}}class p{constructor({painter:e=null,foregroundPainter:t=null,preferredSize:n=null,isComplex:s=!1,willChange:r=!1}={}){this.painter=e,this.foregroundPainter=t,this.preferredSize=n||{width:0,height:0},this.isComplex=s,this.willChange=r}debugInfo(){return{type:"RenderCustomPaint",hasPainter:!!this.painter,hasForegroundPainter:!!this.foregroundPainter,preferredSize:`${this.preferredSize.width}x${this.preferredSize.height}`,isComplex:this.isComplex,willChange:this.willChange}}}class w extends a.constructor.prototype.constructor{performRebuild(){return this.widget.build(this.context)}}export{u as BackdropFilter,m as CustomPaint,c as RenderBackdropFilter,p as RenderCustomPaint};
//# sourceMappingURL=custom_paint_clip.js.map
