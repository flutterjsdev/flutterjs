import{Widget as S,StatelessWidget as C,Element as k}from"../../core/widget_element.js";import{Stack as E,StackElement as O,RenderStack as R,AlignmentDirectional as g,StackFit as h}from"./stack.js";import{VNode as r}from"@flutterjs/vdom/vnode";import{Clip as o,TextDirection as D}from"../../utils/utils.js";class f extends S{constructor({key:e=null,visible:i=!0,maintainState:t=!1,maintainAnimation:n=!1,maintainSize:s=!1,maintainInteractivity:a=!1,replacement:l=null,child:c=null}={}){super(e),this.visible=i,this.maintainState=t,this.maintainAnimation=n,this.maintainSize=s,this.maintainInteractivity=a,this.replacement=l,this.child=c}build(e){return this.visible?this.child:this.replacement?this.replacement:this.maintainSize?new r({tag:"div",props:{style:{visibility:"hidden",pointerEvents:this.maintainInteractivity?"auto":"none"}},children:[this.child]}):this.maintainState||this.maintainAnimation?new r({tag:"div",props:{style:{display:"none",pointerEvents:this.maintainInteractivity?"auto":"none"}},children:[this.child]}):new r({tag:"div",children:[]})}debugFillProperties(e){super.debugFillProperties(e),e.push({name:"visible",value:this.visible}),e.push({name:"maintainState",value:this.maintainState}),e.push({name:"maintainAnimation",value:this.maintainAnimation}),e.push({name:"maintainSize",value:this.maintainSize}),e.push({name:"maintainInteractivity",value:this.maintainInteractivity})}createElement(){return new v(this)}}class v extends k{performRebuild(){return this.widget.build(this.context)}}class b extends R{constructor({index:e=0,alignment:i=g.topStart,textDirection:t=D.ltr,fit:n=h.loose,clipBehavior:s=o.hardEdge}={}){super({alignment:i,textDirection:t,fit:n,clipBehavior:s}),this.index=e}getIndexedChild(){return this.index===null||this.index===void 0||this.index<0||this.index>=this._children.length?null:this._children[this.index]}isChildVisible(e){return e===this.index}debugInfo(){return{...super.debugInfo(),type:"RenderIndexedStack",index:this.index,childCount:this._children.length,visibleChildIndex:this.getIndexedChild()?this.index:null}}}class _ extends O{constructor(e){super(e),this._onstageChild=null}get widget(){return super.widget}mount(e=null){super.mount(e),this._updateOnstageChild()}updateWidget(e){const i=this.widget.index;super.updateWidget(e),i!==e.index&&(this._updateOnstageChild(),this.markNeedsBuild())}_updateOnstageChild(){const e=this.widget.index;if(e==null){this._onstageChild=null;return}this._children&&e>=0&&e<this._children.length?this._onstageChild=this._children[e]:this._onstageChild=null}debugVisitOnstageChildren(e){this._onstageChild&&e(this._onstageChild)}visitChildren(e){if(this._children)for(const i of this._children)e(i)}performRebuild(){return this.widget.build(this.context)}}class y extends E{constructor({key:e=null,alignment:i=g.topStart,textDirection:t=null,clipBehavior:n=o.hardEdge,sizing:s=h.loose,index:a=0,children:l=[]}={}){super({key:e,alignment:i,textDirection:t,clipBehavior:n,fit:s,children:l}),this._validateIndex(a,l.length),this.index=a}_validateIndex(e,i){if(e!=null&&((e<0||e>=i)&&console.warn(`IndexedStack: index ${e} is out of bounds. Valid range is 0 to ${i-1}.`),!Number.isInteger(e)))throw new Error(`IndexedStack: index must be an integer, got ${typeof e}`)}_debugCheckHasDirectionality(e){return super._debugCheckHasDirectionality(e)}createRenderObject(e){return new b({index:this.index,alignment:this.alignment,textDirection:this._getEffectiveTextDirection(e),fit:this.fit,clipBehavior:this.clipBehavior})}updateRenderObject(e,i){super.updateRenderObject(e,i),i.index=this.index}build(e){this._debugCheckHasDirectionality(e),this._renderObject?this.updateRenderObject(e,this._renderObject):this._renderObject=this.createRenderObject(e);const i=e.element.getElementId(),t=e.element.getWidgetPath(),n=this._renderObject._resolveAlignment(),s=this._renderObject._getAlignmentOffset(n),a=this.clipBehavior===o.none?"visible":"hidden",l={position:"relative",display:"inline-flex",width:this.fit===h.expand?"100%":"auto",height:this.fit===h.expand?"100%":"auto",overflow:a,alignItems:s.y,justifyContent:s.x},c=this.children.map((m,p)=>{const u=p===this.index,x=m.createElement();x.mount(e.element);const w=x.performRebuild(),I={position:"absolute",display:u?"block":"none",opacity:u?1:0,pointerEvents:u?"auto":"none"};return new r({tag:"div",props:{style:I,"data-indexed-stack-index":p,"data-visible":u,"data-role":"indexed-child"},children:[w]})});return new r({tag:"div",props:{style:l,"data-element-id":i,"data-widget-path":t,"data-widget":"RawIndexedStack","data-alignment":this.alignment,"data-fit":this.fit,"data-clip-behavior":this.clipBehavior,"data-text-direction":this._getEffectiveTextDirection(e),"data-current-index":this.index,"data-child-count":this.children.length,ref:m=>this._onContainerMount(m)},children:c,key:this.key})}debugFillProperties(e){super.debugFillProperties(e),e.push({name:"index",value:this.index})}createElement(){return new _(this)}}class j extends C{constructor({key:e=null,alignment:i=g.topStart,textDirection:t=null,clipBehavior:n=o.hardEdge,sizing:s=h.loose,index:a=0,children:l=[]}={}){super(e),this.alignment=i,this.textDirection=t,this.clipBehavior=n,this.sizing=s,this.index=a,this.children=l||[]}build(e){const i=this.children.map((t,n)=>new f({visible:n===this.index,maintainState:!0,maintainAnimation:!0,maintainSize:!0,maintainInteractivity:!0,child:t}));return new y({alignment:this.alignment,textDirection:this.textDirection,clipBehavior:this.clipBehavior,sizing:this.sizing,index:this.index,children:i,key:this.key})}debugFillProperties(e){super.debugFillProperties(e),e.push({name:"alignment",value:this.alignment}),e.push({name:"clipBehavior",value:this.clipBehavior}),e.push({name:"sizing",value:this.sizing}),e.push({name:"index",value:this.index}),e.push({name:"childCount",value:this.children.length})}}export{j as IndexedStack,y as RawIndexedStack,_ as RawIndexedStackElement,b as RenderIndexedStack,f as Visibility,v as VisibilityElement};
//# sourceMappingURL=indexed_stack.js.map
