{
  "version": 3,
  "sources": ["../../../src/widgets/compoment/fractional_translation.js"],
  "sourcesContent": ["import { ProxyWidget } from '../../core/widget_element.js';\r\nimport { VNode } from '@flutterjs/vdom/vnode';\r\nimport { Offset } from './transform_widget.js';\r\n\r\n// ============================================================================\r\n// FRACTIONAL TRANSLATION WIDGET\r\n// Translates child by a fraction of its own size\r\n// ============================================================================\r\n\r\nclass FractionalTranslation extends ProxyWidget {\r\n    constructor({\r\n        key = null,\r\n        translation = null,\r\n        transformHitTests = true,\r\n        child = null\r\n    } = {}) {\r\n        super({ key, child });\r\n\r\n        if (!translation) {\r\n            throw new Error('FractionalTranslation requires a translation (Offset)');\r\n        }\r\n\r\n        if (!(translation instanceof Offset)) {\r\n            throw new Error(\r\n                `FractionalTranslation requires an Offset instance, got: ${typeof translation}`\r\n            );\r\n        }\r\n\r\n        this.translation = translation;\r\n        this.transformHitTests = transformHitTests;\r\n        this._renderObject = null;\r\n        this._containerElement = null;\r\n        this._resizeObserver = null;\r\n    }\r\n\r\n    /**\r\n     * Create render object\r\n     */\r\n    createRenderObject(context) {\r\n        return new RenderFractionalTranslation({\r\n            translation: this.translation,\r\n            transformHitTests: this.transformHitTests\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Update render object\r\n     */\r\n    updateRenderObject(context, renderObject) {\r\n        renderObject.translation = this.translation;\r\n        renderObject.transformHitTests = this.transformHitTests;\r\n    }\r\n\r\n    /**\r\n     * Build the widget\r\n     */\r\n    build(context) {\r\n        if (!this._renderObject) {\r\n            this._renderObject = this.createRenderObject(context);\r\n        } else {\r\n            this.updateRenderObject(context, this._renderObject);\r\n        }\r\n\r\n        let childVNode = null;\r\n        if (this.child) {\r\n            const childElement = this.child.createElement();\r\n            childElement.mount(context.element);\r\n            childVNode = childElement.performRebuild();\r\n        }\r\n\r\n        const elementId = context.element.getElementId();\r\n        const widgetPath = context.element.getWidgetPath();\r\n\r\n        const style = {\r\n            position: 'relative'\r\n        };\r\n\r\n        return new VNode({\r\n            tag: 'div',\r\n            props: {\r\n                style,\r\n                'data-element-id': elementId,\r\n                'data-widget-path': widgetPath,\r\n                'data-widget': 'FractionalTranslation',\r\n                'data-translation': this.translation.toString(),\r\n                'data-transform-hit-tests': this.transformHitTests,\r\n                ref: (el) => this._onMount(el)\r\n            },\r\n            children: childVNode ? [childVNode] : [],\r\n            key: this.key\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Mount container and set up resize observer\r\n     * @private\r\n     */\r\n    _onMount(el) {\r\n        if (!el) return;\r\n\r\n        this._containerElement = el;\r\n\r\n        // Set up resize observer to recalculate translation\r\n        if (window.ResizeObserver) {\r\n            this._resizeObserver = new ResizeObserver(() => {\r\n                this._applyTranslation();\r\n            });\r\n            this._resizeObserver.observe(el);\r\n        }\r\n\r\n        // Fallback to window resize\r\n        const resizeHandler = () => this._applyTranslation();\r\n        window.addEventListener('resize', resizeHandler);\r\n\r\n        el._cleanupResize = () => {\r\n            window.removeEventListener('resize', resizeHandler);\r\n            if (this._resizeObserver) {\r\n                this._resizeObserver.disconnect();\r\n            }\r\n        };\r\n\r\n        this._applyTranslation();\r\n    }\r\n\r\n    /**\r\n     * Apply fractional translation\r\n     * Translates by fraction of own size\r\n     * @private\r\n     */\r\n    _applyTranslation() {\r\n        if (!this._containerElement) return;\r\n\r\n        try {\r\n            const rect = this._containerElement.getBoundingClientRect();\r\n            const width = rect.width || 100;\r\n            const height = rect.height || 100;\r\n\r\n            // Calculate translation in pixels based on fraction of own size\r\n            const translateX = width * this.translation.dx;\r\n            const translateY = height * this.translation.dy;\r\n\r\n            this._containerElement.style.transform = `translate(${translateX}px, ${translateY}px)`;\r\n        } catch (error) {\r\n            console.error('Error applying fractional translation:', error);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Debug properties\r\n     */\r\n    debugFillProperties(properties) {\r\n        super.debugFillProperties(properties);\r\n        properties.push({ name: 'translation', value: this.translation.toString() });\r\n        properties.push({ name: 'transformHitTests', value: this.transformHitTests });\r\n    }\r\n\r\n    /**\r\n     * Create element\r\n     */\r\n    createElement() {\r\n        return new FractionalTranslationElement(this);\r\n    }\r\n}\r\n\r\n// ============================================================================\r\n// RENDER FRACTIONAL TRANSLATION\r\n// ============================================================================\r\n\r\nclass RenderFractionalTranslation {\r\n    constructor({\r\n        translation = null,\r\n        transformHitTests = true\r\n    } = {}) {\r\n        this.translation = translation;\r\n        this.transformHitTests = transformHitTests;\r\n    }\r\n\r\n    /**\r\n     * Debug info\r\n     */\r\n    debugInfo() {\r\n        return {\r\n            type: 'RenderFractionalTranslation',\r\n            translation: this.translation?.toString(),\r\n            transformHitTests: this.transformHitTests\r\n        };\r\n    }\r\n}\r\n\r\n// ============================================================================\r\n// FRACTIONAL TRANSLATION ELEMENT\r\n// ============================================================================\r\n\r\nclass FractionalTranslationElement extends ProxyWidget.constructor.prototype.constructor {\r\n    performRebuild() {\r\n        return this.widget.build(this.context);\r\n    }\r\n\r\n    detach() {\r\n        if (this.widget._containerElement && this.widget._containerElement._cleanupResize) {\r\n            this.widget._containerElement._cleanupResize();\r\n        }\r\n        super.detach();\r\n    }\r\n}\r\n\r\n// ============================================================================\r\n// ROTATED BOX WIDGET\r\n// Rotates child by increments of 90 degrees (quarter turns)\r\n// ============================================================================\r\n\r\nclass RotatedBox extends ProxyWidget {\r\n    constructor({\r\n        key = null,\r\n        quarterTurns = 0,\r\n        child = null\r\n    } = {}) {\r\n        super({ key, child });\r\n\r\n        if (typeof quarterTurns !== 'number' || !Number.isInteger(quarterTurns)) {\r\n            throw new Error(\r\n                `RotatedBox requires quarterTurns to be an integer, got: ${quarterTurns}`\r\n            );\r\n        }\r\n\r\n        this.quarterTurns = quarterTurns;\r\n        this._renderObject = null;\r\n    }\r\n\r\n    /**\r\n     * Create render object\r\n     */\r\n    createRenderObject(context) {\r\n        return new RenderRotatedBox({\r\n            quarterTurns: this.quarterTurns\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Update render object\r\n     */\r\n    updateRenderObject(context, renderObject) {\r\n        renderObject.quarterTurns = this.quarterTurns;\r\n    }\r\n\r\n    /**\r\n     * Build the widget\r\n     */\r\n    build(context) {\r\n        if (!this._renderObject) {\r\n            this._renderObject = this.createRenderObject(context);\r\n        } else {\r\n            this.updateRenderObject(context, this._renderObject);\r\n        }\r\n\r\n        let childVNode = null;\r\n        if (this.child) {\r\n            const childElement = this.child.createElement();\r\n            childElement.mount(context.element);\r\n            childVNode = childElement.performRebuild();\r\n        }\r\n\r\n        const elementId = context.element.getElementId();\r\n        const widgetPath = context.element.getWidgetPath();\r\n\r\n        // Calculate rotation angle and required dimensions\r\n        const rotationAngle = this._getRotationAngle();\r\n        const swapDimensions = this._shouldSwapDimensions();\r\n\r\n        const style = {\r\n            position: 'relative',\r\n            display: 'inline-flex',\r\n            alignItems: 'center',\r\n            justifyContent: 'center',\r\n            transform: `rotate(${rotationAngle}deg)`,\r\n            transformOrigin: 'center'\r\n        };\r\n\r\n        return new VNode({\r\n            tag: 'div',\r\n            props: {\r\n                style,\r\n                'data-element-id': elementId,\r\n                'data-widget-path': widgetPath,\r\n                'data-widget': 'RotatedBox',\r\n                'data-quarter-turns': this.quarterTurns,\r\n                'data-rotation-angle': rotationAngle\r\n            },\r\n            children: childVNode ? [childVNode] : [],\r\n            key: this.key\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Get rotation angle in degrees\r\n     * @private\r\n     */\r\n    _getRotationAngle() {\r\n        // Normalize quarter turns to 0-3 range\r\n        const normalized = ((this.quarterTurns % 4) + 4) % 4;\r\n        return normalized * 90;\r\n    }\r\n\r\n    /**\r\n     * Check if dimensions should be swapped\r\n     * When rotated 90 or 270 degrees, width becomes height\r\n     * @private\r\n     */\r\n    _shouldSwapDimensions() {\r\n        const normalized = ((this.quarterTurns % 4) + 4) % 4;\r\n        return normalized === 1 || normalized === 3;\r\n    }\r\n\r\n    /**\r\n     * Debug properties\r\n     */\r\n    debugFillProperties(properties) {\r\n        super.debugFillProperties(properties);\r\n        properties.push({ name: 'quarterTurns', value: this.quarterTurns });\r\n        properties.push({ name: 'rotationAngle', value: `${this._getRotationAngle()}\u00B0` });\r\n    }\r\n\r\n    /**\r\n     * Create element\r\n     */\r\n    createElement() {\r\n        return new RotatedBoxElement(this);\r\n    }\r\n}\r\n\r\n// ============================================================================\r\n// RENDER ROTATED BOX\r\n// ============================================================================\r\n\r\nclass RenderRotatedBox {\r\n    constructor({\r\n        quarterTurns = 0\r\n    } = {}) {\r\n        this.quarterTurns = quarterTurns;\r\n    }\r\n\r\n    /**\r\n     * Debug info\r\n     */\r\n    debugInfo() {\r\n        return {\r\n            type: 'RenderRotatedBox',\r\n            quarterTurns: this.quarterTurns,\r\n            rotationAngle: `${((this.quarterTurns % 4 + 4) % 4) * 90}\u00B0`\r\n        };\r\n    }\r\n}\r\n\r\n// ============================================================================\r\n// ROTATED BOX ELEMENT\r\n// ============================================================================\r\n\r\nclass RotatedBoxElement extends ProxyWidget.constructor.prototype.constructor {\r\n    performRebuild() {\r\n        return this.widget.build(this.context);\r\n    }\r\n}\r\n\r\nexport {\r\n    FractionalTranslation,\r\n    RenderFractionalTranslation,\r\n    RotatedBox,\r\n    RenderRotatedBox\r\n};"],
  "mappings": "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",
  "names": ["ProxyWidget", "VNode", "Offset", "FractionalTranslation", "key", "translation", "transformHitTests", "child", "context", "RenderFractionalTranslation", "renderObject", "childVNode", "childElement", "elementId", "widgetPath", "style", "el", "resizeHandler", "rect", "width", "height", "translateX", "translateY", "error", "properties", "FractionalTranslationElement", "RotatedBox", "quarterTurns", "RenderRotatedBox", "rotationAngle", "swapDimensions", "normalized", "RotatedBoxElement"]
}
