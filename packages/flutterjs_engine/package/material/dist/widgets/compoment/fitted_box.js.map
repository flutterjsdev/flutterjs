{
  "version": 3,
  "sources": ["../../../src/widgets/compoment/fitted_box.js"],
  "sourcesContent": ["import { ProxyWidget } from '../../core/widget_element.js';\r\nimport { VNode } from '@flutterjs/vdom/vnode';\r\nimport { Alignment,Clip ,BoxFit} from '../../utils.js';\r\n\r\n\r\n\r\n// ============================================================================\r\n// FITTED BOX WIDGET\r\n// Scales and positions child to fit available space\r\n// ============================================================================\r\n\r\nclass FittedBox extends ProxyWidget {\r\n    constructor({\r\n        key = null,\r\n        fit = BoxFit.contain,\r\n        alignment = Alignment.center,\r\n        clipBehavior = Clip.none,\r\n        child = null\r\n    } = {}) {\r\n        super({ key, child });\r\n\r\n        if (!Object.values(BoxFit).includes(fit)) {\r\n            throw new Error(`Invalid BoxFit: ${fit}`);\r\n        }\r\n\r\n        if (!Object.values(Clip).includes(clipBehavior)) {\r\n            throw new Error(`Invalid clipBehavior: ${clipBehavior}`);\r\n        }\r\n\r\n        if (!(alignment instanceof Alignment)) {\r\n            throw new Error(\r\n                `FittedBox requires an Alignment instance, got: ${typeof alignment}`\r\n            );\r\n        }\r\n\r\n        this.fit = fit;\r\n        this.alignment = alignment;\r\n        this.clipBehavior = clipBehavior;\r\n        this._renderObject = null;\r\n        this._containerElement = null;\r\n        this._childElement = null;\r\n        this._resizeObserver = null;\r\n    }\r\n\r\n    /**\r\n     * Create render object\r\n     */\r\n    createRenderObject(context) {\r\n        return new RenderFittedBox({\r\n            fit: this.fit,\r\n            alignment: this.alignment,\r\n            clipBehavior: this.clipBehavior\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Update render object\r\n     */\r\n    updateRenderObject(context, renderObject) {\r\n        renderObject.fit = this.fit;\r\n        renderObject.alignment = this.alignment;\r\n        renderObject.clipBehavior = this.clipBehavior;\r\n    }\r\n\r\n    /**\r\n     * Build the widget\r\n     */\r\n    build(context) {\r\n        if (!this._renderObject) {\r\n            this._renderObject = this.createRenderObject(context);\r\n        } else {\r\n            this.updateRenderObject(context, this._renderObject);\r\n        }\r\n\r\n        let childVNode = null;\r\n        if (this.child) {\r\n            const childElement = this.child.createElement();\r\n            childElement.mount(context.element);\r\n            childVNode = childElement.performRebuild();\r\n        }\r\n\r\n        const elementId = context.element.getElementId();\r\n        const widgetPath = context.element.getWidgetPath();\r\n\r\n        // Overflow handling\r\n        const overflowValue = this.clipBehavior === Clip.none ? 'visible' : 'hidden';\r\n\r\n        const style = {\r\n            position: 'relative',\r\n            overflow: overflowValue,\r\n            display: 'flex',\r\n            alignItems: this._getAlignmentValue('vertical'),\r\n            justifyContent: this._getAlignmentValue('horizontal'),\r\n            width: '100%',\r\n            height: '100%'\r\n        };\r\n\r\n        return new VNode({\r\n            tag: 'div',\r\n            props: {\r\n                style,\r\n                'data-element-id': elementId,\r\n                'data-widget-path': widgetPath,\r\n                'data-widget': 'FittedBox',\r\n                'data-fit': this.fit,\r\n                'data-alignment': this.alignment.toString(),\r\n                'data-clip-behavior': this.clipBehavior,\r\n                ref: (el) => this._onContainerMount(el)\r\n            },\r\n            children: [\r\n                new VNode({\r\n                    tag: 'div',\r\n                    props: {\r\n                        style: {\r\n                            position: 'relative',\r\n                            width: 'auto',\r\n                            height: 'auto',\r\n                            maxWidth: '100%',\r\n                            maxHeight: '100%'\r\n                        },\r\n                        ref: (el) => this._onChildMount(el)\r\n                    },\r\n                    children: childVNode ? [childVNode] : []\r\n                })\r\n            ],\r\n            key: this.key\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Mount container and set up resize observer\r\n     * @private\r\n     */\r\n    _onContainerMount(el) {\r\n        if (!el) return;\r\n\r\n        this._containerElement = el;\r\n\r\n        // Set up resize observer to handle size changes\r\n        if (window.ResizeObserver) {\r\n            this._resizeObserver = new ResizeObserver(() => {\r\n                this._applyFitting();\r\n            });\r\n            this._resizeObserver.observe(el);\r\n        }\r\n\r\n        // Fallback to window resize\r\n        const resizeHandler = () => this._applyFitting();\r\n        window.addEventListener('resize', resizeHandler);\r\n\r\n        el._cleanupResize = () => {\r\n            window.removeEventListener('resize', resizeHandler);\r\n            if (this._resizeObserver) {\r\n                this._resizeObserver.disconnect();\r\n            }\r\n        };\r\n\r\n        this._applyFitting();\r\n    }\r\n\r\n    /**\r\n     * Mount child element\r\n     * @private\r\n     */\r\n    _onChildMount(el) {\r\n        if (!el) return;\r\n\r\n        this._childElement = el;\r\n        this._applyFitting();\r\n    }\r\n\r\n    /**\r\n     * Apply fitting logic\r\n     * @private\r\n     */\r\n    _applyFitting() {\r\n        if (!this._containerElement || !this._childElement) return;\r\n\r\n        try {\r\n            const containerRect = this._containerElement.getBoundingClientRect();\r\n            const containerWidth = containerRect.width || 300;\r\n            const containerHeight = containerRect.height || 300;\r\n\r\n            // Get child's natural dimensions\r\n            const childRect = this._childElement.getBoundingClientRect();\r\n            let childWidth = childRect.width || 100;\r\n            let childHeight = childRect.height || 100;\r\n\r\n            // Calculate scaling factors\r\n            const scaleX = containerWidth / childWidth;\r\n            const scaleY = containerHeight / childHeight;\r\n\r\n            let scale = 1;\r\n            let transform = 'none';\r\n\r\n            // Apply BoxFit logic\r\n            switch (this.fit) {\r\n                case BoxFit.fill:\r\n                    // Stretch to fill, ignore aspect ratio\r\n                    transform = `scaleX(${scaleX}) scaleY(${scaleY})`;\r\n                    break;\r\n\r\n                case BoxFit.cover:\r\n                    // Scale to cover, maintain aspect ratio, may crop\r\n                    scale = Math.max(scaleX, scaleY);\r\n                    transform = `scale(${scale})`;\r\n                    break;\r\n\r\n                case BoxFit.contain:\r\n                    // Scale to fit inside, maintain aspect ratio\r\n                    scale = Math.min(scaleX, scaleY);\r\n                    transform = `scale(${scale})`;\r\n                    break;\r\n\r\n                case BoxFit.fitWidth:\r\n                    // Fit to width, maintain aspect ratio\r\n                    scale = scaleX;\r\n                    transform = `scale(${scale})`;\r\n                    break;\r\n\r\n                case BoxFit.fitHeight:\r\n                    // Fit to height, maintain aspect ratio\r\n                    scale = scaleY;\r\n                    transform = `scale(${scale})`;\r\n                    break;\r\n\r\n                case BoxFit.none:\r\n                    // No scaling\r\n                    transform = 'none';\r\n                    break;\r\n\r\n                case BoxFit.scaleDown:\r\n                    // Scale down only if needed\r\n                    scale = Math.min(scaleX, scaleY, 1);\r\n                    transform = scale < 1 ? `scale(${scale})` : 'none';\r\n                    break;\r\n\r\n                default:\r\n                    transform = 'none';\r\n            }\r\n\r\n            // Apply transform\r\n            this._childElement.style.transform = transform;\r\n            this._childElement.style.transformOrigin = this._getTransformOrigin();\r\n        } catch (error) {\r\n            console.error('Error applying fitted box scaling:', error);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Get alignment value for flex properties\r\n     * @private\r\n     */\r\n    _getAlignmentValue(direction) {\r\n        if (direction === 'horizontal') {\r\n            if (this.alignment.x < 0) return 'flex-start';\r\n            if (this.alignment.x > 0) return 'flex-end';\r\n            return 'center';\r\n        } else if (direction === 'vertical') {\r\n            if (this.alignment.y < 0) return 'flex-start';\r\n            if (this.alignment.y > 0) return 'flex-end';\r\n            return 'center';\r\n        }\r\n        return 'center';\r\n    }\r\n\r\n    /**\r\n     * Get transform origin from alignment\r\n     * @private\r\n     */\r\n    _getTransformOrigin() {\r\n        const x = ((this.alignment.x + 1) / 2) * 100;\r\n        const y = ((this.alignment.y + 1) / 2) * 100;\r\n        return `${x}% ${y}%`;\r\n    }\r\n\r\n    /**\r\n     * Debug properties\r\n     */\r\n    debugFillProperties(properties) {\r\n        super.debugFillProperties(properties);\r\n        properties.push({ name: 'fit', value: this.fit });\r\n        properties.push({ name: 'alignment', value: this.alignment.toString() });\r\n        properties.push({ name: 'clipBehavior', value: this.clipBehavior });\r\n    }\r\n\r\n    /**\r\n     * Create element\r\n     */\r\n    createElement() {\r\n        return new FittedBoxElement(this);\r\n    }\r\n}\r\n\r\n// ============================================================================\r\n// RENDER FITTED BOX\r\n// ============================================================================\r\n\r\nclass RenderFittedBox {\r\n    constructor({\r\n        fit = BoxFit.contain,\r\n        alignment = Alignment.center,\r\n        clipBehavior = Clip.none\r\n    } = {}) {\r\n        this.fit = fit;\r\n        this.alignment = alignment;\r\n        this.clipBehavior = clipBehavior;\r\n    }\r\n\r\n    /**\r\n     * Debug info\r\n     */\r\n    debugInfo() {\r\n        return {\r\n            type: 'RenderFittedBox',\r\n            fit: this.fit,\r\n            alignment: this.alignment.toString(),\r\n            clipBehavior: this.clipBehavior\r\n        };\r\n    }\r\n}\r\n\r\n// ============================================================================\r\n// FITTED BOX ELEMENT\r\n// ============================================================================\r\n\r\nclass FittedBoxElement extends ProxyWidget.constructor.prototype.constructor {\r\n    performRebuild() {\r\n        return this.widget.build(this.context);\r\n    }\r\n\r\n    detach() {\r\n        // Cleanup resize observer\r\n        if (this.widget._containerElement && this.widget._containerElement._cleanupResize) {\r\n            this.widget._containerElement._cleanupResize();\r\n        }\r\n        super.detach();\r\n    }\r\n}\r\n\r\nexport { FittedBox, RenderFittedBox, BoxFit };"],
  "mappings": "AAAA,OAAS,eAAAA,MAAmB,+BAC5B,OAAS,SAAAC,MAAa,wBACtB,OAAS,aAAAC,EAAU,QAAAC,EAAM,UAAAC,MAAa,iBAStC,MAAMC,UAAkBL,CAAY,CAChC,YAAY,CACR,IAAAM,EAAM,KACN,IAAAC,EAAMH,EAAO,QACb,UAAAI,EAAYN,EAAU,OACtB,aAAAO,EAAeN,EAAK,KACpB,MAAAO,EAAQ,IACZ,EAAI,CAAC,EAAG,CAGJ,GAFA,MAAM,CAAE,IAAAJ,EAAK,MAAAI,CAAM,CAAC,EAEhB,CAAC,OAAO,OAAON,CAAM,EAAE,SAASG,CAAG,EACnC,MAAM,IAAI,MAAM,mBAAmBA,CAAG,EAAE,EAG5C,GAAI,CAAC,OAAO,OAAOJ,CAAI,EAAE,SAASM,CAAY,EAC1C,MAAM,IAAI,MAAM,yBAAyBA,CAAY,EAAE,EAG3D,GAAI,EAAED,aAAqBN,GACvB,MAAM,IAAI,MACN,kDAAkD,OAAOM,CAAS,EACtE,EAGJ,KAAK,IAAMD,EACX,KAAK,UAAYC,EACjB,KAAK,aAAeC,EACpB,KAAK,cAAgB,KACrB,KAAK,kBAAoB,KACzB,KAAK,cAAgB,KACrB,KAAK,gBAAkB,IAC3B,CAKA,mBAAmBE,EAAS,CACxB,OAAO,IAAIC,EAAgB,CACvB,IAAK,KAAK,IACV,UAAW,KAAK,UAChB,aAAc,KAAK,YACvB,CAAC,CACL,CAKA,mBAAmBD,EAASE,EAAc,CACtCA,EAAa,IAAM,KAAK,IACxBA,EAAa,UAAY,KAAK,UAC9BA,EAAa,aAAe,KAAK,YACrC,CAKA,MAAMF,EAAS,CACN,KAAK,cAGN,KAAK,mBAAmBA,EAAS,KAAK,aAAa,EAFnD,KAAK,cAAgB,KAAK,mBAAmBA,CAAO,EAKxD,IAAIG,EAAa,KACjB,GAAI,KAAK,MAAO,CACZ,MAAMC,EAAe,KAAK,MAAM,cAAc,EAC9CA,EAAa,MAAMJ,EAAQ,OAAO,EAClCG,EAAaC,EAAa,eAAe,CAC7C,CAEA,MAAMC,EAAYL,EAAQ,QAAQ,aAAa,EACzCM,EAAaN,EAAQ,QAAQ,cAAc,EAK3CO,EAAQ,CACV,SAAU,WACV,SAJkB,KAAK,eAAiBf,EAAK,KAAO,UAAY,SAKhE,QAAS,OACT,WAAY,KAAK,mBAAmB,UAAU,EAC9C,eAAgB,KAAK,mBAAmB,YAAY,EACpD,MAAO,OACP,OAAQ,MACZ,EAEA,OAAO,IAAIF,EAAM,CACb,IAAK,MACL,MAAO,CACH,MAAAiB,EACA,kBAAmBF,EACnB,mBAAoBC,EACpB,cAAe,YACf,WAAY,KAAK,IACjB,iBAAkB,KAAK,UAAU,SAAS,EAC1C,qBAAsB,KAAK,aAC3B,IAAME,GAAO,KAAK,kBAAkBA,CAAE,CAC1C,EACA,SAAU,CACN,IAAIlB,EAAM,CACN,IAAK,MACL,MAAO,CACH,MAAO,CACH,SAAU,WACV,MAAO,OACP,OAAQ,OACR,SAAU,OACV,UAAW,MACf,EACA,IAAMkB,GAAO,KAAK,cAAcA,CAAE,CACtC,EACA,SAAUL,EAAa,CAACA,CAAU,EAAI,CAAC,CAC3C,CAAC,CACL,EACA,IAAK,KAAK,GACd,CAAC,CACL,CAMA,kBAAkBK,EAAI,CAClB,GAAI,CAACA,EAAI,OAET,KAAK,kBAAoBA,EAGrB,OAAO,iBACP,KAAK,gBAAkB,IAAI,eAAe,IAAM,CAC5C,KAAK,cAAc,CACvB,CAAC,EACD,KAAK,gBAAgB,QAAQA,CAAE,GAInC,MAAMC,EAAgB,IAAM,KAAK,cAAc,EAC/C,OAAO,iBAAiB,SAAUA,CAAa,EAE/CD,EAAG,eAAiB,IAAM,CACtB,OAAO,oBAAoB,SAAUC,CAAa,EAC9C,KAAK,iBACL,KAAK,gBAAgB,WAAW,CAExC,EAEA,KAAK,cAAc,CACvB,CAMA,cAAcD,EAAI,CACTA,IAEL,KAAK,cAAgBA,EACrB,KAAK,cAAc,EACvB,CAMA,eAAgB,CACZ,GAAI,GAAC,KAAK,mBAAqB,CAAC,KAAK,eAErC,GAAI,CACA,MAAME,EAAgB,KAAK,kBAAkB,sBAAsB,EAC7DC,EAAiBD,EAAc,OAAS,IACxCE,EAAkBF,EAAc,QAAU,IAG1CG,EAAY,KAAK,cAAc,sBAAsB,EAC3D,IAAIC,EAAaD,EAAU,OAAS,IAChCE,EAAcF,EAAU,QAAU,IAGtC,MAAMG,EAASL,EAAiBG,EAC1BG,EAASL,EAAkBG,EAEjC,IAAIG,EAAQ,EACRC,EAAY,OAGhB,OAAQ,KAAK,IAAK,CACd,KAAK1B,EAAO,KAER0B,EAAY,UAAUH,CAAM,YAAYC,CAAM,IAC9C,MAEJ,KAAKxB,EAAO,MAERyB,EAAQ,KAAK,IAAIF,EAAQC,CAAM,EAC/BE,EAAY,SAASD,CAAK,IAC1B,MAEJ,KAAKzB,EAAO,QAERyB,EAAQ,KAAK,IAAIF,EAAQC,CAAM,EAC/BE,EAAY,SAASD,CAAK,IAC1B,MAEJ,KAAKzB,EAAO,SAERyB,EAAQF,EACRG,EAAY,SAASD,CAAK,IAC1B,MAEJ,KAAKzB,EAAO,UAERyB,EAAQD,EACRE,EAAY,SAASD,CAAK,IAC1B,MAEJ,KAAKzB,EAAO,KAER0B,EAAY,OACZ,MAEJ,KAAK1B,EAAO,UAERyB,EAAQ,KAAK,IAAIF,EAAQC,EAAQ,CAAC,EAClCE,EAAYD,EAAQ,EAAI,SAASA,CAAK,IAAM,OAC5C,MAEJ,QACIC,EAAY,MACpB,CAGA,KAAK,cAAc,MAAM,UAAYA,EACrC,KAAK,cAAc,MAAM,gBAAkB,KAAK,oBAAoB,CACxE,OAASC,EAAO,CACZ,QAAQ,MAAM,qCAAsCA,CAAK,CAC7D,CACJ,CAMA,mBAAmBC,EAAW,CAC1B,OAAIA,IAAc,aACV,KAAK,UAAU,EAAI,EAAU,aAC7B,KAAK,UAAU,EAAI,EAAU,WAC1B,SACAA,IAAc,WACjB,KAAK,UAAU,EAAI,EAAU,aAC7B,KAAK,UAAU,EAAI,EAAU,WAC1B,SAEJ,QACX,CAMA,qBAAsB,CAClB,MAAMC,GAAM,KAAK,UAAU,EAAI,GAAK,EAAK,IACnCC,GAAM,KAAK,UAAU,EAAI,GAAK,EAAK,IACzC,MAAO,GAAGD,CAAC,KAAKC,CAAC,GACrB,CAKA,oBAAoBC,EAAY,CAC5B,MAAM,oBAAoBA,CAAU,EACpCA,EAAW,KAAK,CAAE,KAAM,MAAO,MAAO,KAAK,GAAI,CAAC,EAChDA,EAAW,KAAK,CAAE,KAAM,YAAa,MAAO,KAAK,UAAU,SAAS,CAAE,CAAC,EACvEA,EAAW,KAAK,CAAE,KAAM,eAAgB,MAAO,KAAK,YAAa,CAAC,CACtE,CAKA,eAAgB,CACZ,OAAO,IAAIC,EAAiB,IAAI,CACpC,CACJ,CAMA,MAAMxB,CAAgB,CAClB,YAAY,CACR,IAAAL,EAAMH,EAAO,QACb,UAAAI,EAAYN,EAAU,OACtB,aAAAO,EAAeN,EAAK,IACxB,EAAI,CAAC,EAAG,CACJ,KAAK,IAAMI,EACX,KAAK,UAAYC,EACjB,KAAK,aAAeC,CACxB,CAKA,WAAY,CACR,MAAO,CACH,KAAM,kBACN,IAAK,KAAK,IACV,UAAW,KAAK,UAAU,SAAS,EACnC,aAAc,KAAK,YACvB,CACJ,CACJ,CAMA,MAAM2B,UAAyBpC,EAAY,YAAY,UAAU,WAAY,CACzE,gBAAiB,CACb,OAAO,KAAK,OAAO,MAAM,KAAK,OAAO,CACzC,CAEA,QAAS,CAED,KAAK,OAAO,mBAAqB,KAAK,OAAO,kBAAkB,gBAC/D,KAAK,OAAO,kBAAkB,eAAe,EAEjD,MAAM,OAAO,CACjB,CACJ",
  "names": ["ProxyWidget", "VNode", "Alignment", "Clip", "BoxFit", "FittedBox", "key", "fit", "alignment", "clipBehavior", "child", "context", "RenderFittedBox", "renderObject", "childVNode", "childElement", "elementId", "widgetPath", "style", "el", "resizeHandler", "containerRect", "containerWidth", "containerHeight", "childRect", "childWidth", "childHeight", "scaleX", "scaleY", "scale", "transform", "error", "direction", "x", "y", "properties", "FittedBoxElement"]
}
