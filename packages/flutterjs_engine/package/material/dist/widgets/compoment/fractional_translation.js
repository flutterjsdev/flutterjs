import{ProxyWidget as o}from"../../core/widget_element.js";import{VNode as d}from"@flutterjs/vdom/vnode";import{Offset as m}from"../../utils/utils.js";class p extends o{constructor({key:t=null,translation:e=null,transformHitTests:r=!0,child:n=null}={}){if(super({key:t,child:n}),!e)throw new Error("FractionalTranslation requires a translation (Offset)");if(!(e instanceof m))throw new Error(`FractionalTranslation requires an Offset instance, got: ${typeof e}`);this.translation=e,this.transformHitTests=r,this._renderObject=null,this._containerElement=null,this._resizeObserver=null}createRenderObject(t){return new u({translation:this.translation,transformHitTests:this.transformHitTests})}updateRenderObject(t,e){e.translation=this.translation,e.transformHitTests=this.transformHitTests}build(t){this._renderObject?this.updateRenderObject(t,this._renderObject):this._renderObject=this.createRenderObject(t);let e=null;if(this.child){const a=this.child.createElement();a.mount(t.element),e=a.performRebuild()}const r=t.element.getElementId(),n=t.element.getWidgetPath(),s={position:"relative"};return new d({tag:"div",props:{style:s,"data-element-id":r,"data-widget-path":n,"data-widget":"FractionalTranslation","data-translation":this.translation.toString(),"data-transform-hit-tests":this.transformHitTests,ref:a=>this._onMount(a)},children:e?[e]:[],key:this.key})}_onMount(t){if(!t)return;this._containerElement=t,window.ResizeObserver&&(this._resizeObserver=new ResizeObserver(()=>{this._applyTranslation()}),this._resizeObserver.observe(t));const e=()=>this._applyTranslation();window.addEventListener("resize",e),t._cleanupResize=()=>{window.removeEventListener("resize",e),this._resizeObserver&&this._resizeObserver.disconnect()},this._applyTranslation()}_applyTranslation(){if(this._containerElement)try{const t=this._containerElement.getBoundingClientRect(),e=t.width||100,r=t.height||100,n=e*this.translation.dx,s=r*this.translation.dy;this._containerElement.style.transform=`translate(${n}px, ${s}px)`}catch(t){console.error("Error applying fractional translation:",t)}}debugFillProperties(t){super.debugFillProperties(t),t.push({name:"translation",value:this.translation.toString()}),t.push({name:"transformHitTests",value:this.transformHitTests})}createElement(){return new g(this)}}class u{constructor({translation:t=null,transformHitTests:e=!0}={}){this.translation=t,this.transformHitTests=e}debugInfo(){return{type:"RenderFractionalTranslation",translation:this.translation?.toString(),transformHitTests:this.transformHitTests}}}class g extends o.constructor.prototype.constructor{performRebuild(){return this.widget.build(this.context)}detach(){this.widget._containerElement&&this.widget._containerElement._cleanupResize&&this.widget._containerElement._cleanupResize(),super.detach()}}class f extends o{constructor({key:t=null,quarterTurns:e=0,child:r=null}={}){if(super({key:t,child:r}),typeof e!="number"||!Number.isInteger(e))throw new Error(`RotatedBox requires quarterTurns to be an integer, got: ${e}`);this.quarterTurns=e,this._renderObject=null}createRenderObject(t){return new h({quarterTurns:this.quarterTurns})}updateRenderObject(t,e){e.quarterTurns=this.quarterTurns}build(t){this._renderObject?this.updateRenderObject(t,this._renderObject):this._renderObject=this.createRenderObject(t);let e=null;if(this.child){const l=this.child.createElement();l.mount(t.element),e=l.performRebuild()}const r=t.element.getElementId(),n=t.element.getWidgetPath(),s=this._getRotationAngle(),a=this._shouldSwapDimensions(),c={position:"relative",display:"inline-flex",alignItems:"center",justifyContent:"center",transform:`rotate(${s}deg)`,transformOrigin:"center"};return new d({tag:"div",props:{style:c,"data-element-id":r,"data-widget-path":n,"data-widget":"RotatedBox","data-quarter-turns":this.quarterTurns,"data-rotation-angle":s},children:e?[e]:[],key:this.key})}_getRotationAngle(){return(this.quarterTurns%4+4)%4*90}_shouldSwapDimensions(){const t=(this.quarterTurns%4+4)%4;return t===1||t===3}debugFillProperties(t){super.debugFillProperties(t),t.push({name:"quarterTurns",value:this.quarterTurns}),t.push({name:"rotationAngle",value:`${this._getRotationAngle()}\xB0`})}createElement(){return new b(this)}}class h{constructor({quarterTurns:t=0}={}){this.quarterTurns=t}debugInfo(){return{type:"RenderRotatedBox",quarterTurns:this.quarterTurns,rotationAngle:`${(this.quarterTurns%4+4)%4*90}\xB0`}}}class b extends o.constructor.prototype.constructor{performRebuild(){return this.widget.build(this.context)}}export{p as FractionalTranslation,u as RenderFractionalTranslation,h as RenderRotatedBox,f as RotatedBox};
//# sourceMappingURL=fractional_translation.js.map
