import{Widget as w}from"../../core/widget_element.js";import{Element as D}from"@flutterjs/runtime";import{VNode as E}from"@flutterjs/vdom/vnode";import{Clip as x,TextDirection as f}from"../../utils/utils.js";const l={topLeft:"topLeft",topCenter:"topCenter",topRight:"topRight",centerLeft:"centerLeft",center:"center",centerRight:"centerRight",bottomLeft:"bottomLeft",bottomCenter:"bottomCenter",bottomRight:"bottomRight"},v={topStart:"topStart",topCenter:"topCenter",topEnd:"topEnd",centerStart:"centerStart",center:"center",centerEnd:"centerEnd",bottomStart:"bottomStart",bottomCenter:"bottomCenter",bottomEnd:"bottomEnd"},m={loose:"loose",expand:"expand",passthrough:"passthrough"};class R{constructor(){this.left=null,this.top=null,this.right=null,this.bottom=null,this.width=null,this.height=null}isPositioned(){return this.left!==null||this.top!==null||this.right!==null||this.bottom!==null||this.width!==null||this.height!==null}debugInfo(){return{left:this.left,top:this.top,right:this.right,bottom:this.bottom,width:this.width,height:this.height,isPositioned:this.isPositioned()}}}class C{constructor({alignment:t=v.topStart,textDirection:e=f.ltr,fit:i=m.loose,clipBehavior:o=x.hardEdge}={}){this.alignment=t,this.textDirection=e,this.fit=i,this.clipBehavior=o,this._children=[]}addChild(t){this._children.push(t)}removeChild(t){const e=this._children.indexOf(t);e>-1&&this._children.splice(e,1)}_resolveAlignment(){if(this.alignment.includes&&this.alignment.includes("Directional")){const t=this.textDirection===f.rtl;return{topStart:t?l.topRight:l.topLeft,topEnd:t?l.topLeft:l.topRight,centerStart:t?l.centerRight:l.centerLeft,centerEnd:t?l.centerLeft:l.centerRight,bottomStart:t?l.bottomRight:l.bottomLeft,bottomEnd:t?l.bottomLeft:l.bottomRight,topCenter:l.topCenter,center:l.center,bottomCenter:l.bottomCenter}[this.alignment]||l.topLeft}return this.alignment}_getAlignmentOffset(t){const e={topLeft:{x:"flex-start",y:"flex-start"},topCenter:{x:"center",y:"flex-start"},topRight:{x:"flex-end",y:"flex-start"},centerLeft:{x:"flex-start",y:"center"},center:{x:"center",y:"center"},centerRight:{x:"flex-end",y:"center"},bottomLeft:{x:"flex-start",y:"flex-end"},bottomCenter:{x:"center",y:"flex-end"},bottomRight:{x:"flex-end",y:"flex-end"}};return e[t]||e.topLeft}debugInfo(){return{type:"RenderStack",alignment:this.alignment,textDirection:this.textDirection,fit:this.fit,clipBehavior:this.clipBehavior,childCount:this._children.length,resolvedAlignment:this._resolveAlignment()}}}class a extends w{constructor({key:t=null,left:e=null,top:i=null,right:o=null,bottom:h=null,width:r=null,height:u=null,child:c=null}={}){if(super(t),e!==null&&o!==null&&r!==null)throw new Error("Cannot specify both left, right, and width");if(i!==null&&h!==null&&u!==null)throw new Error("Cannot specify both top, bottom, and height");this.left=e,this.top=i,this.right=o,this.bottom=h,this.width=r,this.height=u,this.child=c}static fill({key:t=null,left:e=0,top:i=0,right:o=0,bottom:h=0,child:r=null}={}){return new a({key:t,left:e,top:i,right:o,bottom:h,child:r})}static fromRect({key:t=null,rect:e=null,child:i=null}={}){if(!e)throw new Error("rect is required");return new a({key:t,left:e.left,top:e.top,width:e.width,height:e.height,child:i})}static directional({key:t=null,textDirection:e=f.ltr,start:i=null,top:o=null,end:h=null,bottom:r=null,width:u=null,height:c=null,child:n=null}={}){const p=e===f.rtl,g=p?h:i,b=p?i:h;return new a({key:t,left:g,top:o,right:b,bottom:r,width:u,height:c,child:n})}applyParentData(t){t.parentData||(t.parentData=new R);const e=t.parentData;let i=!1;e.left!==this.left&&(e.left=this.left,i=!0),e.top!==this.top&&(e.top=this.top,i=!0),e.right!==this.right&&(e.right=this.right,i=!0),e.bottom!==this.bottom&&(e.bottom=this.bottom,i=!0),e.width!==this.width&&(e.width=this.width,i=!0),e.height!==this.height&&(e.height=this.height,i=!0),i&&t.parent&&t.parent.markNeedsLayout?.()}build(t){return this.child}debugFillProperties(t){super.debugFillProperties(t),this.left!==null&&t.push({name:"left",value:this.left}),this.top!==null&&t.push({name:"top",value:this.top}),this.right!==null&&t.push({name:"right",value:this.right}),this.bottom!==null&&t.push({name:"bottom",value:this.bottom}),this.width!==null&&t.push({name:"width",value:this.width}),this.height!==null&&t.push({name:"height",value:this.height})}createElement(t,e){return new y(this,t,e)}}class y extends D{performRebuild(){return this.widget.build(this.context)}}class L extends w{constructor({key:t=null,alignment:e=v.topStart,textDirection:i=null,fit:o=m.loose,clipBehavior:h=x.hardEdge,children:r=[]}={}){super(t),this.alignment=e,this.textDirection=i,this.fit=o,this.clipBehavior=h,this.children=r||[],this._renderObject=null,this._containerElement=null,this._childElements=[]}_debugCheckHasDirectionality(t){return!0}_getEffectiveTextDirection(t){return this.textDirection||t?.textDirection||f.ltr}createRenderObject(t){return new C({alignment:this.alignment,textDirection:this._getEffectiveTextDirection(t),fit:this.fit,clipBehavior:this.clipBehavior})}updateRenderObject(t,e){e.alignment=this.alignment,e.textDirection=this._getEffectiveTextDirection(t),e.fit=this.fit,e.clipBehavior=this.clipBehavior}build(t){this._debugCheckHasDirectionality(t),this._renderObject?this.updateRenderObject(t,this._renderObject):this._renderObject=this.createRenderObject(t);const e=t.element.getElementId(),i=t.element.getWidgetPath(),o=this._renderObject._resolveAlignment(),h=this._renderObject._getAlignmentOffset(o),r=this.clipBehavior===x.none?"visible":"hidden",u={position:"relative",display:"inline-flex",width:this.fit===m.expand?"100%":"auto",height:this.fit===m.expand?"100%":"auto",overflow:r,alignItems:h.y,justifyContent:h.x},c=this.children.map((n,p)=>{const g=n.createElement(t.element,t.element.runtime);g.mount(t.element);const b=g.performRebuild();let s={position:"absolute"};return n instanceof a&&(n.left!==null&&(s.left=`${n.left}px`),n.top!==null&&(s.top=`${n.top}px`),n.right!==null&&(s.right=`${n.right}px`),n.bottom!==null&&(s.bottom=`${n.bottom}px`),n.width!==null&&(s.width=`${n.width}px`),n.height!==null&&(s.height=`${n.height}px`)),new E({tag:"div",props:{style:s,"data-stack-index":p,"data-positioned":n instanceof a},children:[b]})});return new E({tag:"div",props:{style:u,"data-element-id":e,"data-widget-path":i,"data-widget":"Stack","data-alignment":this.alignment,"data-fit":this.fit,"data-clip-behavior":this.clipBehavior,"data-text-direction":this._getEffectiveTextDirection(t),ref:n=>this._onContainerMount(n)},children:c,key:this.key})}_onContainerMount(t){t&&(this._containerElement=t)}debugFillProperties(t){super.debugFillProperties(t),t.push({name:"alignment",value:this.alignment}),t.push({name:"textDirection",value:this.textDirection}),t.push({name:"fit",value:this.fit}),t.push({name:"clipBehavior",value:this.clipBehavior}),t.push({name:"childCount",value:this.children.length})}createElement(t,e){return new _(this,t,e)}}class _ extends D{performRebuild(){return this.widget.build(this.context)}}export{l as Alignment,v as AlignmentDirectional,a as Positioned,y as PositionedElement,C as RenderStack,L as Stack,_ as StackElement,m as StackFit,R as StackParentData};
//# sourceMappingURL=stack.js.map
