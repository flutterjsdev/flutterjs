import{Widget as v}from"../../core/widget_element.js";import{Element as w}from"@flutterjs/runtime";import{VNode as D}from"@flutterjs/vdom/vnode";import{Clip as b,TextDirection as f,Alignment as l,AlignmentDirectional as E,StackFit as g}from"../../utils/utils.js";class y{constructor(){this.left=null,this.top=null,this.right=null,this.bottom=null,this.width=null,this.height=null}isPositioned(){return this.left!==null||this.top!==null||this.right!==null||this.bottom!==null||this.width!==null||this.height!==null}debugInfo(){return{left:this.left,top:this.top,right:this.right,bottom:this.bottom,width:this.width,height:this.height,isPositioned:this.isPositioned()}}}class _{constructor({alignment:t=E.topStart,textDirection:e=f.ltr,fit:i=g.loose,clipBehavior:h=b.hardEdge}={}){this.alignment=t,this.textDirection=e,this.fit=i,this.clipBehavior=h,this._children=[]}addChild(t){this._children.push(t)}removeChild(t){const e=this._children.indexOf(t);e>-1&&this._children.splice(e,1)}_resolveAlignment(){if(this.alignment.includes&&this.alignment.includes("Directional")){const t=this.textDirection===f.rtl;return{topStart:t?l.topRight:l.topLeft,topEnd:t?l.topLeft:l.topRight,centerStart:t?l.centerRight:l.centerLeft,centerEnd:t?l.centerLeft:l.centerRight,bottomStart:t?l.bottomRight:l.bottomLeft,bottomEnd:t?l.bottomLeft:l.bottomRight,topCenter:l.topCenter,center:l.center,bottomCenter:l.bottomCenter}[this.alignment]||l.topLeft}return this.alignment}_getAlignmentOffset(t){const e={topLeft:{x:"flex-start",y:"flex-start"},topCenter:{x:"center",y:"flex-start"},topRight:{x:"flex-end",y:"flex-start"},centerLeft:{x:"flex-start",y:"center"},center:{x:"center",y:"center"},centerRight:{x:"flex-end",y:"center"},bottomLeft:{x:"flex-start",y:"flex-end"},bottomCenter:{x:"center",y:"flex-end"},bottomRight:{x:"flex-end",y:"flex-end"}};return e[t]||e.topLeft}debugInfo(){return{type:"RenderStack",alignment:this.alignment,textDirection:this.textDirection,fit:this.fit,clipBehavior:this.clipBehavior,childCount:this._children.length,resolvedAlignment:this._resolveAlignment()}}}class a extends v{constructor({key:t=null,left:e=null,top:i=null,right:h=null,bottom:s=null,width:r=null,height:u=null,child:c=null}={}){if(super(t),e!==null&&h!==null&&r!==null)throw new Error("Cannot specify both left, right, and width");if(i!==null&&s!==null&&u!==null)throw new Error("Cannot specify both top, bottom, and height");this.left=e,this.top=i,this.right=h,this.bottom=s,this.width=r,this.height=u,this.child=c}static fill({key:t=null,left:e=0,top:i=0,right:h=0,bottom:s=0,child:r=null}={}){return new a({key:t,left:e,top:i,right:h,bottom:s,child:r})}static fromRect({key:t=null,rect:e=null,child:i=null}={}){if(!e)throw new Error("rect is required");return new a({key:t,left:e.left,top:e.top,width:e.width,height:e.height,child:i})}static directional({key:t=null,textDirection:e=f.ltr,start:i=null,top:h=null,end:s=null,bottom:r=null,width:u=null,height:c=null,child:n=null}={}){const d=e===f.rtl,p=d?s:i,x=d?i:s;return new a({key:t,left:p,top:h,right:x,bottom:r,width:u,height:c,child:n})}applyParentData(t){t.parentData||(t.parentData=new y);const e=t.parentData;let i=!1;e.left!==this.left&&(e.left=this.left,i=!0),e.top!==this.top&&(e.top=this.top,i=!0),e.right!==this.right&&(e.right=this.right,i=!0),e.bottom!==this.bottom&&(e.bottom=this.bottom,i=!0),e.width!==this.width&&(e.width=this.width,i=!0),e.height!==this.height&&(e.height=this.height,i=!0),i&&t.parent&&t.parent.markNeedsLayout?.()}build(t){return this.child}debugFillProperties(t){super.debugFillProperties(t),this.left!==null&&t.push({name:"left",value:this.left}),this.top!==null&&t.push({name:"top",value:this.top}),this.right!==null&&t.push({name:"right",value:this.right}),this.bottom!==null&&t.push({name:"bottom",value:this.bottom}),this.width!==null&&t.push({name:"width",value:this.width}),this.height!==null&&t.push({name:"height",value:this.height})}createElement(t,e){return new R(this,t,e)}}class R extends w{performRebuild(){return this.widget.build(this.context)}}class k extends v{constructor({key:t=null,alignment:e=E.topStart,textDirection:i=null,fit:h=g.loose,clipBehavior:s=b.hardEdge,children:r=[]}={}){super(t),this.alignment=e,this.textDirection=i,this.fit=h,this.clipBehavior=s,this.children=r||[],this._renderObject=null,this._containerElement=null,this._childElements=[]}_debugCheckHasDirectionality(t){return!0}_getEffectiveTextDirection(t){return this.textDirection||t?.textDirection||f.ltr}createRenderObject(t){return new _({alignment:this.alignment,textDirection:this._getEffectiveTextDirection(t),fit:this.fit,clipBehavior:this.clipBehavior})}updateRenderObject(t,e){e.alignment=this.alignment,e.textDirection=this._getEffectiveTextDirection(t),e.fit=this.fit,e.clipBehavior=this.clipBehavior}build(t){this._debugCheckHasDirectionality(t),this._renderObject?this.updateRenderObject(t,this._renderObject):this._renderObject=this.createRenderObject(t);const e=t.element.getElementId(),i=t.element.getWidgetPath(),h=this._renderObject._resolveAlignment(),s=this._renderObject._getAlignmentOffset(h),r=this.clipBehavior===b.none?"visible":"hidden",u={position:"relative",display:"inline-flex",width:this.fit===g.expand?"100%":"auto",height:this.fit===g.expand?"100%":"auto",overflow:r,alignItems:s.y,justifyContent:s.x},c=this.children.map((n,d)=>{const p=n.createElement(t.element,t.element.runtime);p.mount(t.element);const x=p.performRebuild();let o={position:"absolute"};return n instanceof a&&(n.left!==null&&(o.left=`${n.left}px`),n.top!==null&&(o.top=`${n.top}px`),n.right!==null&&(o.right=`${n.right}px`),n.bottom!==null&&(o.bottom=`${n.bottom}px`),n.width!==null&&(o.width=`${n.width}px`),n.height!==null&&(o.height=`${n.height}px`)),new D({tag:"div",props:{style:o,"data-stack-index":d,"data-positioned":n instanceof a},children:[x]})});return new D({tag:"div",props:{style:u,"data-element-id":e,"data-widget-path":i,"data-widget":"Stack","data-alignment":this.alignment,"data-fit":this.fit,"data-clip-behavior":this.clipBehavior,"data-text-direction":this._getEffectiveTextDirection(t),ref:n=>this._onContainerMount(n)},children:c,key:this.key})}_onContainerMount(t){t&&(this._containerElement=t)}debugFillProperties(t){super.debugFillProperties(t),t.push({name:"alignment",value:this.alignment}),t.push({name:"textDirection",value:this.textDirection}),t.push({name:"fit",value:this.fit}),t.push({name:"clipBehavior",value:this.clipBehavior}),t.push({name:"childCount",value:this.children.length})}createElement(t,e){return new C(this,t,e)}}class C extends w{performRebuild(){return this.widget.build(this.context)}}export{a as Positioned,R as PositionedElement,_ as RenderStack,k as Stack,C as StackElement,y as StackParentData};
//# sourceMappingURL=stack.js.map
