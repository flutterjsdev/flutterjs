import{StatelessWidget as b}from"../core/widget_element.js";import{VNode as F}from"@flutterjs/vdom/vnode";import{StatefulElement as k,StatelessElement as w}from"@flutterjs/runtime";class i{constructor({brightness:t="light",primaryColor:e="#2196F3",primarySwatch:o=null,accentColor:r="#FF4081",scaffoldBackgroundColor:n="#FAFAFA",canvasColor:l="#FFF",cardColor:s="#FFF",dividerColor:u="rgba(0, 0, 0, 0.12)",highlightColor:a="rgba(0, 0, 0, 0.05)",splashColor:d="rgba(0, 0, 0, 0.2)",selectedRowColor:c="#F5F5F5",unselectedWidgetColor:g="rgba(0, 0, 0, 0.54)",disabledColor:h="rgba(0, 0, 0, 0.38)",textTheme:m=null,fontFamily:f='Roboto, -apple-system, BlinkMacSystemFont, "Segoe UI"',appBarTheme:p=null}={}){this.brightness=t,this.primaryColor=e,this.primarySwatch=o,this.accentColor=r,this.scaffoldBackgroundColor=n,this.canvasColor=l,this.cardColor=s,this.dividerColor=u,this.highlightColor=a,this.splashColor=d,this.selectedRowColor=c,this.unselectedWidgetColor=g,this.disabledColor=h,this.textTheme=m,this.fontFamily=f,this.appBarTheme=p}static dark(){return new i({brightness:"dark",primaryColor:"#1F1F1F",scaffoldBackgroundColor:"#121212",canvasColor:"#1E1E1E",cardColor:"#2C2C2C",dividerColor:"rgba(255, 255, 255, 0.12)",unselectedWidgetColor:"rgba(255, 255, 255, 0.70)"})}static light(){return new i({brightness:"light",primaryColor:"#2196F3",scaffoldBackgroundColor:"#FAFAFA",canvasColor:"#FFF",cardColor:"#FFF"})}}class S{constructor({name:t="/",builder:e=null,settings:o={}}={}){this.name=t,this.builder=e,this.settings=o}}class C{constructor({routes:t={},initialRoute:e="/",onGenerateRoute:o=null,onUnknownRoute:r=null}={}){this.routes=t,this.initialRoute=e,this.onGenerateRoute=o,this.onUnknownRoute=r,this.routeStack=[],this.currentRoute=e}pushNamed(t,{arguments:e=null}={}){this.currentRoute=t,this.routeStack.push(t)}pop(){return this.routeStack.length>1?(this.routeStack.pop(),this.currentRoute=this.routeStack[this.routeStack.length-1],!0):!1}getCurrentPage(t){const e=this.currentRoute;if(this.routes[e])return this.routes[e](t);if(this.onGenerateRoute){const o={name:e},r=this.onGenerateRoute(o);if(r)return r.builder(t)}if(this.onUnknownRoute){const o={name:e};return this.onUnknownRoute(o).builder(t)}return null}}class R extends b{constructor({key:t=null,title:e="",theme:o=null,darkTheme:r=null,themeMode:n="system",home:l=null,routes:s={},initialRoute:u="/",onGenerateRoute:a=null,onUnknownRoute:d=null,navigatorObservers:c=[],localizationsDelegates:g=[],supportedLocales:h=[{language:"en"}],locale:m=null,builder:f=null,color:p=null}={}){super(t),this.title=e,this.theme=o||i.light(),this.darkTheme=r||i.dark(),this.themeMode=n,this.color=p,this.home=l,this.routes=s,this.initialRoute=u,this.onGenerateRoute=a,this.onUnknownRoute=d,this.navigatorObservers=c,this.localizationsDelegates=g,this.supportedLocales=h,this.locale=m,this.builder=f,this.navigator=new C({routes:this.routes,initialRoute:this.initialRoute,onGenerateRoute:this.onGenerateRoute,onUnknownRoute:this.onUnknownRoute}),this.home&&(this.navigator.routes["/"]=E=>this.home),typeof document<"u"&&(document.title=this.title)}_getTheme(){return this.themeMode==="dark"?this.darkTheme:this.themeMode==="light"?this.theme:typeof window<"u"&&window.matchMedia?window.matchMedia("(prefers-color-scheme: dark)").matches?this.darkTheme:this.theme:this.theme}_applyTheme(t){if(typeof document>"u")return;const e=document.documentElement;e.style.setProperty("--primary-color",t.primaryColor),e.style.setProperty("--accent-color",t.accentColor),e.style.setProperty("--scaffold-bg",t.scaffoldBackgroundColor),e.style.setProperty("--card-color",t.cardColor),e.style.setProperty("--divider-color",t.dividerColor),e.style.setProperty("--font-family",t.fontFamily),e.style.setProperty("--text-color",t.brightness==="dark"?"#FFF":"#000"),document.body.style.backgroundColor=t.scaffoldBackgroundColor,document.body.style.fontFamily=t.fontFamily,document.body.style.color=t.brightness==="dark"?"#FFF":"#000"}_isWidget(t){return!t||typeof t!="object"?!1:typeof t.build=="function"||typeof t.createState=="function"}_buildWidgetToVNode(t,e){if(console.log("\u{1F528} _buildWidgetToVNode called for:",t?.constructor?.name),!t)return console.log("  \u2192 widget is null, returning null"),null;if(t&&t.tag!==void 0)return console.log("  \u2192 Already a VNode"),t;if(typeof t=="string"||typeof t=="number")return console.log("  \u2192 String/number, converting"),String(t);if(this._isWidget(t)){console.log("  \u2192 Is a Widget, creating Element...");try{let o;if(typeof t.createState=="function"){console.log("    \u2192 StatefulWidget detected, creating StatefulElement");const r=e.runtime||e.element?.runtime;if(!r)throw new Error("Runtime not available in context");o=new k(t,null,r),console.log("    \u2192 StatefulElement created"),o.mounted||(console.log("    \u2192 Mounting element..."),o.mount(),console.log("    \u2192 Element mounted"),console.log("    \u2192 State._widget:",o.state?._widget?.constructor?.name),console.log("    \u2192 State.widget.title:",o.state?.widget?.title));const n=o.build();return console.log("    \u2192 StatefulElement.build() returned:",n?.tag||typeof n),this._isWidget(n)?(console.log("    \u2192 Result is still a widget, recursing..."),this._buildWidgetToVNode(n,{...e,runtime:r})):n}else if(typeof t.build=="function"){console.log("    \u2192 StatelessWidget detected, creating StatelessElement");const r=e.runtime||e.element?.runtime;if(!r)throw new Error("Runtime not available in context");o=new w(t,null,r),o.mounted||o.mount();const n=o.build();return console.log("    \u2192 StatelessElement.build() returned:",n?.tag||typeof n),this._isWidget(n)?(console.log("    \u2192 Result is still a widget, recursing..."),this._buildWidgetToVNode(n,{...e,runtime:r})):n}}catch(o){throw console.error("  \u274C Error building widget:",o),o}}return console.log("  \u2192 Unknown type, returning null"),null}build(t){console.log("\u{1F4D6} MaterialApp.build() START");const e=this._getTheme();this._applyTheme(e);let o=this.navigator.getCurrentPage(t);console.log("\u{1F4C4} Current page widget:",o?.constructor?.name),o||(console.warn("\u26A0\uFE0F No page widget found"),o=this._buildEmptyPage());let r;try{r=this._buildWidgetToVNode(o,t),console.log("\u2705 pageVNode after building:",r?.tag||typeof r)}catch(l){console.error("\u274C Failed to build page widget:",l),r=this._buildEmptyPageVNode()}r||(console.error("\u274C pageVNode is null"),r=this._buildEmptyPageVNode());const n=new F({tag:"div",props:{style:{width:"100%",height:"100%",backgroundColor:e.scaffoldBackgroundColor,color:e.brightness==="dark"?"#FFF":"#000",fontFamily:e.fontFamily,margin:0,padding:0,boxSizing:"border-box",minHeight:"100vh"},"data-app":"MaterialApp","data-theme":e.brightness},children:[r]});return console.log("\u2705 MaterialApp.build() returning VNode"),n}_buildEmptyPage(){return new b({build:()=>this._buildEmptyPageVNode()})}_buildEmptyPageVNode(){return new F({tag:"div",props:{style:{padding:"20px",textAlign:"center"}},children:["No page configured"]})}}export{R as MaterialApp,C as Navigator,S as Route,i as ThemeData};
//# sourceMappingURL=material_app.js.map
