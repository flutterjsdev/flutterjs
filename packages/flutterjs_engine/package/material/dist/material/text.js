var F=Object.defineProperty;var L=(h,t,e)=>t in h?F(h,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):h[t]=e;var y=(h,t,e)=>(L(h,typeof t!="symbol"?t+"":t,e),e);import{StatelessWidget as I}from"../core/widget_element.js";import{VNode as M}from"@flutterjs/vdom/vnode";import{TextAlign as O,TextOverflow as T,TextDirection as $}from"../utils/utils.js";const o=class o{constructor({color:t="#000000",fontSize:e=14,fontWeight:s="400",fontStyle:i="normal",fontFamily:n="Roboto",height:l=1.5,letterSpacing:a=0,wordSpacing:c=0,decoration:d="none",decorationColor:g=null,decorationStyle:f="solid",decorationThickness:u=1,shadows:p=null,backgroundColor:S=null,backgroundOpacity:m=1,googleFont:b=null,fontVariant:w="normal",textTransform:x="none",opacity:k=1,strikethrough:v=!1,underline:W=!1,overline:C=!1,gradient:z=null}={}){this.color=t,this.fontSize=e,this.fontWeight=s,this.fontStyle=i,this.fontFamily=n,this.height=l,this.letterSpacing=a,this.wordSpacing=c,this.decoration=d,this.decorationColor=g,this.decorationStyle=f,this.decorationThickness=u,this.shadows=p,this.backgroundColor=S,this.backgroundOpacity=m,this.googleFont=b,this.fontVariant=w,this.textTransform=x,this.opacity=k,this.strikethrough=v,this.underline=W,this.overline=C,this.gradient=z,this.googleFont&&this._loadGoogleFont(this.googleFont)}_loadGoogleFont(t){if(typeof document>"u")return;const e=t.replace(/\s+/g,"+"),s=`google-font-${t.replace(/\s+/g,"-")}`;if(document.getElementById(s))return;const i=document.createElement("link");i.id=s,i.href=`https://fonts.googleapis.com/css2?family=${e}:wght@100;200;300;400;500;600;700;800;900&display=swap`,i.rel="stylesheet",i.crossOrigin="anonymous",document.head.appendChild(i)}copyWith({color:t,fontSize:e,fontWeight:s,fontStyle:i,fontFamily:n,height:l,letterSpacing:a,wordSpacing:c,decoration:d,decorationColor:g,decorationStyle:f,decorationThickness:u,shadows:p,backgroundColor:S,backgroundOpacity:m,googleFont:b,fontVariant:w,textTransform:x,opacity:k,strikethrough:v,underline:W,overline:C,gradient:z}={}){return new o({color:t??this.color,fontSize:e??this.fontSize,fontWeight:s??this.fontWeight,fontStyle:i??this.fontStyle,fontFamily:n??this.fontFamily,height:l??this.height,letterSpacing:a??this.letterSpacing,wordSpacing:c??this.wordSpacing,decoration:d??this.decoration,decorationColor:g??this.decorationColor,decorationStyle:f??this.decorationStyle,decorationThickness:u??this.decorationThickness,shadows:p??this.shadows,backgroundColor:S??this.backgroundColor,backgroundOpacity:m??this.backgroundOpacity,googleFont:b??this.googleFont,fontVariant:w??this.fontVariant,textTransform:x??this.textTransform,opacity:k??this.opacity,strikethrough:v??this.strikethrough,underline:W??this.underline,overline:C??this.overline,gradient:z??this.gradient})}merge(t){return t?this.copyWith(t):this}_buildTextDecoration(){const t=[];return this.underline&&t.push("underline"),this.overline&&t.push("overline"),this.strikethrough&&t.push("line-through"),t.length>0?t.join(" "):this.decoration}_buildTextShadow(){return!this.shadows||!Array.isArray(this.shadows)?"none":this.shadows.map(t=>{const e=t.offsetX??0,s=t.offsetY??0,i=t.blurRadius??0,n=t.color??"rgba(0,0,0,0.3)";return`${e}px ${s}px ${i}px ${n}`}).join(", ")}_buildBackground(){if(this.gradient)return this.gradient;if(!this.backgroundColor)return"transparent";if(this.backgroundOpacity<1){const t=this._hexToRgb(this.backgroundColor);return t?`rgba(${t.r}, ${t.g}, ${t.b}, ${this.backgroundOpacity})`:this.backgroundColor}return this.backgroundColor}_hexToRgb(t){const e=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t);return e?{r:parseInt(e[1],16),g:parseInt(e[2],16),b:parseInt(e[3],16)}:null}toCSSString(){const t=this._buildTextDecoration();return{color:this.color,fontSize:`${this.fontSize}px`,fontWeight:this.fontWeight,fontStyle:this.fontStyle,fontFamily:this.fontFamily,lineHeight:this.height,letterSpacing:`${this.letterSpacing}px`,wordSpacing:`${this.wordSpacing}px`,textDecoration:t,textDecorationColor:this.decorationColor||"currentColor",textDecorationStyle:this.decorationStyle,textDecorationThickness:`${this.decorationThickness}px`,backgroundColor:this._buildBackground(),fontVariant:this.fontVariant,textTransform:this.textTransform,opacity:this.opacity,textShadow:this._buildTextShadow()}}toCSSObject(){return this.toCSSString()}toFlutterString(){return`TextStyle(color: ${this.color}, size: ${this.fontSize}, family: ${this.fontFamily}, weight: ${this.fontWeight})`}toString(){return`TextStyle(color: ${this.color}, size: ${this.fontSize}px, family: ${this.fontFamily}, weight: ${this.fontWeight})`}};y(o,"preset",{h1:new o({fontSize:32,fontWeight:"700",height:1.2}),h2:new o({fontSize:28,fontWeight:"700",height:1.3}),h3:new o({fontSize:24,fontWeight:"600",height:1.4}),h4:new o({fontSize:20,fontWeight:"600",height:1.4}),h5:new o({fontSize:16,fontWeight:"600",height:1.5}),h6:new o({fontSize:14,fontWeight:"600",height:1.5}),body1:new o({fontSize:16,fontWeight:"400",height:1.5}),body2:new o({fontSize:14,fontWeight:"400",height:1.5}),caption:new o({fontSize:12,fontWeight:"400",height:1.4,opacity:.7}),button:new o({fontSize:14,fontWeight:"600",textTransform:"uppercase"}),code:new o({fontSize:13,fontFamily:"monospace",fontWeight:"400"})}),y(o,"availableGoogleFonts",["Roboto","Open Sans","Lato","Montserrat","Raleway","Poppins","Inter","Playfair Display","Bebas Neue","Pacifico","Merriweather","Ubuntu","Quicksand","Source Code Pro","IBM Plex Mono","Fira Sans","Oswald","Crimson Text","Nunito","Chakra Petch","JetBrains Mono","Space Mono","Inconsolata","Roboto Mono","Cabin","Work Sans"]),y(o,"fontWeights",{thin:"100",extralight:"200",light:"300",normal:"400",medium:"500",semibold:"600",bold:"700",extrabold:"800",black:"900"}),y(o,"textDecorations",{none:"none",underline:"underline",overline:"overline",lineThrough:"line-through",underlineOverline:"underline overline"});let r=o;class A extends I{constructor(t,e={}){let s="",i={};typeof t=="string"?(s=t,i=e):(i=t||{},s=i.data||"");const{key:n=null,style:l=new r,textAlign:a=O.left,textDirection:c=$.ltr,overflow:d=T.clip,maxLines:g=null,softWrap:f=!0,semanticsLabel:u=null,selectable:p=!1,selectionColor:S=null,onSelectionChanged:m=null}=i;super(n),this.data=s,this.style=l instanceof r?l:new r(l),this.textAlign=a,this.textDirection=c,this.overflow=d,this.maxLines=g,this.softWrap=f,this.semanticsLabel=u,this.selectable=p,this.selectionColor=S||"#b3d9ff",this.onSelectionChanged=m}build(t){const e=this._getInlineStyles(),s=t.element.getElementId(),i=t.element.getWidgetPath(),n={style:e,"data-element-id":s,"data-widget-path":i,"data-identification":t.element.getIdentificationStrategy(),"data-widget":"Text","data-text-align":this.textAlign,"data-overflow":this.overflow,"data-max-lines":this.maxLines,title:this.semanticsLabel||this.data};this.selectable?(n.className+=" fjs-text-selectable",n.style.userSelect="text",n.style.WebkitUserSelect="text",n.style.MozUserSelect="text",this.selectionColor&&(n.style["--selection-color"]=this.selectionColor)):(n.style.userSelect="none",n.style.WebkitUserSelect="none",n.style.MozUserSelect="none");const l={};return this.selectable&&this.onSelectionChanged&&(l.onselectionchange=()=>{const a=window.getSelection?window.getSelection().toString():"";this.onSelectionChanged(a)}),new M({tag:"span",props:n,children:[this.data],key:this.key,events:l})}_getInlineStyles(){const t={display:"inline-block",textAlign:this._mapTextAlign(),direction:this.textDirection===$.rtl?"rtl":"ltr",whiteSpace:this.softWrap?"normal":"nowrap",overflow:this._mapOverflow(),textOverflow:this.overflow===T.ellipsis?"ellipsis":"clip",boxSizing:"border-box"};return this.maxLines===1?(t.overflow="hidden",t.textOverflow="ellipsis",t.whiteSpace="nowrap"):this.maxLines&&this.maxLines>1&&(t.display="-webkit-box",t.WebkitLineClamp=this.maxLines,t.WebkitBoxOrient="vertical",t.overflow="hidden"),this.style&&this.style instanceof r&&Object.assign(t,this.style.toCSSString()),t}_mapTextAlign(){return{left:"left",right:"right",center:"center",justify:"justify",start:"start",end:"end"}[this.textAlign]??"left"}_mapOverflow(){return{clip:"hidden",fade:"hidden",ellipsis:"hidden",visible:"visible"}[this.overflow]??"hidden"}debugFillProperties(t){super.debugFillProperties(t),t.push({name:"data",value:this.data}),t.push({name:"textAlign",value:this.textAlign}),t.push({name:"overflow",value:this.overflow}),t.push({name:"maxLines",value:this.maxLines}),t.push({name:"softWrap",value:this.softWrap}),t.push({name:"selectable",value:this.selectable}),this.style&&this.style instanceof r&&t.push({name:"style",value:this.style.toString()})}}export{A as Text,r as TextStyle};
//# sourceMappingURL=text.js.map
