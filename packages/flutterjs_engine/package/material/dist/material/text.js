var F=Object.defineProperty;var O=(h,t,e)=>t in h?F(h,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):h[t]=e;var p=(h,t,e)=>(O(h,typeof t!="symbol"?t+"":t,e),e);import{StatelessWidget as I}from"../core/widget_element.js";import{VNode as M}from"@flutterjs/vdom/vnode";import{TextAlign as L,TextOverflow as T,TextDirection as $}from"../utils/utils.js";const i=class i{constructor({color:t="#000000",fontSize:e=14,fontWeight:s="400",fontStyle:n="normal",fontFamily:o="Roboto",height:l=1.5,letterSpacing:a=0,wordSpacing:c=0,decoration:d="none",decorationColor:g=null,decorationStyle:f="solid",decorationThickness:u=1,shadows:S=null,backgroundColor:m=null,backgroundOpacity:y=1,googleFont:b=null,fontVariant:w="normal",textTransform:x="none",opacity:k=1,strikethrough:v=!1,underline:W=!1,overline:C=!1,gradient:z=null}={}){this.color=t,this.fontSize=e,this.fontWeight=s,this.fontStyle=n,this.fontFamily=o,this.height=l,this.letterSpacing=a,this.wordSpacing=c,this.decoration=d,this.decorationColor=g,this.decorationStyle=f,this.decorationThickness=u,this.shadows=S,this.backgroundColor=m,this.backgroundOpacity=y,this.googleFont=b,this.fontVariant=w,this.textTransform=x,this.opacity=k,this.strikethrough=v,this.underline=W,this.overline=C,this.gradient=z,this.googleFont&&this._loadGoogleFont(this.googleFont)}_loadGoogleFont(t){if(typeof document>"u")return;const e=t.replace(/\s+/g,"+"),s=`google-font-${t.replace(/\s+/g,"-")}`;if(document.getElementById(s))return;const n=document.createElement("link");n.id=s,n.href=`https://fonts.googleapis.com/css2?family=${e}:wght@100;200;300;400;500;600;700;800;900&display=swap`,n.rel="stylesheet",n.crossOrigin="anonymous",document.head.appendChild(n)}copyWith({color:t,fontSize:e,fontWeight:s,fontStyle:n,fontFamily:o,height:l,letterSpacing:a,wordSpacing:c,decoration:d,decorationColor:g,decorationStyle:f,decorationThickness:u,shadows:S,backgroundColor:m,backgroundOpacity:y,googleFont:b,fontVariant:w,textTransform:x,opacity:k,strikethrough:v,underline:W,overline:C,gradient:z}={}){return new i({color:t??this.color,fontSize:e??this.fontSize,fontWeight:s??this.fontWeight,fontStyle:n??this.fontStyle,fontFamily:o??this.fontFamily,height:l??this.height,letterSpacing:a??this.letterSpacing,wordSpacing:c??this.wordSpacing,decoration:d??this.decoration,decorationColor:g??this.decorationColor,decorationStyle:f??this.decorationStyle,decorationThickness:u??this.decorationThickness,shadows:S??this.shadows,backgroundColor:m??this.backgroundColor,backgroundOpacity:y??this.backgroundOpacity,googleFont:b??this.googleFont,fontVariant:w??this.fontVariant,textTransform:x??this.textTransform,opacity:k??this.opacity,strikethrough:v??this.strikethrough,underline:W??this.underline,overline:C??this.overline,gradient:z??this.gradient})}merge(t){return t?this.copyWith(t):this}_buildTextDecoration(){const t=[];return this.underline&&t.push("underline"),this.overline&&t.push("overline"),this.strikethrough&&t.push("line-through"),t.length>0?t.join(" "):this.decoration}_buildTextShadow(){return!this.shadows||!Array.isArray(this.shadows)?"none":this.shadows.map(t=>{const e=t.offsetX??0,s=t.offsetY??0,n=t.blurRadius??0,o=t.color??"rgba(0,0,0,0.3)";return`${e}px ${s}px ${n}px ${o}`}).join(", ")}_buildBackground(){if(this.gradient)return this.gradient;if(!this.backgroundColor)return"transparent";if(this.backgroundOpacity<1){const t=this._hexToRgb(this.backgroundColor);return t?`rgba(${t.r}, ${t.g}, ${t.b}, ${this.backgroundOpacity})`:this.backgroundColor}return this.backgroundColor}_hexToRgb(t){const e=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t);return e?{r:parseInt(e[1],16),g:parseInt(e[2],16),b:parseInt(e[3],16)}:null}toCSSString(){const t=this._buildTextDecoration();return{color:this.color,fontSize:`${this.fontSize}px`,fontWeight:this.fontWeight,fontStyle:this.fontStyle,fontFamily:this.fontFamily,lineHeight:this.height,letterSpacing:`${this.letterSpacing}px`,wordSpacing:`${this.wordSpacing}px`,textDecoration:t,textDecorationColor:this.decorationColor||"currentColor",textDecorationStyle:this.decorationStyle,textDecorationThickness:`${this.decorationThickness}px`,backgroundColor:this._buildBackground(),fontVariant:this.fontVariant,textTransform:this.textTransform,opacity:this.opacity,textShadow:this._buildTextShadow()}}toCSSObject(){return this.toCSSString()}toFlutterString(){return`TextStyle(color: ${this.color}, size: ${this.fontSize}, family: ${this.fontFamily}, weight: ${this.fontWeight})`}toString(){return`TextStyle(color: ${this.color}, size: ${this.fontSize}px, family: ${this.fontFamily}, weight: ${this.fontWeight})`}};p(i,"preset",{h1:new i({fontSize:32,fontWeight:"700",height:1.2}),h2:new i({fontSize:28,fontWeight:"700",height:1.3}),h3:new i({fontSize:24,fontWeight:"600",height:1.4}),h4:new i({fontSize:20,fontWeight:"600",height:1.4}),h5:new i({fontSize:16,fontWeight:"600",height:1.5}),h6:new i({fontSize:14,fontWeight:"600",height:1.5}),body1:new i({fontSize:16,fontWeight:"400",height:1.5}),body2:new i({fontSize:14,fontWeight:"400",height:1.5}),caption:new i({fontSize:12,fontWeight:"400",height:1.4,opacity:.7}),button:new i({fontSize:14,fontWeight:"600",textTransform:"uppercase"}),code:new i({fontSize:13,fontFamily:"monospace",fontWeight:"400"})}),p(i,"availableGoogleFonts",["Roboto","Open Sans","Lato","Montserrat","Raleway","Poppins","Inter","Playfair Display","Bebas Neue","Pacifico","Merriweather","Ubuntu","Quicksand","Source Code Pro","IBM Plex Mono","Fira Sans","Oswald","Crimson Text","Nunito","Chakra Petch","JetBrains Mono","Space Mono","Inconsolata","Roboto Mono","Cabin","Work Sans"]),p(i,"fontWeights",{thin:"100",extralight:"200",light:"300",normal:"400",medium:"500",semibold:"600",bold:"700",extrabold:"800",black:"900"}),p(i,"textDecorations",{none:"none",underline:"underline",overline:"overline",lineThrough:"line-through",underlineOverline:"underline overline"});let r=i;class A extends I{constructor({key:t=null,data:e="",style:s=new r,textAlign:n=L.left,textDirection:o=$.ltr,overflow:l=T.clip,maxLines:a=null,softWrap:c=!0,semanticsLabel:d=null,selectable:g=!1,selectionColor:f=null,onSelectionChanged:u=null}={}){super(t),this.data=e,this.style=s instanceof r?s:new r(s),this.textAlign=n,this.textDirection=o,this.overflow=l,this.maxLines=a,this.softWrap=c,this.semanticsLabel=d,this.selectable=g,this.selectionColor=f||"#b3d9ff",this.onSelectionChanged=u}build(t){const e=this._getInlineStyles(),s=t.element.getElementId(),n=t.element.getWidgetPath(),o={className:"fjs-text",style:e,"data-element-id":s,"data-widget-path":n,"data-identification":t.element.getIdentificationStrategy(),"data-widget":"Text","data-text-align":this.textAlign,"data-overflow":this.overflow,"data-max-lines":this.maxLines,title:this.semanticsLabel||this.data};this.selectable?(o.className+=" fjs-text-selectable",o.style.userSelect="text",o.style.WebkitUserSelect="text",o.style.MozUserSelect="text",this.selectionColor&&(o.style["--selection-color"]=this.selectionColor)):(o.style.userSelect="none",o.style.WebkitUserSelect="none",o.style.MozUserSelect="none");const l={};return this.selectable&&this.onSelectionChanged&&(l.onselectionchange=()=>{const a=window.getSelection?window.getSelection().toString():"";this.onSelectionChanged(a)}),new M({tag:"span",props:o,children:[this.data],key:this.key,events:l})}_getInlineStyles(){const t={display:"inline-block",textAlign:this._mapTextAlign(),direction:this.textDirection===$.rtl?"rtl":"ltr",whiteSpace:this.softWrap?"normal":"nowrap",overflow:this._mapOverflow(),textOverflow:this.overflow===T.ellipsis?"ellipsis":"clip",boxSizing:"border-box"};return this.maxLines===1?(t.overflow="hidden",t.textOverflow="ellipsis",t.whiteSpace="nowrap"):this.maxLines&&this.maxLines>1&&(t.display="-webkit-box",t.WebkitLineClamp=this.maxLines,t.WebkitBoxOrient="vertical",t.overflow="hidden"),this.style&&this.style instanceof r&&Object.assign(t,this.style.toCSSString()),t}_mapTextAlign(){return{left:"left",right:"right",center:"center",justify:"justify",start:"start",end:"end"}[this.textAlign]??"left"}_mapOverflow(){return{clip:"hidden",fade:"hidden",ellipsis:"hidden",visible:"visible"}[this.overflow]??"hidden"}debugFillProperties(t){super.debugFillProperties(t),t.push({name:"data",value:this.data}),t.push({name:"textAlign",value:this.textAlign}),t.push({name:"overflow",value:this.overflow}),t.push({name:"maxLines",value:this.maxLines}),t.push({name:"softWrap",value:this.softWrap}),t.push({name:"selectable",value:this.selectable}),this.style&&this.style instanceof r&&t.push({name:"style",value:this.style.toString()})}}export{A as Text,r as TextStyle};
//# sourceMappingURL=text.js.map
