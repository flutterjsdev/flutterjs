import{StatelessWidget as b,Element as x}from"../core/widget_element.js";import{VNode as C}from"@flutterjs/vdom/vnode";import{TapRecognizer as s,LongPressRecognizer as y,SwipeRecognizer as I,PanRecognizer as q,ScaleRecognizer as F}from"@flutterjs/runtime";class G extends b{constructor({key:n=null,child:t=null,onTap:e=null,onTapDown:o=null,onTapUp:i=null,onTapCancel:l=null,onDoubleTap:u=null,onLongPress:r=null,onLongPressStart:c=null,onLongPressMoveUpdate:p=null,onLongPressEnd:d=null,onLongPressUp:S=null,onSwipe:f=null,onSwipeLeft:g=null,onSwipeRight:m=null,onSwipeUp:w=null,onSwipeDown:T=null,onPan:E=null,onPanStart:P=null,onPanUpdate:v=null,onPanEnd:_=null,onScale:D=null,onScaleStart:z=null,onScaleUpdate:U=null,onScaleEnd:M=null,behavior:L="opaque",excludeFromSemantics:R=!1}={}){super(n),this.child=t,this.onTap=e,this.onTapDown=o,this.onTapUp=i,this.onTapCancel=l,this.onDoubleTap=u,this.onLongPress=r,this.onLongPressStart=c,this.onLongPressMoveUpdate=p,this.onLongPressEnd=d,this.onLongPressUp=S,this.onSwipe=f,this.onSwipeLeft=g,this.onSwipeRight=m,this.onSwipeUp=w,this.onSwipeDown=T,this.onPan=E,this.onPanStart=P,this.onPanUpdate=v,this.onPanEnd=_,this.onScale=D,this.onScaleStart=z,this.onScaleUpdate=U,this.onScaleEnd=M,this.behavior=L,this.excludeFromSemantics=R,this.recognizers=[],this._elementId=null}build(n){this._elementId=n.element.getElementId();let t=null;if(this.child){const i=this.child.createElement?.()||this.child;i.mount&&i.mount(n.element),t=i.performRebuild?.()||null}const e={position:"relative",userSelect:this.behavior==="opaque"?"none":"auto",WebkitUserSelect:this.behavior==="opaque"?"none":"auto",MozUserSelect:this.behavior==="opaque"?"none":"auto",msUserSelect:this.behavior==="opaque"?"none":"auto",touchAction:"manipulation",cursor:"pointer"},o=this._elementId;return new C({tag:"div",props:{style:e,"data-widget":"GestureDetector","data-element-id":o,onMouseDown:i=>this._handleMouseDown(i,o),onMouseUp:i=>this._handleMouseUp(i,o),onMouseMove:i=>this._handleMouseMove(i,o),onMouseLeave:i=>this._handleMouseLeave(i,o),onTouchStart:i=>this._handleTouchStart(i,o),onTouchEnd:i=>this._handleTouchEnd(i,o),onTouchMove:i=>this._handleTouchMove(i,o),onTouchCancel:i=>this._handleTouchCancel(i,o),onContextMenu:i=>this._handleContextMenu(i,o)},children:t?[t]:[]})}_initializeRecognizers(n){if(!(this.recognizers.length>0)){if(this.onTap||this.onTapDown||this.onTapUp){const t=new s(e=>{this.onTap&&this.onTap(e),this.onTapUp&&this.onTapUp(e)},{maxDuration:300,maxMovement:10});this.recognizers.push(t)}if(this.onDoubleTap){const t=new s(e=>{e.tapCount===2&&this.onDoubleTap(e)},{minTaps:2,maxTaps:2});this.recognizers.push(t)}if(this.onLongPress||this.onLongPressStart||this.onLongPressEnd){const t=new y(e=>{this.onLongPress&&this.onLongPress(e)},{duration:500,maxMovement:10});this.recognizers.push(t)}if(this.onSwipe||this.onSwipeLeft||this.onSwipeRight||this.onSwipeUp||this.onSwipeDown){const t=new I(e=>{this.onSwipe&&this.onSwipe(e),e.direction==="left"&&this.onSwipeLeft?this.onSwipeLeft(e):e.direction==="right"&&this.onSwipeRight?this.onSwipeRight(e):e.direction==="up"&&this.onSwipeUp?this.onSwipeUp(e):e.direction==="down"&&this.onSwipeDown&&this.onSwipeDown(e)},{minDistance:50,maxDuration:300});this.recognizers.push(t)}if(this.onPan||this.onPanStart||this.onPanUpdate||this.onPanEnd){const t=new q(e=>{this.onPan&&this.onPan(e)},{minDistance:10,onStart:e=>{this.onPanStart&&this.onPanStart(e)},onUpdate:e=>{this.onPanUpdate&&this.onPanUpdate(e)},onEnd:e=>{this.onPanEnd&&this.onPanEnd(e)}});this.recognizers.push(t)}if(this.onScale||this.onScaleStart||this.onScaleUpdate||this.onScaleEnd){const t=new F(e=>{this.onScale&&this.onScale(e)},{minScale:.5,maxScale:2,onStart:e=>{this.onScaleStart&&this.onScaleStart(e)},onUpdate:e=>{this.onScaleUpdate&&this.onScaleUpdate(e)},onEnd:e=>{this.onScaleEnd&&this.onScaleEnd(e)}});this.recognizers.push(t)}}}_routeEvent(n,t,e){this._initializeRecognizers(e),this.recognizers.forEach(o=>{o.isDisposed||o.handleEvent(n,t)})}_handleMouseDown(n,t){this._routeEvent("mousedown",n,t),this.onTapDown&&this.onTapDown({type:"tapdown",position:{x:n.clientX,y:n.clientY},nativeEvent:n})}_handleMouseUp(n,t){this._routeEvent("mouseup",n,t)}_handleMouseMove(n,t){this._routeEvent("mousemove",n,t)}_handleMouseLeave(n,t){this.onTapCancel&&this.onTapCancel({type:"tapcancel",nativeEvent:n})}_handleTouchStart(n,t){if(this._routeEvent("touchstart",n,t),this.onTapDown){const e=n.touches[0];this.onTapDown({type:"tapdown",position:{x:e.clientX,y:e.clientY},nativeEvent:n})}}_handleTouchEnd(n,t){this._routeEvent("touchend",n,t)}_handleTouchMove(n,t){this._routeEvent("touchmove",n,t)}_handleTouchCancel(n,t){this._routeEvent("touchcancel",n,t),this.onTapCancel&&this.onTapCancel({type:"tapcancel",nativeEvent:n})}_handleContextMenu(n,t){this.onLongPress&&(n.preventDefault(),this._routeEvent("contextmenu",n,t))}dispose(){this.recognizers.forEach(n=>{n.dispose()}),this.recognizers=[]}createElement(n,t){return new h(this,n,t)}debugFillProperties(n){super.debugFillProperties(n),this.onTap&&n.push({name:"onTap",value:"fn"}),this.onDoubleTap&&n.push({name:"onDoubleTap",value:"fn"}),this.onLongPress&&n.push({name:"onLongPress",value:"fn"}),this.onSwipe&&n.push({name:"onSwipe",value:"fn"}),this.onPan&&n.push({name:"onPan",value:"fn"})}}class h extends x{performRebuild(){return this.widget.build(this.context)}unmount(){this.widget&&this.widget.dispose(),super.unmount()}}export{G as GestureDetector,h as GestureDetectorElement};
//# sourceMappingURL=gesture_detector.js.map
