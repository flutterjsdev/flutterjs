class r{constructor(e,t,i=null){if(!e)throw new Error("Element is required for BuildContext");if(!t)throw new Error("Runtime is required for BuildContext");this._element=e,this._runtime=t,this._state=i,this._inheritedCache=new Map,this._visited=new Set,this._dependencies=new Set}get widget(){return this._element?this._element.widget:null}get state(){return this._state}get element(){return this._element}get mounted(){return this._element?this._element.mounted:!1}findAncestorWidgetOfExactType(e){if(!e)throw new Error("Widget type is required");let t=this._element.parent;for(;t;){const i=t.widget;if(i&&i.constructor===e)return i;t=t.parent}return null}findAncestorWidgetOfType(e){return this.findAncestorWidgetOfExactType(e)}findAncestorStateOfType(e){if(!e)throw new Error("State type is required");let t=this._element.parent;for(;t;){if(t.state&&t.state.constructor===e)return t.state;t=t.parent}return null}findRenderObject(){let e=this._element.parent;for(;e;){if(e.domNode)return e.domNode;e=e.parent}return null}dependOnInheritedWidgetOfExactType(e){if(!e)throw new Error("InheritedWidget type is required");const t=this._inheritedCache.get(e);if(t!==void 0)return t;let i=this._element.parent;for(;i;){if(this._isInheritedElement(i)){const n=i.widget;if(n&&n.constructor===e)return i.addDependent&&i.addDependent(this._element),this._inheritedCache.set(e,n),this._dependencies.add(i),n}i=i.parent}return this._inheritedCache.set(e,null),null}theme(){const e=this.dependOnInheritedWidgetOfExactType(this._getThemeClass());return e?e.data:null}mediaQuery(){const e=this.dependOnInheritedWidgetOfExactType(this._getMediaQueryClass());return e?e.data:null}navigator(){return this.getService("navigator")}getService(e){if(!e)throw new Error("Service name is required");return!this._runtime||!this._runtime.serviceRegistry?null:this._runtime.serviceRegistry.get(e)||null}visitAncestorElements(e){if(typeof e!="function")throw new Error("Visitor must be a function");let t=this._element.parent;for(;t&&e(t)!==!1;)t=t.parent}get size(){const e=this._element?this._element.domNode:null;return e?{width:e.offsetWidth,height:e.offsetHeight}:null}get position(){const e=this._element?this._element.domNode:null;return e?{x:e.offsetLeft,y:e.offsetTop}:null}get bounds(){const e=this.size,t=this.position;return!e||!t?null:{x:t.x,y:t.y,width:e.width,height:e.height}}dispatch(e,t){if(!e)throw new Error("Event name is required");this._element&&this._element.dispatch&&this._element.dispatch(e,t)}getDependencyInfo(){return{dependenciesCount:this._dependencies.size,cachedInheritedWidgets:this._inheritedCache.size,inheritedWidgetTypes:Array.from(this._inheritedCache.keys()).map(e=>e.name)}}_isInheritedElement(e){return e?e.dependents!==void 0:!1}_getThemeClass(){return this._runtime&&this._runtime._ThemeClass?this._runtime._ThemeClass:class{}}_getMediaQueryClass(){return this._runtime&&this._runtime._MediaQueryClass?this._runtime._MediaQueryClass:class{}}_clearCache(){this._inheritedCache.clear(),this._dependencies.clear(),this._visited.clear()}dispose(){this._clearCache(),this._element=null,this._runtime=null,this._state=null}getInfo(){return{mounted:this.mounted,widgetType:this.widget?this.widget.constructor.name:null,stateType:this.state?this.state.constructor.name:null,elementId:this._element?this._element.id:null,elementDepth:this._element?this._element.depth:null,size:this.size,position:this.position,dependencies:this.getDependencyInfo()}}}export{r as BuildContext};
//# sourceMappingURL=build_context.js.map
