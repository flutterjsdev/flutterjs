import{VNode as r}from"./vnode.js";import{StyleConverter as c}from"./style_converter.js";import{StatelessElement as h,StatefulElement as f}from"@flutterjs/runtime/element";import{InheritedElement as m}from"@flutterjs/runtime/inherited_element";class b{constructor(t={}){this.debugMode=t.debugMode||!1,this.runtime=t.runtime,this.debugMode&&!this.runtime&&console.warn("[VNodeBuilder] No runtime provided - Element creation may fail")}build(t,e={}){if(!t)return null;if(t&&typeof t=="object"&&t.tag||typeof t=="string")return t;if(typeof t=="number")return String(t);if(typeof t.build=="function"&&!t.createState){this.debugMode&&console.log("[VNodeBuilder] \u{1F4E6} Building StatelessWidget...");const o=new h(t,e.parentElement||null,this.runtime).build();return o?this.build(o,e):null}if(typeof t.createState=="function"){this.debugMode&&console.log("[VNodeBuilder] \u{1F4E6} Building StatefulWidget...");const s=new f(t,e.parentElement||null,this.runtime);s.mount();const o=s.build();return o?this.build(o,{...e,parentElement:s}):null}if(t.updateShouldNotify&&typeof t.updateShouldNotify=="function"){this.debugMode&&console.log("[VNodeBuilder] \u{1F4E6} Building InheritedWidget...");const s=new m(t,e.parentElement||null,this.runtime),o=s.build();if(o&&t.child){const i=this.build(t.child,{...e,parentElement:s});if(i)return this.build(i,e)}return o}switch(this.getWidgetType(t)){case"Text":return this.buildText(t,e);case"RichText":return this.buildRichText(t,e);case"Container":return this.buildContainer(t,e);case"Column":return this.buildColumn(t,e);case"Row":return this.buildRow(t,e);case"Stack":return this.buildStack(t,e);case"Center":return this.buildCenter(t,e);case"Align":return this.buildAlign(t,e);case"Padding":return this.buildPadding(t,e);case"SizedBox":return this.buildSizedBox(t,e);case"Expanded":return this.buildExpanded(t,e);case"Flexible":return this.buildFlexible(t,e);case"Scaffold":return this.buildScaffold(t,e);case"AppBar":return this.buildAppBar(t,e);case"FloatingActionButton":return this.buildFloatingActionButton(t,e);case"Drawer":return this.buildDrawer(t,e);case"ElevatedButton":case"TextButton":case"OutlinedButton":case"IconButton":return this.buildButton(t,e);case"TextField":return this.buildTextField(t,e);case"Checkbox":return this.buildCheckbox(t,e);case"Radio":return this.buildRadio(t,e);case"Switch":return this.buildSwitch(t,e);case"ListView":return this.buildListView(t,e);case"GridView":return this.buildGridView(t,e);case"ListTile":return this.buildListTile(t,e);case"Card":return this.buildCard(t,e);case"Divider":return this.buildDivider(t,e);case"Icon":return this.buildIcon(t,e);case"Image":return this.buildImage(t,e);case"CircleAvatar":return this.buildCircleAvatar(t,e);case"MaterialApp":return this.buildMaterialApp(t,e);case"Navigator":return this.buildNavigator(t,e);default:return this.buildGeneric(t,e)}}buildChildren(t,e){return t?(Array.isArray(t)||(t=[t]),t.map((n,s)=>this.build(n,{...e,childIndex:s})).filter(n=>n!=null)):[]}getWidgetType(t){return t?t.constructor&&t.constructor.name?t.constructor.name:t.runtimeType?t.runtimeType:t.widget&&t.widget.constructor?t.widget.constructor.name:"Unknown":"Unknown"}extractCommonProps(t){const e={};return t.key&&(e.key=t.key),t._debugLabel&&(e["data-debug-label"]=t._debugLabel),e}buildText(t,e){const n=t.style||{},s=t.data||"";return new r({tag:"span",props:{className:"fjs-text",...this.extractCommonProps(t)},style:c.textStyleToCss(n),children:[String(s)],metadata:{widgetType:"Text",flutterProps:{data:s,style:n}}})}buildRichText(t,e){return new r({tag:"span",props:{className:"fjs-rich-text"},children:[t.text||""],metadata:{widgetType:"RichText"}})}buildContainer(t,e){const n=t.child?this.build(t.child,e):null,s=t.decoration||{},o=t.padding,i=t.margin,l=t.color,a=t.width,u=t.height,p=t.alignment,d={...c.decorationToCss(s),...c.paddingToCss(o),...c.marginToCss(i),...c.alignmentToCss(p)};return l&&(d.backgroundColor=c.colorToCss(l)),a!==void 0&&(d.width=typeof a=="number"?`${a}px`:a),u!==void 0&&(d.height=typeof u=="number"?`${u}px`:u),new r({tag:"div",props:{className:"fjs-container",...this.extractCommonProps(t)},style:d,children:n?[n]:[],metadata:{widgetType:"Container",flutterProps:{decoration:s,padding:o,margin:i,color:l,width:a,height:u}}})}buildColumn(t,e){const n=this.buildChildren(t.children,e),s=t.mainAxisAlignment||"start",o=t.crossAxisAlignment||"center",i=t.mainAxisSize||"max",l={display:"flex",flexDirection:"column",justifyContent:c.mainAxisAlignmentToCss(s),alignItems:c.crossAxisAlignmentToCss(o,"column")};return i==="min"&&(l.height="auto"),new r({tag:"div",props:{className:"fjs-column",...this.extractCommonProps(t)},style:l,children:n,metadata:{widgetType:"Column",flutterProps:{mainAxisAlignment:s,crossAxisAlignment:o,mainAxisSize:i}}})}buildRow(t,e){const n=this.buildChildren(t.children,e),s=t.mainAxisAlignment||"start",o=t.crossAxisAlignment||"center",i=t.mainAxisSize||"max",l={display:"flex",flexDirection:"row",justifyContent:c.mainAxisAlignmentToCss(s),alignItems:c.crossAxisAlignmentToCss(o,"row")};return i==="min"&&(l.width="auto"),new r({tag:"div",props:{className:"fjs-row",...this.extractCommonProps(t)},style:l,children:n,metadata:{widgetType:"Row",flutterProps:{mainAxisAlignment:s,crossAxisAlignment:o,mainAxisSize:i}}})}buildStack(t,e){const n=this.buildChildren(t.children,e),s=t.alignment||"topLeft";return new r({tag:"div",props:{className:"fjs-stack",...this.extractCommonProps(t)},style:{position:"relative",...c.alignmentToCss(s)},children:n.map(o=>new r({tag:"div",style:{position:"absolute"},children:[o]})),metadata:{widgetType:"Stack"}})}buildCenter(t,e){const n=t.child?this.build(t.child,e):null;return new r({tag:"div",props:{className:"fjs-center",...this.extractCommonProps(t)},style:{display:"flex",justifyContent:"center",alignItems:"center"},children:n?[n]:[],metadata:{widgetType:"Center"}})}buildAlign(t,e){const n=t.child?this.build(t.child,e):null,s=t.alignment||"center";return new r({tag:"div",props:{className:"fjs-align",...this.extractCommonProps(t)},style:{display:"flex",...c.alignmentToCss(s)},children:n?[n]:[],metadata:{widgetType:"Align",flutterProps:{alignment:s}}})}buildPadding(t,e){const n=t.child?this.build(t.child,e):null,s=t.padding;return new r({tag:"div",props:{className:"fjs-padding",...this.extractCommonProps(t)},style:c.paddingToCss(s),children:n?[n]:[],metadata:{widgetType:"Padding",flutterProps:{padding:s}}})}buildSizedBox(t,e){const n=t.child?this.build(t.child,e):null,s=t.width,o=t.height,i={};return s!==void 0&&(i.width=typeof s=="number"?`${s}px`:s),o!==void 0&&(i.height=typeof o=="number"?`${o}px`:o),new r({tag:"div",props:{className:"fjs-sized-box",...this.extractCommonProps(t)},style:i,children:n?[n]:[],metadata:{widgetType:"SizedBox",flutterProps:{width:s,height:o}}})}buildExpanded(t,e){const n=t.child?this.build(t.child,e):null,s=t.flex||1;return new r({tag:"div",props:{className:"fjs-expanded",...this.extractCommonProps(t)},style:{flex:String(s)},children:n?[n]:[],metadata:{widgetType:"Expanded",flutterProps:{flex:s}}})}buildFlexible(t,e){const n=t.child?this.build(t.child,e):null,s=t.flex||1,o=t.fit||"loose",i={flex:o==="tight"?String(s):"0 1 auto"};return new r({tag:"div",props:{className:"fjs-flexible",...this.extractCommonProps(t)},style:i,children:n?[n]:[],metadata:{widgetType:"Flexible",flutterProps:{flex:s,fit:o}}})}buildScaffold(t,e){const n=t.appBar?this.build(t.appBar,e):null,s=t.body?this.build(t.body,e):null,o=t.floatingActionButton?this.build(t.floatingActionButton,e):null,i=t.drawer?this.build(t.drawer,e):null,l=t.backgroundColor,a=[];n&&a.push(n),s&&a.push(new r({tag:"main",props:{className:"fjs-scaffold-body"},style:{flex:"1"},children:[s]})),o&&a.push(o),i&&a.push(i);const u={minHeight:"100vh",display:"flex",flexDirection:"column"};return l&&(u.backgroundColor=c.colorToCss(l)),new r({tag:"div",props:{className:"fjs-scaffold",...this.extractCommonProps(t)},style:u,children:a,metadata:{widgetType:"Scaffold"}})}buildAppBar(t,e){const n=t.title?this.build(t.title,e):null,s=t.leading?this.build(t.leading,e):null,o=t.actions?this.buildChildren(t.actions,e):[],i=t.backgroundColor,l={display:"flex",alignItems:"center",padding:"16px",minHeight:"56px",gap:"16px"};i?l.backgroundColor=c.colorToCss(i):(l.backgroundColor="var(--md-sys-color-primary, #6750a4)",l.color="var(--md-sys-color-on-primary, #ffffff)");const a=[];return s&&a.push(s),n&&a.push(new r({tag:"div",props:{className:"fjs-app-bar-title"},style:{flex:"1"},children:[n]})),o.length>0&&a.push(new r({tag:"div",props:{className:"fjs-app-bar-actions"},style:{display:"flex",gap:"8px"},children:o})),new r({tag:"header",props:{className:"fjs-app-bar",...this.extractCommonProps(t)},style:l,children:a,metadata:{widgetType:"AppBar"}})}buildFloatingActionButton(t,e){const n=t.child?this.build(t.child,e):null,s=t.onPressed,o=t.backgroundColor,i={position:"fixed",bottom:"16px",right:"16px",width:"56px",height:"56px",borderRadius:"50%",border:"none",display:"flex",justifyContent:"center",alignItems:"center",cursor:s?"pointer":"default",boxShadow:"0 4px 8px rgba(0,0,0,0.2)"};o?i.backgroundColor=c.colorToCss(o):(i.backgroundColor="var(--md-sys-color-primary, #6750a4)",i.color="var(--md-sys-color-on-primary, #ffffff)");const l={};return s&&typeof s=="function"&&(l.click=s),new r({tag:"button",props:{className:"fjs-fab",disabled:!s,...this.extractCommonProps(t)},style:i,children:n?[n]:[],events:l,metadata:{widgetType:"FloatingActionButton"}})}buildDrawer(t,e){const n=t.child?this.build(t.child,e):null;return new r({tag:"aside",props:{className:"fjs-drawer",...this.extractCommonProps(t)},style:{position:"fixed",left:"0",top:"0",bottom:"0",width:"280px",backgroundColor:"#ffffff",boxShadow:"2px 0 8px rgba(0,0,0,0.1)",transform:"translateX(-100%)",transition:"transform 0.3s"},children:n?[n]:[],metadata:{widgetType:"Drawer"}})}buildButton(t,e){const n=t.child?this.build(t.child,e):null,s=t.onPressed,o=this.getWidgetType(t),i={padding:"12px 24px",border:"none",borderRadius:"4px",cursor:s?"pointer":"default",fontSize:"14px",fontWeight:"500",transition:"all 0.2s"};o==="ElevatedButton"?(i.backgroundColor="var(--md-sys-color-primary, #6750a4)",i.color="var(--md-sys-color-on-primary, #ffffff)",i.boxShadow="0 2px 4px rgba(0,0,0,0.2)"):o==="TextButton"?(i.backgroundColor="transparent",i.color="var(--md-sys-color-primary, #6750a4)"):o==="OutlinedButton"?(i.backgroundColor="transparent",i.color="var(--md-sys-color-primary, #6750a4)",i.border="1px solid var(--md-sys-color-outline, #79747e)"):o==="IconButton"&&(i.padding="8px",i.borderRadius="50%",i.backgroundColor="transparent",i.width="40px",i.height="40px",i.display="flex",i.justifyContent="center",i.alignItems="center");const l={};return s&&typeof s=="function"&&(l.click=s),new r({tag:"button",props:{className:`fjs-${o.toLowerCase().replace(/button$/,"-button")}`,disabled:!s,...this.extractCommonProps(t)},style:i,children:n?[n]:[],events:l,metadata:{widgetType:o}})}buildTextField(t,e){const n=t.controller,s=t.decoration||{},o=t.onChanged,i=t.onSubmitted,l=t.obscureText||!1,a={padding:"12px 16px",border:"1px solid var(--md-sys-color-outline, #ccc)",borderRadius:"4px",fontSize:"16px",width:"100%",boxSizing:"border-box"},u={className:"fjs-text-field",type:l?"password":"text",placeholder:s.hintText||"",...this.extractCommonProps(t)};n&&n.text!==void 0&&(u.value=n.text);const p={};return o&&typeof o=="function"&&(p.input=d=>o(d.target.value)),i&&typeof i=="function"&&(p.keypress=d=>{d.key==="Enter"&&i(d.target.value)}),new r({tag:"input",props:u,style:a,events:p,metadata:{widgetType:"TextField",flutterProps:{decoration:s,obscureText:l}}})}buildCheckbox(t,e){const n=t.value||!1,s=t.onChanged,o={};return s&&typeof s=="function"&&(o.change=i=>s(i.target.checked)),new r({tag:"input",props:{type:"checkbox",checked:n,className:"fjs-checkbox",...this.extractCommonProps(t)},style:{width:"20px",height:"20px",cursor:s?"pointer":"default"},events:o,metadata:{widgetType:"Checkbox",flutterProps:{value:n}}})}buildRadio(t,e){const n=t.value,s=t.groupValue,o=t.onChanged,i=n===s,l={};return o&&typeof o=="function"&&(l.change=()=>o(n)),new r({tag:"input",props:{type:"radio",checked:i,className:"fjs-radio",...this.extractCommonProps(t)},style:{width:"20px",height:"20px",cursor:o?"pointer":"default"},events:l,metadata:{widgetType:"Radio",flutterProps:{value:n,groupValue:s}}})}buildSwitch(t,e){const n=t.value||!1,s=t.onChanged,o={};return s&&typeof s=="function"&&(o.change=i=>s(i.target.checked)),new r({tag:"label",props:{className:"fjs-switch"},style:{display:"inline-block",width:"52px",height:"32px",position:"relative"},children:[new r({tag:"input",props:{type:"checkbox",checked:n,style:"display: none;"},events:o}),new r({tag:"span",props:{className:"fjs-switch-slider"},style:{position:"absolute",cursor:"pointer",top:"0",left:"0",right:"0",bottom:"0",backgroundColor:n?"#6750a4":"#ccc",borderRadius:"32px",transition:"0.4s"}})],metadata:{widgetType:"Switch"}})}buildListView(t,e){const n=this.buildChildren(t.children,e);return new r({tag:"div",props:{className:"fjs-list-view",...this.extractCommonProps(t)},style:{overflowY:"auto",display:"flex",flexDirection:"column"},children:n,metadata:{widgetType:"ListView"}})}buildGridView(t,e){const n=this.buildChildren(t.children,e),s=t.crossAxisCount||2;return new r({tag:"div",props:{className:"fjs-grid-view",...this.extractCommonProps(t)},style:{display:"grid",gridTemplateColumns:`repeat(${s}, 1fr)`,gap:"16px"},children:n,metadata:{widgetType:"GridView",flutterProps:{crossAxisCount:s}}})}buildListTile(t,e){const n=t.leading?this.build(t.leading,e):null,s=t.title?this.build(t.title,e):null,o=t.subtitle?this.build(t.subtitle,e):null,i=t.trailing?this.build(t.trailing,e):null,l=t.onTap,a=[];n&&a.push(new r({tag:"div",props:{className:"fjs-list-tile-leading"},children:[n]}));const u=[];s&&u.push(s),o&&u.push(o),u.length>0&&a.push(new r({tag:"div",props:{className:"fjs-list-tile-content"},style:{flex:"1"},children:u})),i&&a.push(new r({tag:"div",props:{className:"fjs-list-tile-trailing"},children:[i]}));const p={};return l&&typeof l=="function"&&(p.click=l),new r({tag:"div",props:{className:"fjs-list-tile",...this.extractCommonProps(t)},style:{display:"flex",alignItems:"center",gap:"16px",padding:"16px",cursor:l?"pointer":"default"},children:a,events:p,metadata:{widgetType:"ListTile"}})}buildCard(t,e){const n=t.child?this.build(t.child,e):null,s=t.elevation||1,o=t.color,i={borderRadius:"12px",overflow:"hidden",boxShadow:`0 ${s*2}px ${s*4}px rgba(0,0,0,0.${Math.min(s*2,3)})`};return o?i.backgroundColor=c.colorToCss(o):i.backgroundColor="#ffffff",new r({tag:"div",props:{className:"fjs-card",...this.extractCommonProps(t)},style:i,children:n?[n]:[],metadata:{widgetType:"Card",flutterProps:{elevation:s}}})}buildDivider(t,e){const n=t.height||1,s=t.thickness||1,o=t.color,i={height:`${n}px`,borderTop:`${s}px solid ${o?c.colorToCss(o):"#e0e0e0"}`,margin:"8px 0"};return new r({tag:"hr",props:{className:"fjs-divider",...this.extractCommonProps(t)},style:i,metadata:{widgetType:"Divider"}})}buildIcon(t,e){const n=t.icon,s=t.size||24,o=t.color,i={width:`${s}px`,height:`${s}px`,display:"inline-block"};return o&&(i.color=c.colorToCss(o)),new r({tag:"span",props:{className:"fjs-icon","data-icon":n,...this.extractCommonProps(t)},style:i,children:["\u2B24"],metadata:{widgetType:"Icon",flutterProps:{icon:n,size:s}}})}buildImage(t,e){const n=t.image?.src||t.src||"",s=t.width,o=t.height,i=t.fit||"contain",l={};s&&(l.width=typeof s=="number"?`${s}px`:s),o&&(l.height=typeof o=="number"?`${o}px`:o);const a={fill:"fill",contain:"contain",cover:"cover",fitWidth:"scale-down",fitHeight:"scale-down",none:"none",scaleDown:"scale-down"};return l.objectFit=a[i]||"contain",new r({tag:"img",props:{src:n,alt:t.semanticLabel||"",className:"fjs-image",...this.extractCommonProps(t)},style:l,metadata:{widgetType:"Image",flutterProps:{src:n,fit:i}}})}buildCircleAvatar(t,e){const n=t.child?this.build(t.child,e):null,s=t.radius||20,o=t.backgroundColor,i={width:`${s*2}px`,height:`${s*2}px`,borderRadius:"50%",display:"flex",justifyContent:"center",alignItems:"center",overflow:"hidden"};return o?i.backgroundColor=c.colorToCss(o):i.backgroundColor="var(--md-sys-color-primary-container, #eaddff)",new r({tag:"div",props:{className:"fjs-circle-avatar",...this.extractCommonProps(t)},style:i,children:n?[n]:[],metadata:{widgetType:"CircleAvatar",flutterProps:{radius:s}}})}buildMaterialApp(t,e){const n=t.home?this.build(t.home,e):null,s=t.title||"";return new r({tag:"div",props:{className:"fjs-material-app","data-title":s,...this.extractCommonProps(t)},style:{minHeight:"100vh",fontFamily:"Roboto, sans-serif"},children:n?[n]:[],metadata:{widgetType:"MaterialApp",flutterProps:{title:s}}})}buildNavigator(t,e){const n=this.buildChildren(t.pages||[],e);return new r({tag:"div",props:{className:"fjs-navigator",...this.extractCommonProps(t)},children:n,metadata:{widgetType:"Navigator"}})}buildGeneric(t,e){let n=[];if(t.child){const o=this.build(t.child,e);o&&(n=[o])}else t.children&&(n=this.buildChildren(t.children,e));const s=this.getWidgetType(t);return new r({tag:"div",props:{className:`fjs-${s.toLowerCase()}`,"data-widget-type":s,...this.extractCommonProps(t)},children:n,metadata:{widgetType:s,note:"Generic widget - no specific builder implemented"}})}}export{b as VNodeBuilder};
//# sourceMappingURL=vnode_builder.js.map
