import{VNode as l}from"./vnode.js";import{StyleConverter as c}from"./style_converter.js";import{StatelessElement as h,StatefulElement as m}from"@flutterjs/runtime/element";import{InheritedElement as f}from"@flutterjs/runtime/inherited_element";class b{constructor(t={}){this.debugMode=t.debugMode||!1,this.runtime=t.runtime,this.debugMode&&!this.runtime&&console.warn("[VNodeBuilder] \u26A0\uFE0F No runtime provided - Element creation will fail")}build(t,r={}){if(!t)return null;if(t&&typeof t=="object"&&t.tag||typeof t=="string")return t;if(typeof t=="number")return String(t);if(!r.runtime&&this.runtime&&(r.runtime=this.runtime),typeof t.build=="function"&&!t.createState){if(this.debugMode&&console.log("[VNodeBuilder] \u{1F4E6} Building StatelessWidget:",t.constructor.name),!this.runtime)throw new Error("[VNodeBuilder] Runtime required to build StatelessWidget");const s=new h(t,r.parentElement||null,this.runtime),i=s.build();return i?this.build(i,{...r,parentElement:s,runtime:this.runtime}):null}if(typeof t.createState=="function"){if(this.debugMode&&console.log("[VNodeBuilder] \u{1F4E6} Building StatefulWidget:",t.constructor.name),!this.runtime)throw new Error("[VNodeBuilder] Runtime required to build StatefulWidget");const s=new m(t,r.parentElement||null,this.runtime);s.mounted||s.mount();const i=s.build();return i?this.build(i,{...r,parentElement:s,runtime:this.runtime}):null}if(t.updateShouldNotify&&typeof t.updateShouldNotify=="function"){if(this.debugMode&&console.log("[VNodeBuilder] \u{1F4E6} Building InheritedWidget:",t.constructor.name),!this.runtime)throw new Error("[VNodeBuilder] Runtime required to build InheritedWidget");const s=new f(t,r.parentElement||null,this.runtime);s.mounted||s.mount();const i=s.build();if(t.child){const o=this.build(t.child,{...r,parentElement:s,runtime:this.runtime});return i&&o&&(i.children||(i.children=[]),i.children.push(o)),i?this.build(i,{...r,runtime:this.runtime}):o}return i?this.build(i,r):null}const e=this.getWidgetType(t);return this.debugMode&&e!=="Unknown"&&console.log("[VNodeBuilder] \u{1F4DD} Building widget type:",e),this.buildWidgetByType(t,e,r)}buildWidgetByType(t,r,e){switch(r){case"Text":return this.buildText(t,e);case"RichText":return this.buildRichText(t,e);case"Container":return this.buildContainer(t,e);case"Column":return this.buildColumn(t,e);case"Row":return this.buildRow(t,e);case"Stack":return this.buildStack(t,e);case"Center":return this.buildCenter(t,e);case"Align":return this.buildAlign(t,e);case"Padding":return this.buildPadding(t,e);case"SizedBox":return this.buildSizedBox(t,e);case"Expanded":return this.buildExpanded(t,e);case"Flexible":return this.buildFlexible(t,e);case"Scaffold":return this.buildScaffold(t,e);case"AppBar":return this.buildAppBar(t,e);case"FloatingActionButton":return this.buildFloatingActionButton(t,e);case"Drawer":return this.buildDrawer(t,e);case"ElevatedButton":case"TextButton":case"OutlinedButton":case"IconButton":return this.buildButton(t,e);case"TextField":return this.buildTextField(t,e);case"Checkbox":return this.buildCheckbox(t,e);case"Radio":return this.buildRadio(t,e);case"Switch":return this.buildSwitch(t,e);case"ListView":return this.buildListView(t,e);case"GridView":return this.buildGridView(t,e);case"ListTile":return this.buildListTile(t,e);case"Card":return this.buildCard(t,e);case"Divider":return this.buildDivider(t,e);case"Icon":return this.buildIcon(t,e);case"Image":return this.buildImage(t,e);case"CircleAvatar":return this.buildCircleAvatar(t,e);case"MaterialApp":return this.buildMaterialApp(t,e);case"Navigator":return this.buildNavigator(t,e);default:return this.buildGeneric(t,e)}}buildChildren(t,r){return t?(Array.isArray(t)||(t=[t]),t.map((e,n)=>this.build(e,{...r,childIndex:n,runtime:this.runtime})).filter(e=>e!=null)):[]}getWidgetType(t){return t?t.constructor&&t.constructor.name?t.constructor.name:t.runtimeType?t.runtimeType:t.widget&&t.widget.constructor?t.widget.constructor.name:"Unknown":"Unknown"}extractCommonProps(t){const r={};return t.key&&(r.key=t.key),t._debugLabel&&(r["data-debug-label"]=t._debugLabel),r}buildText(t,r){const e=t.style||{},n=t.data||"";return new l({tag:"span",props:{className:"fjs-text",...this.extractCommonProps(t)},style:c.textStyleToCss(e),children:[String(n)],metadata:{widgetType:"Text",flutterProps:{data:n,style:e}}})}buildRichText(t,r){return new l({tag:"span",props:{className:"fjs-rich-text"},children:[t.text||""],metadata:{widgetType:"RichText"}})}buildContainer(t,r){const e=t.child?this.build(t.child,r):null,n=t.decoration||{},s=t.padding,i=t.margin,o=t.color,a=t.width,u=t.height,p=t.alignment,d={...c.decorationToCss(n),...c.paddingToCss(s),...c.marginToCss(i),...c.alignmentToCss(p)};return o&&(d.backgroundColor=c.colorToCss(o)),a!==void 0&&(d.width=typeof a=="number"?`${a}px`:a),u!==void 0&&(d.height=typeof u=="number"?`${u}px`:u),new l({tag:"div",props:{className:"fjs-container",...this.extractCommonProps(t)},style:d,children:e?[e]:[],metadata:{widgetType:"Container",flutterProps:{decoration:n,padding:s,margin:i,color:o,width:a,height:u}}})}buildColumn(t,r){const e=this.buildChildren(t.children,r),n=t.mainAxisAlignment||"start",s=t.crossAxisAlignment||"center",i=t.mainAxisSize||"max",o={display:"flex",flexDirection:"column",justifyContent:c.mainAxisAlignmentToCss(n),alignItems:c.crossAxisAlignmentToCss(s,"column")};return i==="min"&&(o.height="auto"),new l({tag:"div",props:{className:"fjs-column",...this.extractCommonProps(t)},style:o,children:e,metadata:{widgetType:"Column",flutterProps:{mainAxisAlignment:n,crossAxisAlignment:s,mainAxisSize:i}}})}buildRow(t,r){const e=this.buildChildren(t.children,r),n=t.mainAxisAlignment||"start",s=t.crossAxisAlignment||"center",i=t.mainAxisSize||"max",o={display:"flex",flexDirection:"row",justifyContent:c.mainAxisAlignmentToCss(n),alignItems:c.crossAxisAlignmentToCss(s,"row")};return i==="min"&&(o.width="auto"),new l({tag:"div",props:{className:"fjs-row",...this.extractCommonProps(t)},style:o,children:e,metadata:{widgetType:"Row",flutterProps:{mainAxisAlignment:n,crossAxisAlignment:s,mainAxisSize:i}}})}buildStack(t,r){const e=this.buildChildren(t.children,r),n=t.alignment||"topLeft";return new l({tag:"div",props:{className:"fjs-stack",...this.extractCommonProps(t)},style:{position:"relative",...c.alignmentToCss(n)},children:e.map(s=>new l({tag:"div",style:{position:"absolute"},children:[s]})),metadata:{widgetType:"Stack"}})}buildCenter(t,r){const e=t.child?this.build(t.child,r):null;return new l({tag:"div",props:{className:"fjs-center",...this.extractCommonProps(t)},style:{display:"flex",justifyContent:"center",alignItems:"center"},children:e?[e]:[],metadata:{widgetType:"Center"}})}buildAlign(t,r){const e=t.child?this.build(t.child,r):null,n=t.alignment||"center";return new l({tag:"div",props:{className:"fjs-align",...this.extractCommonProps(t)},style:{display:"flex",...c.alignmentToCss(n)},children:e?[e]:[],metadata:{widgetType:"Align",flutterProps:{alignment:n}}})}buildPadding(t,r){const e=t.child?this.build(t.child,r):null,n=t.padding;return new l({tag:"div",props:{className:"fjs-padding",...this.extractCommonProps(t)},style:c.paddingToCss(n),children:e?[e]:[],metadata:{widgetType:"Padding",flutterProps:{padding:n}}})}buildSizedBox(t,r){const e=t.child?this.build(t.child,r):null,n=t.width,s=t.height,i={};return n!==void 0&&(i.width=typeof n=="number"?`${n}px`:n),s!==void 0&&(i.height=typeof s=="number"?`${s}px`:s),new l({tag:"div",props:{className:"fjs-sized-box",...this.extractCommonProps(t)},style:i,children:e?[e]:[],metadata:{widgetType:"SizedBox",flutterProps:{width:n,height:s}}})}buildExpanded(t,r){const e=t.child?this.build(t.child,r):null,n=t.flex||1;return new l({tag:"div",props:{className:"fjs-expanded",...this.extractCommonProps(t)},style:{flex:String(n)},children:e?[e]:[],metadata:{widgetType:"Expanded",flutterProps:{flex:n}}})}buildFlexible(t,r){const e=t.child?this.build(t.child,r):null,n=t.flex||1,s=t.fit||"loose",i={flex:s==="tight"?String(n):"0 1 auto"};return new l({tag:"div",props:{className:"fjs-flexible",...this.extractCommonProps(t)},style:i,children:e?[e]:[],metadata:{widgetType:"Flexible",flutterProps:{flex:n,fit:s}}})}buildScaffold(t,r){const e=t.appBar?this.build(t.appBar,r):null,n=t.body?this.build(t.body,r):null,s=t.floatingActionButton?this.build(t.floatingActionButton,r):null,i=t.drawer?this.build(t.drawer,r):null,o=t.backgroundColor,a=[];e&&a.push(e),n&&a.push(new l({tag:"main",props:{className:"fjs-scaffold-body"},style:{flex:"1"},children:[n]})),s&&a.push(s),i&&a.push(i);const u={minHeight:"100vh",display:"flex",flexDirection:"column"};return o&&(u.backgroundColor=c.colorToCss(o)),new l({tag:"div",props:{className:"fjs-scaffold",...this.extractCommonProps(t)},style:u,children:a,metadata:{widgetType:"Scaffold"}})}buildAppBar(t,r){const e=t.title?this.build(t.title,r):null,n=t.leading?this.build(t.leading,r):null,s=t.actions?this.buildChildren(t.actions,r):[],i=t.backgroundColor,o={display:"flex",alignItems:"center",padding:"16px",minHeight:"56px",gap:"16px"};i?o.backgroundColor=c.colorToCss(i):(o.backgroundColor="var(--md-sys-color-primary, #6750a4)",o.color="var(--md-sys-color-on-primary, #ffffff)");const a=[];return n&&a.push(n),e&&a.push(new l({tag:"div",props:{className:"fjs-app-bar-title"},style:{flex:"1"},children:[e]})),s.length>0&&a.push(new l({tag:"div",props:{className:"fjs-app-bar-actions"},style:{display:"flex",gap:"8px"},children:s})),new l({tag:"header",props:{className:"fjs-app-bar",...this.extractCommonProps(t)},style:o,children:a,metadata:{widgetType:"AppBar"}})}buildFloatingActionButton(t,r){const e=t.child?this.build(t.child,r):null,n=t.onPressed,s=t.backgroundColor,i={position:"fixed",bottom:"16px",right:"16px",width:"56px",height:"56px",borderRadius:"50%",border:"none",display:"flex",justifyContent:"center",alignItems:"center",cursor:n?"pointer":"default",boxShadow:"0 4px 8px rgba(0,0,0,0.2)"};s?i.backgroundColor=c.colorToCss(s):(i.backgroundColor="var(--md-sys-color-primary, #6750a4)",i.color="var(--md-sys-color-on-primary, #ffffff)");const o={};return n&&typeof n=="function"&&(o.click=n),new l({tag:"button",props:{className:"fjs-fab",disabled:!n,...this.extractCommonProps(t)},style:i,children:e?[e]:[],events:o,metadata:{widgetType:"FloatingActionButton"}})}buildDrawer(t,r){const e=t.child?this.build(t.child,r):null;return new l({tag:"aside",props:{className:"fjs-drawer",...this.extractCommonProps(t)},style:{position:"fixed",left:"0",top:"0",bottom:"0",width:"280px",backgroundColor:"#ffffff",boxShadow:"2px 0 8px rgba(0,0,0,0.1)",transform:"translateX(-100%)",transition:"transform 0.3s"},children:e?[e]:[],metadata:{widgetType:"Drawer"}})}buildButton(t,r){const e=t.child?this.build(t.child,r):null,n=t.onPressed,s=this.getWidgetType(t),i={padding:"12px 24px",border:"none",borderRadius:"4px",cursor:n?"pointer":"default",fontSize:"14px",fontWeight:"500",transition:"all 0.2s"};s==="ElevatedButton"?(i.backgroundColor="var(--md-sys-color-primary, #6750a4)",i.color="var(--md-sys-color-on-primary, #ffffff)",i.boxShadow="0 2px 4px rgba(0,0,0,0.2)"):s==="TextButton"?(i.backgroundColor="transparent",i.color="var(--md-sys-color-primary, #6750a4)"):s==="OutlinedButton"?(i.backgroundColor="transparent",i.color="var(--md-sys-color-primary, #6750a4)",i.border="1px solid var(--md-sys-color-outline, #79747e)"):s==="IconButton"&&(i.padding="8px",i.borderRadius="50%",i.backgroundColor="transparent",i.width="40px",i.height="40px",i.display="flex",i.justifyContent="center",i.alignItems="center");const o={};return n&&typeof n=="function"&&(o.click=n),new l({tag:"button",props:{className:`fjs-${s.toLowerCase().replace(/button$/,"-button")}`,disabled:!n,...this.extractCommonProps(t)},style:i,children:e?[e]:[],events:o,metadata:{widgetType:s}})}buildTextField(t,r){const e=t.controller,n=t.decoration||{},s=t.onChanged,i=t.onSubmitted,o=t.obscureText||!1,a={padding:"12px 16px",border:"1px solid var(--md-sys-color-outline, #ccc)",borderRadius:"4px",fontSize:"16px",width:"100%",boxSizing:"border-box"},u={className:"fjs-text-field",type:o?"password":"text",placeholder:n.hintText||"",...this.extractCommonProps(t)};e&&e.text!==void 0&&(u.value=e.text);const p={};return s&&typeof s=="function"&&(p.input=d=>s(d.target.value)),i&&typeof i=="function"&&(p.keypress=d=>{d.key==="Enter"&&i(d.target.value)}),new l({tag:"input",props:u,style:a,events:p,metadata:{widgetType:"TextField",flutterProps:{decoration:n,obscureText:o}}})}buildCheckbox(t,r){const e=t.value||!1,n=t.onChanged,s={};return n&&typeof n=="function"&&(s.change=i=>n(i.target.checked)),new l({tag:"input",props:{type:"checkbox",checked:e,className:"fjs-checkbox",...this.extractCommonProps(t)},style:{width:"20px",height:"20px",cursor:n?"pointer":"default"},events:s,metadata:{widgetType:"Checkbox",flutterProps:{value:e}}})}buildRadio(t,r){const e=t.value,n=t.groupValue,s=t.onChanged,i=e===n,o={};return s&&typeof s=="function"&&(o.change=()=>s(e)),new l({tag:"input",props:{type:"radio",checked:i,className:"fjs-radio",...this.extractCommonProps(t)},style:{width:"20px",height:"20px",cursor:s?"pointer":"default"},events:o,metadata:{widgetType:"Radio",flutterProps:{value:e,groupValue:n}}})}buildSwitch(t,r){const e=t.value||!1,n=t.onChanged,s={};return n&&typeof n=="function"&&(s.change=i=>n(i.target.checked)),new l({tag:"label",props:{className:"fjs-switch"},style:{display:"inline-block",width:"52px",height:"32px",position:"relative"},children:[new l({tag:"input",props:{type:"checkbox",checked:e,style:"display: none;"},events:s}),new l({tag:"span",props:{className:"fjs-switch-slider"},style:{position:"absolute",cursor:"pointer",top:"0",left:"0",right:"0",bottom:"0",backgroundColor:e?"#6750a4":"#ccc",borderRadius:"32px",transition:"0.4s"}})],metadata:{widgetType:"Switch"}})}buildListView(t,r){const e=this.buildChildren(t.children,r);return new l({tag:"div",props:{className:"fjs-list-view",...this.extractCommonProps(t)},style:{overflowY:"auto",display:"flex",flexDirection:"column"},children:e,metadata:{widgetType:"ListView"}})}buildGridView(t,r){const e=this.buildChildren(t.children,r),n=t.crossAxisCount||2;return new l({tag:"div",props:{className:"fjs-grid-view",...this.extractCommonProps(t)},style:{display:"grid",gridTemplateColumns:`repeat(${n}, 1fr)`,gap:"16px"},children:e,metadata:{widgetType:"GridView",flutterProps:{crossAxisCount:n}}})}buildListTile(t,r){const e=t.leading?this.build(t.leading,r):null,n=t.title?this.build(t.title,r):null,s=t.subtitle?this.build(t.subtitle,r):null,i=t.trailing?this.build(t.trailing,r):null,o=t.onTap,a=[];e&&a.push(new l({tag:"div",props:{className:"fjs-list-tile-leading"},children:[e]}));const u=[];n&&u.push(n),s&&u.push(s),u.length>0&&a.push(new l({tag:"div",props:{className:"fjs-list-tile-content"},style:{flex:"1"},children:u})),i&&a.push(new l({tag:"div",props:{className:"fjs-list-tile-trailing"},children:[i]}));const p={};return o&&typeof o=="function"&&(p.click=o),new l({tag:"div",props:{className:"fjs-list-tile",...this.extractCommonProps(t)},style:{display:"flex",alignItems:"center",gap:"16px",padding:"16px",cursor:o?"pointer":"default"},children:a,events:p,metadata:{widgetType:"ListTile"}})}buildCard(t,r){const e=t.child?this.build(t.child,r):null,n=t.elevation||1,s=t.color,i={borderRadius:"12px",overflow:"hidden",boxShadow:`0 ${n*2}px ${n*4}px rgba(0,0,0,0.${Math.min(n*2,3)})`};return s?i.backgroundColor=c.colorToCss(s):i.backgroundColor="#ffffff",new l({tag:"div",props:{className:"fjs-card",...this.extractCommonProps(t)},style:i,children:e?[e]:[],metadata:{widgetType:"Card",flutterProps:{elevation:n}}})}buildDivider(t,r){const e=t.height||1,n=t.thickness||1,s=t.color,i={height:`${e}px`,borderTop:`${n}px solid ${s?c.colorToCss(s):"#e0e0e0"}`,margin:"8px 0"};return new l({tag:"hr",props:{className:"fjs-divider",...this.extractCommonProps(t)},style:i,metadata:{widgetType:"Divider"}})}buildIcon(t,r){const e=t.icon,n=t.size||24,s=t.color,i={width:`${n}px`,height:`${n}px`,display:"inline-block"};return s&&(i.color=c.colorToCss(s)),new l({tag:"span",props:{className:"fjs-icon","data-icon":e,...this.extractCommonProps(t)},style:i,children:["\u2B24"],metadata:{widgetType:"Icon",flutterProps:{icon:e,size:n}}})}buildImage(t,r){const e=t.image?.src||t.src||"",n=t.width,s=t.height,i=t.fit||"contain",o={};n&&(o.width=typeof n=="number"?`${n}px`:n),s&&(o.height=typeof s=="number"?`${s}px`:s);const a={fill:"fill",contain:"contain",cover:"cover",fitWidth:"scale-down",fitHeight:"scale-down",none:"none",scaleDown:"scale-down"};return o.objectFit=a[i]||"contain",new l({tag:"img",props:{src:e,alt:t.semanticLabel||"",className:"fjs-image",...this.extractCommonProps(t)},style:o,metadata:{widgetType:"Image",flutterProps:{src:e,fit:i}}})}buildCircleAvatar(t,r){const e=t.child?this.build(t.child,r):null,n=t.radius||20,s=t.backgroundColor,i={width:`${n*2}px`,height:`${n*2}px`,borderRadius:"50%",display:"flex",justifyContent:"center",alignItems:"center",overflow:"hidden"};return s?i.backgroundColor=c.colorToCss(s):i.backgroundColor="var(--md-sys-color-primary-container, #eaddff)",new l({tag:"div",props:{className:"fjs-circle-avatar",...this.extractCommonProps(t)},style:i,children:e?[e]:[],metadata:{widgetType:"CircleAvatar",flutterProps:{radius:n}}})}buildMaterialApp(t,r){const e=t.home?this.build(t.home,r):null,n=t.title||"";return new l({tag:"div",props:{className:"fjs-material-app","data-title":n,...this.extractCommonProps(t)},style:{minHeight:"100vh",fontFamily:"Roboto, sans-serif"},children:e?[e]:[],metadata:{widgetType:"MaterialApp",flutterProps:{title:n}}})}buildNavigator(t,r){const e=this.buildChildren(t.pages||[],r);return new l({tag:"div",props:{className:"fjs-navigator",...this.extractCommonProps(t)},children:e,metadata:{widgetType:"Navigator"}})}buildGeneric(t,r){let e=[];if(t.child){const s=this.build(t.child,r);s&&(e=[s])}else t.children&&(e=this.buildChildren(t.children,r));const n=this.getWidgetType(t);return new l({tag:"div",props:{className:`fjs-${n.toLowerCase()}`,"data-widget-type":n,...this.extractCommonProps(t)},children:e,metadata:{widgetType:n,note:"Generic widget - no specific builder implemented"}})}}export{b as VNodeBuilder};
//# sourceMappingURL=vnode_builder.js.map
