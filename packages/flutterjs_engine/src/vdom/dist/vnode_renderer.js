class o{render(r,s,t={}){if(!s)throw new Error("Target element is required");t.clear!==!1&&this.clearElement(s);const e=this.createDOMNode(r);return e&&(Array.isArray(e)?e.forEach(i=>s.appendChild(i)):s.appendChild(e)),Array.isArray(e)?e[0]:e}createDOMNode(r){if(r==null)return document.createTextNode("");if(Array.isArray(r))return r.map(t=>this.createDOMNode(t)).filter(t=>t!==null);if(typeof r=="string"||typeof r=="number")return document.createTextNode(String(r));if(typeof r=="boolean")return document.createTextNode("");if(!r.tag)return console.warn("Invalid VNode: missing tag",r),document.createTextNode("");const s=document.createElement(r.tag);if(s._vnode=r,r._element=s,this.applyProps(s,r.props||{}),this.applyStyles(s,r.style||{}),this.applyEvents(s,r.events||{}),r.children&&r.children.length>0&&this.renderChildren(s,r.children),typeof r.ref=="function")try{r.ref(s)}catch(t){console.error("Error in ref callback:",t)}return s}renderChildren(r,s){s.forEach((t,e)=>{const i=this.createDOMNode(t);i&&(Array.isArray(i)?i.forEach(n=>r.appendChild(n)):r.appendChild(i),t&&typeof t=="object"&&t.tag&&(t._parent=r._vnode,t._index=e))})}applyProps(r,s){Object.entries(s).forEach(([t,e])=>{if(e!=null)try{if(t==="className"||t==="class"){r.className=e;return}if(t==="value"&&(r.tagName==="INPUT"||r.tagName==="TEXTAREA"||r.tagName==="SELECT")){r.value=e;return}if(t==="checked"&&r.tagName==="INPUT"){r.checked=!!e;return}if(t==="selected"&&r.tagName==="OPTION"){r.selected=!!e;return}if(t==="disabled"){r.disabled=!!e;return}if(t.startsWith("data-")||t.startsWith("aria-")){r.setAttribute(t,String(e));return}if(typeof e=="boolean"){e?r.setAttribute(t,""):r.removeAttribute(t);return}t in r?r[t]=e:r.setAttribute(t,String(e))}catch(i){console.warn(`Failed to set prop ${t}:`,i);try{r.setAttribute(t,String(e))}catch(n){console.error(`Failed to set attribute ${t}:`,n)}}})}applyStyles(r,s){Object.entries(s).forEach(([t,e])=>{if(e!=null)try{t.startsWith("--")?r.style.setProperty(t,e):r.style[t]=e}catch(i){console.warn(`Failed to set style ${t}:`,i)}})}applyEvents(r,s){Object.entries(s).forEach(([t,e])=>{if(typeof e!="function"){console.warn(`Event handler for ${t} is not a function`);return}try{const i=t.replace(/^on/,"").toLowerCase();r._eventListeners||(r._eventListeners={}),r._eventListeners[i]&&r.removeEventListener(i,r._eventListeners[i]),r.addEventListener(i,e),r._eventListeners[i]=e}catch(i){console.error(`Failed to attach event ${t}:`,i)}})}clearElement(r){this.cleanupEventListeners(r),r.innerHTML=""}cleanupEventListeners(r){r&&(r._eventListeners&&(Object.entries(r._eventListeners).forEach(([s,t])=>{r.removeEventListener(s,t)}),r._eventListeners=null),r._vnode&&(r._vnode._element=null,r._vnode=null),Array.from(r.children).forEach(s=>{this.cleanupEventListeners(s)}))}updateProps(r,s={},t={}){Object.keys(s).forEach(e=>{e in t||(e==="className"||e==="class"?r.className="":e.startsWith("data-")||e.startsWith("aria-")||typeof s[e]=="boolean"?r.removeAttribute(e):e in r?r[e]="":r.removeAttribute(e))}),this.applyProps(r,t)}updateStyles(r,s={},t={}){Object.keys(s).forEach(e=>{e in t||(r.style[e]="")}),this.applyStyles(r,t)}updateEvents(r,s={},t={}){Object.keys(s).forEach(e=>{if(!(e in t)){const i=e.replace(/^on/,"").toLowerCase();r._eventListeners&&r._eventListeners[i]&&(r.removeEventListener(i,r._eventListeners[i]),delete r._eventListeners[i])}}),this.applyEvents(r,t)}replaceElement(r,s){const t=this.createDOMNode(s);return r.parentNode&&t&&(this.cleanupEventListeners(r),r.parentNode.replaceChild(t,r)),t}removeElement(r){!r||!r.parentNode||(this.cleanupEventListeners(r),r.parentNode.removeChild(r))}insertAt(r,s,t){const e=this.createDOMNode(s);if(!e)return null;const i=Array.from(r.childNodes);return t>=i.length?r.appendChild(e):r.insertBefore(e,i[t]),e}findElementByPath(r,s){if(!s)return r;const t=s.split(".").map(Number);let e=r;for(const i of t){const n=Array.from(e.childNodes);if(i>=n.length)return null;e=n[i]}return e}getElementPath(r){const s=[];let t=r;for(;t.parentNode&&t.parentNode!==document.body;){const e=t.parentNode,i=Array.from(e.childNodes).indexOf(t);s.unshift(i),t=e}return s.join(".")}batchRender(r,s){const t=document.createDocumentFragment();r.forEach(e=>{const i=this.createDOMNode(e);i&&(Array.isArray(i)?i.forEach(n=>t.appendChild(n)):t.appendChild(i))}),this.clearElement(s),s.appendChild(t)}needsUpdate(r,s){if(!r._vnode)return!0;const t=r._vnode;if(t.tag!==s.tag||t.key!==s.key)return!0;const e=t.props||{},i=s.props||{};if(Object.keys(e).length!==Object.keys(i).length)return!0;const n=t.style||{},a=s.style||{};return Object.keys(n).length!==Object.keys(a).length}}export{o as VNodeRenderer};
//# sourceMappingURL=vnode_renderer.js.map
