class c{static render(t,s,r={}){if(!s)throw new Error("Target element is required");r.clear!==!1&&this.clearElement(s);const e=this.createDOMNode(t);return e&&(Array.isArray(e)?e.forEach(i=>s.appendChild(i)):s.appendChild(e)),Array.isArray(e)?e[0]:e}static createDOMNode(t){if(t==null)return document.createTextNode("");if(Array.isArray(t))return t.map(r=>this.createDOMNode(r)).filter(r=>r!==null);if(typeof t=="string"||typeof t=="number")return document.createTextNode(String(t));if(typeof t=="boolean")return document.createTextNode("");if(!t.tag)return console.warn("Invalid VNode: missing tag",t),document.createTextNode("");const s=document.createElement(t.tag);if(s._vnode=t,t._element=s,this.applyProps(s,t.props||{}),this.applyStyles(s,t.style||{}),this.applyEvents(s,t.events||{}),t.children&&t.children.length>0&&this.renderChildren(s,t.children),typeof t.ref=="function")try{t.ref(s)}catch(r){console.error("Error in ref callback:",r)}return s}static renderChildren(t,s){s.forEach((r,e)=>{const i=this.createDOMNode(r);i&&(Array.isArray(i)?i.forEach(n=>t.appendChild(n)):t.appendChild(i),r&&typeof r=="object"&&r.tag&&(r._parent=t._vnode,r._index=e))})}static applyProps(t,s){Object.entries(s).forEach(([r,e])=>{if(e!=null)try{if(r==="className"||r==="class"){t.className=e;return}if(r==="value"&&(t.tagName==="INPUT"||t.tagName==="TEXTAREA"||t.tagName==="SELECT")){t.value=e;return}if(r==="checked"&&t.tagName==="INPUT"){t.checked=!!e;return}if(r==="selected"&&t.tagName==="OPTION"){t.selected=!!e;return}if(r==="disabled"){t.disabled=!!e;return}if(r.startsWith("data-")||r.startsWith("aria-")){t.setAttribute(r,String(e));return}if(typeof e=="boolean"){e?t.setAttribute(r,""):t.removeAttribute(r);return}r in t?t[r]=e:t.setAttribute(r,String(e))}catch(i){console.warn(`Failed to set prop ${r}:`,i);try{t.setAttribute(r,String(e))}catch(n){console.error(`Failed to set attribute ${r}:`,n)}}})}static applyStyles(t,s){Object.entries(s).forEach(([r,e])=>{if(e!=null)try{r.startsWith("--")?t.style.setProperty(r,e):t.style[r]=e}catch(i){console.warn(`Failed to set style ${r}:`,i)}})}static applyEvents(t,s){Object.entries(s).forEach(([r,e])=>{if(typeof e!="function"){console.warn(`Event handler for ${r} is not a function`);return}try{const i=r.replace(/^on/,"").toLowerCase();t._eventListeners||(t._eventListeners={}),t._eventListeners[i]&&t.removeEventListener(i,t._eventListeners[i]),t.addEventListener(i,e),t._eventListeners[i]=e}catch(i){console.error(`Failed to attach event ${r}:`,i)}})}static clearElement(t){this.cleanupEventListeners(t),t.innerHTML=""}static cleanupEventListeners(t){t&&(t._eventListeners&&(Object.entries(t._eventListeners).forEach(([s,r])=>{t.removeEventListener(s,r)}),t._eventListeners=null),t._vnode&&(t._vnode._element=null,t._vnode=null),Array.from(t.children).forEach(s=>{this.cleanupEventListeners(s)}))}static updateProps(t,s={},r={}){Object.keys(s).forEach(e=>{e in r||(e==="className"||e==="class"?t.className="":e.startsWith("data-")||e.startsWith("aria-")||typeof s[e]=="boolean"?t.removeAttribute(e):e in t?t[e]="":t.removeAttribute(e))}),this.applyProps(t,r)}static updateStyles(t,s={},r={}){Object.keys(s).forEach(e=>{e in r||(t.style[e]="")}),this.applyStyles(t,r)}static updateEvents(t,s={},r={}){Object.keys(s).forEach(e=>{if(!(e in r)){const i=e.replace(/^on/,"").toLowerCase();t._eventListeners&&t._eventListeners[i]&&(t.removeEventListener(i,t._eventListeners[i]),delete t._eventListeners[i])}}),this.applyEvents(t,r)}static replaceElement(t,s){const r=this.createDOMNode(s);return t.parentNode&&r&&(this.cleanupEventListeners(t),t.parentNode.replaceChild(r,t)),r}static removeElement(t){!t||!t.parentNode||(this.cleanupEventListeners(t),t.parentNode.removeChild(t))}static insertAt(t,s,r){const e=this.createDOMNode(s);if(!e)return null;const i=Array.from(t.childNodes);return r>=i.length?t.appendChild(e):t.insertBefore(e,i[r]),e}static findElementByPath(t,s){if(!s)return t;const r=s.split(".").map(Number);let e=t;for(const i of r){const n=Array.from(e.childNodes);if(i>=n.length)return null;e=n[i]}return e}static getElementPath(t){const s=[];let r=t;for(;r.parentNode&&r.parentNode!==document.body;){const e=r.parentNode,i=Array.from(e.childNodes).indexOf(r);s.unshift(i),r=e}return s.join(".")}static batchRender(t,s){const r=document.createDocumentFragment();t.forEach(e=>{const i=this.createDOMNode(e);i&&(Array.isArray(i)?i.forEach(n=>r.appendChild(n)):r.appendChild(i))}),this.clearElement(s),s.appendChild(r)}static needsUpdate(t,s){if(!t._vnode)return!0;const r=t._vnode;if(r.tag!==s.tag||r.key!==s.key)return!0;const e=r.props||{},i=s.props||{};if(Object.keys(e).length!==Object.keys(i).length)return!0;const n=r.style||{},a=s.style||{};return Object.keys(n).length!==Object.keys(a).length}}export{c as VNodeRenderer};
//# sourceMappingURL=vnode_renderer.js.map
