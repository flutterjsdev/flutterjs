class a{constructor(e={}){this.debugMode=e.debugMode||!1,this.rootElement=e.rootElement||null}render(e,s,r={}){if(!s)throw new Error("Target element is required");this.debugMode&&(console.log("[VNodeRenderer] \u{1F3A8} Rendering to",s.id||s.className||s.tagName),console.log("[VNodeRenderer] \u{1F4E6} VNode to render:",{type:typeof e,isArray:Array.isArray(e),hasTag:e?.tag,constructor:e?.constructor?.name,keys:e?Object.keys(e).slice(0,10):[]})),r.clear!==!1&&this.clearElement(s);const t=this.createDOMNode(e);return t&&(Array.isArray(t)?t.forEach(i=>s.appendChild(i)):s.appendChild(t)),this.debugMode&&console.log("[VNodeRenderer] \u2705 Rendered successfully"),Array.isArray(t)?t[0]:t}createDOMNode(e){if(e==null)return document.createTextNode("");if(Array.isArray(e))return e.map(r=>this.createDOMNode(r)).filter(r=>r!==null);if(typeof e=="string"||typeof e=="number")return document.createTextNode(String(e));if(typeof e=="boolean")return document.createTextNode("");if(!e.tag)return console.error("\u274C Invalid VNode: missing tag"),console.error("\u{1F4CB} Object details:",{type:typeof e,constructor:e?.constructor?.name,hasTag:e?.tag!==void 0,hasBuild:typeof e?.build=="function",hasCreateState:typeof e?.createState=="function",hasCreateElement:typeof e?.createElement=="function",keys:Object.keys(e).slice(0,20)}),console.error("\u{1F50D} Full object:",e),typeof e.build=="function"?(console.error("\u274C This looks like a WIDGET, not a VNode!"),console.error("   Widget type:",e.constructor.name),console.error("   Widget should have been built to VNode before rendering")):typeof e.createElement=="function"?console.error("\u274C This looks like a WIDGET with createElement!"):(e.appBar||e.body||e.floatingActionButton)&&console.error("\u274C This looks like a SCAFFOLD widget instance!"),document.createTextNode("");const s=document.createElement(e.tag);if(s._vnode=e,e._element=s,this.applyProps(s,e.props||{}),this.applyStyles(s,e.style||{}),this.applyEvents(s,e.events||{}),e.children&&e.children.length>0&&this.renderChildren(s,e.children),typeof e.ref=="function")try{e.ref(s)}catch(r){console.error("Error in ref callback:",r)}return s}renderChildren(e,s){s.forEach((r,t)=>{const i=this.createDOMNode(r);i&&(Array.isArray(i)?i.forEach(o=>e.appendChild(o)):e.appendChild(i),r&&typeof r=="object"&&r.tag&&(r._parent=e._vnode,r._index=t))})}applyProps(e,s){Object.entries(s).forEach(([r,t])=>{if(t!=null)try{if(r==="className"||r==="class"){e.className=t;return}if(r==="value"&&(e.tagName==="INPUT"||e.tagName==="TEXTAREA"||e.tagName==="SELECT")){e.value=t;return}if(r==="checked"&&e.tagName==="INPUT"){e.checked=!!t;return}if(r==="selected"&&e.tagName==="OPTION"){e.selected=!!t;return}if(r==="disabled"){e.disabled=!!t;return}if(r.startsWith("data-")||r.startsWith("aria-")){e.setAttribute(r,String(t));return}if(typeof t=="boolean"){t?e.setAttribute(r,""):e.removeAttribute(r);return}r in e?e[r]=t:e.setAttribute(r,String(t))}catch(i){console.warn(`Failed to set prop ${r}:`,i);try{e.setAttribute(r,String(t))}catch(o){console.error(`Failed to set attribute ${r}:`,o)}}})}applyStyles(e,s){Object.entries(s).forEach(([r,t])=>{if(t!=null)try{r.startsWith("--")?e.style.setProperty(r,t):e.style[r]=t}catch(i){console.warn(`Failed to set style ${r}:`,i)}})}applyEvents(e,s){Object.entries(s).forEach(([r,t])=>{if(typeof t!="function"){console.warn(`Event handler for ${r} is not a function`);return}try{const i=r.replace(/^on/,"").toLowerCase();e._eventListeners||(e._eventListeners={}),e._eventListeners[i]&&e.removeEventListener(i,e._eventListeners[i]),e.addEventListener(i,t),e._eventListeners[i]=t}catch(i){console.error(`Failed to attach event ${r}:`,i)}})}clearElement(e){this.cleanupEventListeners(e),e.innerHTML=""}cleanupEventListeners(e){e&&(e._eventListeners&&(Object.entries(e._eventListeners).forEach(([s,r])=>{e.removeEventListener(s,r)}),e._eventListeners=null),e._vnode&&(e._vnode._element=null,e._vnode=null),Array.from(e.children).forEach(s=>{this.cleanupEventListeners(s)}))}updateProps(e,s={},r={}){Object.keys(s).forEach(t=>{t in r||(t==="className"||t==="class"?e.className="":t.startsWith("data-")||t.startsWith("aria-")||typeof s[t]=="boolean"?e.removeAttribute(t):t in e?e[t]="":e.removeAttribute(t))}),this.applyProps(e,r)}updateStyles(e,s={},r={}){Object.keys(s).forEach(t=>{t in r||(e.style[t]="")}),this.applyStyles(e,r)}updateEvents(e,s={},r={}){Object.keys(s).forEach(t=>{if(!(t in r)){const i=t.replace(/^on/,"").toLowerCase();e._eventListeners&&e._eventListeners[i]&&(e.removeEventListener(i,e._eventListeners[i]),delete e._eventListeners[i])}}),this.applyEvents(e,r)}replaceElement(e,s){const r=this.createDOMNode(s);return e.parentNode&&r&&(this.cleanupEventListeners(e),e.parentNode.replaceChild(r,e)),r}removeElement(e){!e||!e.parentNode||(this.cleanupEventListeners(e),e.parentNode.removeChild(e))}insertAt(e,s,r){const t=this.createDOMNode(s);if(!t)return null;const i=Array.from(e.childNodes);return r>=i.length?e.appendChild(t):e.insertBefore(t,i[r]),t}findElementByPath(e,s){if(!s)return e;const r=s.split(".").map(Number);let t=e;for(const i of r){const o=Array.from(t.childNodes);if(i>=o.length)return null;t=o[i]}return t}getElementPath(e){const s=[];let r=e;for(;r.parentNode&&r.parentNode!==document.body;){const t=r.parentNode,i=Array.from(t.childNodes).indexOf(r);s.unshift(i),r=t}return s.join(".")}batchRender(e,s){const r=document.createDocumentFragment();e.forEach(t=>{const i=this.createDOMNode(t);i&&(Array.isArray(i)?i.forEach(o=>r.appendChild(o)):r.appendChild(i))}),this.clearElement(s),s.appendChild(r)}needsUpdate(e,s){if(!e._vnode)return!0;const r=e._vnode;if(r.tag!==s.tag||r.key!==s.key)return!0;const t=r.props||{},i=s.props||{};if(Object.keys(t).length!==Object.keys(i).length)return!0;const o=r.style||{},n=s.style||{};return Object.keys(o).length!==Object.keys(n).length}}export{a as VNodeRenderer};
//# sourceMappingURL=vnode_renderer.js.map
