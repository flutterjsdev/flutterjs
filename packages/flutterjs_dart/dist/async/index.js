class l{constructor(e,s){this._timer=setTimeout(s,e.inMilliseconds||e)}static periodic(e,s){const t=new l(0,()=>{});return clearTimeout(t._timer),t._timer=setInterval(()=>s(t),e.inMilliseconds||e),t}static run(e){setTimeout(e,0)}cancel(){clearTimeout(this._timer),clearInterval(this._timer)}}class i{constructor(e){this._promise=new Promise((s,t)=>{try{const r=e();s(r)}catch(r){t(r)}})}static _wrap(e){const s=new i(()=>{});return s._promise=e,s}static value(e){return i._wrap(Promise.resolve(e))}static error(e){return i._wrap(Promise.reject(e))}static delayed(e,s){return i._wrap(new Promise((t,r)=>{setTimeout(()=>{try{t(s?s():null)}catch(n){r(n)}},e.inMilliseconds||e)}))}static wait(e){const s=e.map(t=>t instanceof i?t._promise:t);return i._wrap(Promise.all(s))}then(e,{onError:s}={}){const t=this._promise.then(r=>e(r),r=>{if(s)return s(r);throw r});return i._wrap(t)}catchError(e,{test:s}={}){const t=this._promise.catch(r=>{if(s&&!s(r))throw r;return e(r)});return i._wrap(t)}whenComplete(e){const s=this._promise.finally(()=>e());return i._wrap(s)}thenJS(e,s){return this._promise.then(e,s)}}class p{constructor(){this.future=new i(()=>{}),this.future._promise=new Promise((e,s)=>{this._resolve=e,this._reject=s})}complete(e){this._resolve(e)}completeError(e){this._reject(e)}get isCompleted(){return!1}}class h{constructor(e){this.callbacks=e,this.isPaused=!1,this.isCanceled=!1}cancel(){this.isCanceled=!0,this.callbacks&&this.callbacks.onCancel&&this.callbacks.onCancel()}pause(){this.isPaused=!0}resume(){this.isPaused=!1}}class m{constructor(e){this._onListen=e}listen(e,{onError:s,onDone:t,cancelOnError:r}={}){const n=new h({onData:e,onError:s,onDone:t,onCancel:()=>{}});if(this._onListen){const c=this._onListen(n);c&&typeof c=="function"&&(n.callbacks.onCancel=c)}return n}map(e){const s=new a;return this.listen(t=>s.add(e(t)),{onError:t=>s.addError(t),onDone:()=>s.close()}),s.stream}static fromIterable(e){const s=new a;return setTimeout(()=>{for(const t of e){if(s.isClosed)break;s.add(t)}s.isClosed||s.close()},0),s.stream}}class a{constructor(){this._listeners=[],this.isClosed=!1}get stream(){return this._stream||(this._stream=new m(e=>(this._listeners.push(e),()=>{const s=this._listeners.indexOf(e);s>=0&&this._listeners.splice(s,1)}))),this._stream}get hasListener(){return this._listeners.length>0}add(e){this.isClosed||[...this._listeners].forEach(s=>{!s.isCanceled&&!s.isPaused&&s.callbacks.onData&&s.callbacks.onData(e)})}addError(e){this.isClosed||[...this._listeners].forEach(s=>{!s.isCanceled&&!s.isPaused&&s.callbacks.onError&&s.callbacks.onError(e)})}close(){this.isClosed||(this.isClosed=!0,[...this._listeners].forEach(e=>{!e.isCanceled&&!e.isPaused&&e.callbacks.onDone&&e.callbacks.onDone()}),this._listeners=[])}}export{p as Completer,i as Future,m as Stream,a as StreamController,h as StreamSubscription,l as Timer};
//# sourceMappingURL=index.js.map
